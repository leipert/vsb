(function e(t,r,a){function n(s,o){if(!r[s]){if(!t[s]){var l=typeof require=="function"&&require;if(!o&&l)return l(s,!0);if(i)return i(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=r[s]={exports:{}};t[s][0].call(u.exports,function(e){var r=t[s][1][e];return n(r?r:e)},u,u.exports,e,t,r,a)}return r[s].exports}var i=typeof require=="function"&&require;for(var s=0;s<a.length;s++)n(a[s]);return n})({1:[function(e,module,t){var Jassa=e("./index.js");if(typeof define=="function"&&define.amd){define("Jassa",function(){return Jassa})}else{window.Jassa=Jassa}},{"./index.js":88}],2:[function(e,module,t){var r=function(){function e(e,t){var r;for(var a=1,n=arguments.length;a<n;a++){t=arguments[a];for(r in t){if(hasOwnProperty.call(t,r)){e[r]=t[r]}}}return e}function t(e){if(!e){return[]}if("toArray"in Object(e)){return e.toArray()}var t=e.length||0,r=new Array(t);while(t--){r[t]=e[t]}return r}var a=function(){};var n="[object Function]";var i=Object.prototype.toString;function s(e){return i.call(e)===n}function o(e){var t=e.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(",");return t.length===1&&!t[0]?[]:t}function l(e,t){var r=e.length,a=t.length;while(a--){e[r+a]=t[a]}return e}function c(e,t){return function(){var r=l([e.bind(this)],arguments);return t.apply(this,r)}}var u=function(){for(var e in{toString:1}){if(e==="toString"){return false}}return true}();function d(){}function p(){var n=null,i=t(arguments);if(s(i[0])){n=i.shift()}function o(){this.initialize.apply(this,arguments)}e(o,r.Methods);o.superclass=n;o.subclasses=[];if(n){d.prototype=n.prototype;o.prototype=new d;n.subclasses.push(o)}for(var l=0,c=i.length;l<c;l++){o.addMethods(i[l])}if(!o.prototype.initialize){o.prototype.initialize=a}o.prototype.constructor=o;return o}function h(e){var t=this.superclass&&this.superclass.prototype,r=Object.keys(e);if(u){if(e.toString!==Object.prototype.toString){r.push("toString")}if(e.valueOf!==Object.prototype.valueOf){r.push("valueOf")}}for(var a=0,n=r.length;a<n;a++){var i=r[a],l=e[i];if(t&&s(l)&&o(l)[0]==="$super"){var d=l;l=c(function(e){return function(){return t[e].apply(this,arguments)}}(i),d);l.valueOf=function(e){return function(){return e.valueOf.call(e)}}(d);l.toString=function(e){return function(){return e.toString.call(e)}}(d)}this.prototype[i]=l}return this}return{create:p,Methods:{addMethods:h}}}();module.exports=r},{}],3:[function(e,module,t){var r;var a=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;var n;var i;var s={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};var o;function l(e){a.lastIndex=0;return a.test(e)?'"'+e.replace(a,function(e){var t=s[e];return typeof t==="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function c(e,t){var r,a,s,u,d=n,p,h=t[e];if(h&&typeof h==="object"&&typeof h.toJSON==="function"){h=h.toJSON(e)}if(typeof o==="function"){h=o.call(t,e,h)}switch(typeof h){case"string":return l(h);case"number":return isFinite(h)?String(h):"null";case"boolean":case"null":return String(h);case"object":if(!h){return"null"}n+=i;p=[];if(Object.prototype.toString.apply(h)==="[object Array]"){u=h.length;for(r=0;r<u;r+=1){p[r]=c(r,h)||"null"}s=p.length===0?"[]":n?"[\n"+n+p.join(",\n"+n)+"\n"+d+"]":"["+p.join(",")+"]";n=d;return s}if(o&&typeof o==="object"){u=o.length;for(r=0;r<u;r+=1){if(typeof o[r]==="string"){a=o[r];s=c(a,h);if(s){p.push(l(a)+(n?": ":":")+s)}}}}else{var v=Object.keys(h).sort();for(r in v){a=v[r];if(Object.prototype.hasOwnProperty.call(h,a)){s=c(a,h);if(s){p.push(l(a)+(n?": ":":")+s)}}}}s=p.length===0?"{}":n?"{\n"+n+p.join(",\n"+n)+"\n"+d+"}":"{"+p.join(",")+"}";n=d;return s}}var u=function(e,t,r){var a;n="";i="";if(typeof r==="number"){for(a=0;a<r;a+=1){i+=" "}}else if(typeof r==="string"){i=r}o=t;if(t&&typeof t!=="function"&&(typeof t!=="object"||typeof t.length!=="number")){throw new Error("JSON.stringify")}return c("",{"":e})};r={stringify:u};module.exports=r},{}],4:[function(e,module,t){"use strict";var r={Class:e("./Class"),JSONCanonical:e("./JSONCanonical")};Object.freeze(r);module.exports=r},{"./Class":2,"./JSONCanonical":3}],5:[function(e,module,t){var r=e("lodash.foreach");var a=e("lodash.uniq");var n=e("../ext/Class");var i=e("../sparql/ExprUtils");var s=e("./ElementsAndExprs");var o=n.create({classLabel:"jassa.facete.ConstraintManager",initialize:function(e){this.constraints=e||[]},isEmpty:function(){var e=this.constraints.length===0;return e},shallowClone:function(){var e=new o(this.constraints.slice(0));return e},getConstraintsByPath:function(e){var t=[];var r=this.constraints;r.forEach(function(r){var a=r.getDeclaredPaths();var n=a.some(function(t){var r=t.equals(e);return r});if(n){t.push(r)}});return t},getConstrainedSteps:function(e){var t=[];var r=e.getSteps();var n=this.constraints;for(var i=0;i<n.length;++i){var s=n[i];var o=s.getDeclaredPaths();for(var l=0;l<o.length;++l){var c=o[l];var u=c.getSteps();var d=u.length-r.length;var p=c.startsWith(e);if(d==1&&p){var h=u[u.length-1];t.push(h)}}}var v=a(t,function(e){return""+e});return v},getConstraints:function(){return this.constraints},addConstraint:function(e){this.constraints.push(e)},addConstraints:function(e){var t=this;e.forEach(function(e){t.addConstraint(e)})},removeConstraint:function(e){var t=false;var r=this.constraints;var a=[];for(var n=0;n<r.length;++n){var i=r[n];if(!i.equals(e)){a.push(i)}else{t=true}}this.constraints=a;return t},toggleConstraint:function(e){var t=this.removeConstraint(e);if(!t){this.addConstraint(e)}},createElementsAndExprs:function(e,t){var a=[];var n=[];var o={};var l=this;this.constraints.forEach(function(r){var n=r.getDeclaredPaths();var s=n.join(" ");if(t){var l=n.some(function(e){var r=t.equals(e);return r});if(l){return}}n.forEach(function(t){var r=e.forPath(t);var n=r.getElements();a.push.apply(a,n)});var c=r.createElementsAndExprs(e);var u=c.getElements();var d=c.getExprs();if(u){a.push.apply(a,u)}if(d&&d.length>0){var p=o[s];if(!p){p=[];o[s]=p}var h=i.andify(d);p.push(h)}});r(o,function(e){var t=i.orify(e);n.push(t)});var c=new s(a,n);return c}});module.exports=o},{"../ext/Class":2,"../sparql/ExprUtils":210,"./ElementsAndExprs":9,"lodash.foreach":432,"lodash.uniq":582}],6:[function(e,module,t){var r=e("../sparql/ElementUtils");var a=e("../sparql/expr/ExprVar");var n=e("../sparql/expr/E_Lang");var i=e("../sparql/expr/E_LangMatches");var s=e("../sparql/expr/E_Regex");var o=e("../sparql/expr/E_Equals");var l=e("../sparql/NodeValueUtils");var c=e("../sparql/element/ElementTriplesBlock");var u=e("./ElementsAndExprs");var d=e("../sparql/Concept");var p=e("../sparql/ConceptUtils");var h={createConstraintExists:function(e,t){var a=e.forPath(t);var n=r.createElementsTriplesBlock(a.getTriples());var i=new u(n,[]);return i},createConstraintLang:function(e,t,s){var o=e.forPath(t);var l=o.getVar();var c=new a(l);var d=r.createElementsTriplesBlock(o.getTriples());var p=s;var h=[new i(new n(c),p)];var v=new u(d,h);return v},createConstraintRegex:function(e,t,n){var i=e.forPath(t);var o=i.getVar();var l=new a(o);var c=r.createElementsTriplesBlock(i.getTriples());var d=n;var p=[new s(l,d,"i")];var h=new u(c,p);return h},createConstraintEquals:function(e,t,n){var i=e.forPath(t);var s=i.getVar();var c=new a(s);var d=r.createElementsTriplesBlock(i.getTriples());var p=l.makeNode(n);var h=[new o(c,p)];var v=new u(d,h);return v},createConstraintConcept:function(e,t,r){var a=e.forPath(t);var n=a.getVar();var i=new c(a.getTriples());var s=new d(i,n);var o=p.createCombinedConcept(s,r,true,false);var l=[];var h=new u([o.getElement()],l);return h}};module.exports=h},{"../sparql/Concept":202,"../sparql/ConceptUtils":203,"../sparql/ElementUtils":206,"../sparql/NodeValueUtils":215,"../sparql/element/ElementTriplesBlock":236,"../sparql/expr/E_Equals":245,"../sparql/expr/E_Lang":248,"../sparql/expr/E_LangMatches":249,"../sparql/expr/E_Regex":257,"../sparql/expr/ExprVar":268,"./ElementsAndExprs":9}],7:[function(e,module,t){var r=e("../ext/Class");var a=e("../util/collection/HashMap");var n=e("../rdf/NodeUtils");var i=e("../rdf/NodeFactory");var s=e("../sparql/element/ElementSubQuery");var o=e("../sparql/element/ElementUnion");var l=e("../sparql/element/ElementFilter");var c=e("../sparql/element/ElementGroup");var u=e("../sparql/Query");var d=e("../sparql/Concept");var p=e("../sparql/ConceptUtils");var h=e("../sparql/expr/ExprVar");var v=e("../sparql/expr/E_OneOf");var f=e("../service/list_service/ListServiceSparqlQuery");var g=e("../service/lookup_service/LookupService");var m=e("./FacetUtils");var x=e("../sparql/Relation");var _=e("../sparql/RelationUtils");var b=e("../sparql/VarUtils");var y=e("../sponate/agg/AggMap");var S=e("../sponate/agg/AggTransform");var C=e("../sponate/agg/AggLiteral");var E=e("../sponate/binding_mapper/BindingMapperExpr");var w=e("../sponate/LookupServiceUtils");var k=e("../sponate/ServiceUtils");var L=e("../util/shared");var q=L.Promise;var j=e("../sparql/QueryUtils");var A={createAggMapCount:function(e,t){var r=new y(new E(new h(e)),new S(new C(new E(new h(t))),n.getValue));return r},execQueries:function(e,t,r,n){var i=j.createQueryUnionSubQueries(t,[r,n]);var s;if(i){var o=this.createAggMapCount(r,n);s=k.execAgg(e,i,o)}else{s=q.resolve(new a)}return s},createQueriesPreCount:function(e,t,r,a){var n=e.getDefaultRelation();var i=e.getPropertyToRelation();var s=r.map(function(e){var r=i.get(e);if(!r){r=n}var s=_.createQueryRawSize(r,e,t,a);return s});return s},createQueriesExactCount:function(e,t,r){var a=e.getSourceVar();var n=e.getDefaultRelation();var i=e.getPropertyToRelation();var s=[];var o=[];r.forEach(function(e){var r=i.get(e);if(!r){s.push(e)}else{var a=_.createQueryDistinctValueCount(r,t);o.push(a)}});var u=n;var d=new l(new v(new h(a),s));var p=new x(new c([u.getElement(),d]),u.getSourceVar(),u.getTargetVar());var f=_.createQueryDistinctValueCount(p,t);o.push(f);return o}};module.exports=A},{"../ext/Class":2,"../rdf/NodeFactory":92,"../rdf/NodeUtils":93,"../service/list_service/ListServiceSparqlQuery":145,"../service/lookup_service/LookupService":150,"../sparql/Concept":202,"../sparql/ConceptUtils":203,"../sparql/Query":217,"../sparql/QueryUtils":219,"../sparql/Relation":220,"../sparql/RelationUtils":221,"../sparql/VarUtils":226,"../sparql/element/ElementFilter":231,"../sparql/element/ElementGroup":232,"../sparql/element/ElementSubQuery":235,"../sparql/element/ElementUnion":237,"../sparql/expr/E_OneOf":256,"../sparql/expr/ExprVar":268,"../sponate/LookupServiceUtils":286,"../sponate/ServiceUtils":293,"../sponate/agg/AggLiteral":311,"../sponate/agg/AggMap":312,"../sponate/agg/AggTransform":316,"../sponate/binding_mapper/BindingMapperExpr":319,"../util/collection/HashMap":342,"../util/shared":350,"./FacetUtils":20}],8:[function(e,module,t){var r=e("./FacetUtils");var a=e("../sparql/element/ElementGroup");var n=e("../sparql/element/ElementOptional");var i=e("./Path");var s={createElementTable:function(e,t){var s=r.createConceptResources(e,new i,false);var o=this.facetConfig.getRootFacetNode();var l=this.paths.map(function(e){var t=o.forPath(e);var r=t.getElements(true);var i=new a(r);var s;if(r.length!==0){s=new n(i)}else{s=i}return s});var c=[];c.push.apply(c,s.getElements());c.push.apply(c,l);var u=new a(c);var d=u.flatten();return d}};module.exports=s},{"../sparql/element/ElementGroup":232,"../sparql/element/ElementOptional":233,"./FacetUtils":20,"./Path":22}],9:[function(e,module,t){var r=e("../ext/Class");var a=e("../sparql/ElementUtils");var n=r.create({initialize:function(e,t){this.elements=e;this.exprs=t},getElements:function(){return this.elements},getExprs:function(){return this.exprs},toElements:function(){var e=[];var t=a.createFilterElements(this.exprs);e.push.apply(e,this.elements);e.push.apply(e,t);return e}});module.exports=n},{"../ext/Class":2,"../sparql/ElementUtils":206}],10:[function(e,module,t){var r=e("../ext/Class");var a=e("../sparql/ConceptUtils");var n=e("./FacetNode");var i=e("./ConstraintManager");var s=r.create({classLabel:"jassa.facete.FacetConfig",initialize:function(e,t,r){this.baseConcept=e||a.createSubjectConcept();this.rootFacetNode=t||n.createRoot(this.baseConcept.getVar());this.constraintManager=r||new i},getBaseConcept:function(){return this.baseConcept},setBaseConcept:function(e){this.baseConcept=e},getRootFacetNode:function(){return this.rootFacetNode},setRootFacetNode:function(e){this.rootFacetNode=e},getConstraintManager:function(){return this.constraintManager},setConstraintManager:function(e){this.constraintManager=e}});module.exports=s},{"../ext/Class":2,"../sparql/ConceptUtils":203,"./ConstraintManager":5,"./FacetNode":11}],11:[function(e,module,t){var r=e("../ext/Class");var a=e("../rdf/NodeFactory");var n=e("../sparql/element/ElementTriplesBlock");var i=e("../sparql/GenSym");var s=e("../sparql/VarUtils");var o=e("./Path");var l=e("./Step");var c=e("./VarNode");var u=r.create({initialize:function(e,t,r,a){this.parent=r;this.root=a;if(!this.root){if(this.parent){this.root=r.root}else{this.root=this}}this.varNode=e;this.step=t;this._isActive=true;this.idToChild={}},getRootNode:function(){return this.root},isRoot:function(){var e=this.parent?false:true;return e},getVar:function(){var e=this.varNode.getVariableName();var t=a.createVar(e);return t},getVariable:function(){if(!this.warningShown){this.warningShown=true}return this.getVar()},getStep:function(){return this.step},getParent:function(){return this.parent},getPath:function(){var e=[];var t=this;while(t!=this.root){e.push(t.getStep());t=t.getParent()}e.reverse();var r=new o(e);return r},forPath:function(e){var t=e.getSteps();var r=this;t.forEach(function(e){r=r.forStep(e)});return r},getIdStr:function(){},getSteps:function(){return this.steps},isActiveDirect:function(){return this._isActive},getElements:function(){var e=[];var t=this.getTriples();if(t.length>0){var r=new n(t);e.push(r)}return e},getTriples:function(){var e=[];this.getTriples2(e);return e},getTriples2:function(e){this.createDirectTriples2(e);if(this.parent){this.parent.getTriples2(e)}return e},createDirectTriples:function(){var e=[];this.createDirectTriples2(e);return e},createDirectTriples2:function(e){if(this.step){var t=this.parent.getVariable();var r=this.getVariable();var a=this.step.createElement(t,r,this.generator);var n=a.getTriples();e.push.apply(e,n)}return e},isActive:function(){if(!this._isActive){return false}if(this.parent){return this.parent.isActive()}return true},attachToParent:function(){if(!this.parent){return}this.parent[this.id]=this;this.parent.attachToParent()},forProperty:function(e,t){var r=new l(e,t);var a=this.forStep(r);return a},forStep:function(e){var t=""+JSON.stringify(e);var r=this.idToChild[t];if(!r){var a=this.varNode.forStepId(t);r=new u(a,e,this,this.root);this.idToChild[t]=r}return r},copyExclude:function(){var e=new u;console.log("Now root:",e);this.root.copyExcludeRec(e,this);return e},copyExcludeRec:function(e,t){console.log("Copy:",this,e);if(this===t){return}this.copyTo(e);this.steps.forEach(function(r){var a=r.step;var n=r.child;console.log("child:",a,n);if(n===t){return}var i=e.forStep(a);console.log("New child:",i);n.copyExcludeRec(i,t)})}});u.createRoot=function(e,t){var r=e?e.getName():s.s.getName();t=t?t:new i("fv");var a=new c(r,t);var n=new u(a);return n};module.exports=u},{"../ext/Class":2,"../rdf/NodeFactory":92,"../sparql/GenSym":211,"../sparql/VarUtils":226,"../sparql/element/ElementTriplesBlock":236,"./Path":22,"./Step":26,"./VarNode":29}],12:[function(e,module,t){var r=e("../ext/Class");var a=e("./ListFilter");var n=r.create({initialize:function(e,t,r){this._isExpanded=!!e;this._isInverse=!!t;this.listFilter=r||new a},getListFilter:function(){return this.listFilter},setListFilter:function(e){this.listFilter=e},isExpanded:function(){return this._isExpanded},setExpanded:function(e){this._isExpanded=e},isInverse:function(){return this._isInverse},setInverse:function(e){this._isInverse=e}});module.exports=n},{"../ext/Class":2,"./ListFilter":21}],13:[function(e,module,t){var r=e("../ext/Class");var a=r.create({initialize:function(e,t,r){this.sourceVar=e;this.defaultRelation=t;this.propertyToRelation=r},getSourceVar:function(){return this.sourceVar},getDefaultRelation:function(){return this.defaultRelation},getPropertyToRelation:function(){return this.propertyToRelation}});module.exports=a},{"../ext/Class":2}],14:[function(e,module,t){var r=e("../ext/Class");var a=e("./FacetServiceUtils");var n=e("./facet_service/FacetServiceFn");var i=e("./facet_service/FacetServiceClientIndex");var s=e("../sparql/BestLabelConfig");var o=e("../sponate/LookupServiceUtils");var l=e("./facet_service/FacetServiceTransformConcept");var c=e("../service/list_service/ListServiceTransformItem");var u=e("../service/list_service/ListServiceTransformItems");var d=e("../sponate/MappedConceptUtils");var p=e("../sparql/LabelUtils");var h=e("../sparql/search/KeywordSearchUtils");var v=e("../util/collection/HashMap");var f=r.create({initialize:function(e,t){this.facetService=e;this.defaultSparqlService=t},create:function(){return this.facetService},labelConfig:function(e){e=e||new s;this._labelConfigLabels(e);this._labelConfigFilter(e);return this},tagFn:function(e){this.facetService=new n(this.facetService,function(t){var r=new c(t,e);return r});return this},pathToTags:function(e,t){e=e||new v;t=t||"tags";this.facetService=new n(this.facetService,function(r){var a=new u(r,function(r){r.forEach(function(r){var a=r.val;var n=a.path;var i=e.get(n);if(!i){i={};e.put(n,i)}a[t]=i});return r});return a});return this},_labelConfigFilter:function(e){var t=function(t){var r;if(t){var a=p.createRelationPrefLabels(e);r=h.createConceptRegex(a,t)}else{r=null}return r};this.facetService=new l(this.facetService,t);return this},_labelConfigLabels:function(e,t){t=t||"labelInfo";var r=this;this.facetService=new n(this.facetService,function(a){var n=new u(a,function(a){var n=d.createMappedConceptBestLabel(e);var i=o.createLookupServiceMappedConcept(r.defaultSparqlService,n);var s=a.map(function(e){return e.val.property});var l=i.lookup(s).then(function(e){a.forEach(function(r){r.val[t]=e.get(r.val.property)});return a});return l});return n});return this},index:function(){var e=function(e){var t;if(e!=null){var r=new RegExp(e,"mi");t=function(e){var t=e.val.labelInfo||{id:e.key.getUri(),displayLabel:e.key.getUri(),hiddenLabels:[]};var a=r.test(t.id);var n=a||r.test(t.displayLabel);var i=n||t.hiddenLabels&&t.hiddenLabels.some(function(e){return r.test(e)});return i}}else{t=function(e){return true}}return t};this.facetService=new i(this.facetService,e,100);return this}});f.core=function(e,t){var r=a.createFacetService(e,t);var n=new f(r,e);return n};module.exports=f},{"../ext/Class":2,"../service/list_service/ListServiceTransformItem":148,"../service/list_service/ListServiceTransformItems":149,"../sparql/BestLabelConfig":198,"../sparql/LabelUtils":214,"../sparql/search/KeywordSearchUtils":279,"../sponate/LookupServiceUtils":286,"../sponate/MappedConceptUtils":289,"../util/collection/HashMap":342,"./FacetServiceUtils":15,"./facet_service/FacetServiceClientIndex":44,"./facet_service/FacetServiceFn":45,"./facet_service/FacetServiceTransformConcept":50}],15:[function(e,module,t){var r=e("../sparql/ConceptUtils");var a=e("./FacetNode");var n=e("./facet_concept_supplier/FacetConceptSupplierExact");var i=e("./facet_concept_supplier/FacetConceptSupplierDeclared");var s=e("./facet_service/FacetServiceSparql");var o=e("./facet_service/FacetServiceTransformConcept");var l=e("./facet_service/FacetServiceClientIndex");var c=e("./facet_service/FacetServiceLookup");var u=e("../sparql/LabelUtils");var d=e("../sparql/search/KeywordSearchUtils");var p=e("./FacetConfig");var h=e("./ConstraintManager");var v=e("../sparql/BestLabelConfig");var f=e("../sponate/MappedConceptUtils");var g=e("../sponate/LookupServiceUtils");var m=e("../service/lookup_service/LookupServiceMulti");var x=e("../service/lookup_service/LookupServiceKeyMap");var _=e("../service/lookup_service/LookupServiceTransformKey");var b=e("../service/lookup_service/LookupServiceFn");var y=e("../service/lookup_service/LookupServiceConst");var S=e("./FacetUtils");var C=e("./lookup_service/LookupServiceFacetCount");var E=e("./lookup_service/LookupServiceFacetPreCount");var w=e("./lookup_service/LookupServiceFacetExactCount");var k=e("./Step");var L=e("./Path");var q={createFacetConceptSupplier:function(e){var t=new i(e);return t},createFacetService:function(e,t){var r=q.createFacetConceptSupplier(t);var a=new s(e,r);var n=function(r){var a;if(r==null){a=new m({id:new x,countInfo:new y({count:0,hasMoreItems:true})})}else{var n=S.createFacetRelationIndex(t,r);var i=new E(e,n);var s=new w(e,n);var o=new C(i,s);a=new m({id:new x,valueCountInfo:o})}return a};a=new c(a,n);return a}};module.exports=q},{"../service/lookup_service/LookupServiceConst":154,"../service/lookup_service/LookupServiceFn":156,"../service/lookup_service/LookupServiceKeyMap":158,"../service/lookup_service/LookupServiceMulti":160,"../service/lookup_service/LookupServiceTransformKey":164,"../sparql/BestLabelConfig":198,"../sparql/ConceptUtils":203,"../sparql/LabelUtils":214,"../sparql/search/KeywordSearchUtils":279,"../sponate/LookupServiceUtils":286,"../sponate/MappedConceptUtils":289,"./ConstraintManager":5,"./FacetConfig":10,"./FacetNode":11,"./FacetUtils":20,"./Path":22,"./Step":26,"./facet_concept_supplier/FacetConceptSupplierDeclared":40,"./facet_concept_supplier/FacetConceptSupplierExact":41,"./facet_service/FacetServiceClientIndex":44,"./facet_service/FacetServiceLookup":46,"./facet_service/FacetServiceSparql":48,"./facet_service/FacetServiceTransformConcept":50,"./lookup_service/LookupServiceFacetCount":58,"./lookup_service/LookupServiceFacetExactCount":59,"./lookup_service/LookupServiceFacetPreCount":60}],16:[function(e,module,t){var r=e("../ext/Class");var a=e("../sparql/BestLabelConfig");var n=e("./FacetConfig");var i=e("../util/collection/HashMap");var s=e("./FacetTreeState");var o=e("./ListFilter");var l=r.create({initialize:function(e,t,r,o,l,c){this.facetConfig=e||new n;this.bestLiteralConfig=t||new a;this.facetTreeState=r||new s;this.pathToTags=o||new i;this.tagFn=c},getFacetConfig:function(){return this.facetConfig},getFacetTreeState:function(){return this.facetTreeState},getBestLiteralConfig:function(){return this.bestLiteralConfig},getPathToTags:function(){return this.pathToTags},getTagFn:function(){return this.tagFn}});module.exports=l},{"../ext/Class":2,"../sparql/BestLabelConfig":198,"../util/collection/HashMap":342,"./FacetConfig":10,"./FacetTreeState":19,"./ListFilter":21}],17:[function(e,module,t){var r=e("./Step");var a=e("./Path");var n=e("./PathHead");var i=e("../util/shared");var s=i.Promise;var o=e("./FacetNodeState");var l=e("./ListFilter");var c=e("../util/ObjectUtils");var u={fetchFacetTree:function(e,t,r){var a=u.fetchFacetTreePathRec(e,t,r).then(function(e){var t=r==null?e.outgoing.children[0]:e;return t});return a},fetchFacetTreePathRec:function(e,t,r){r=r||null;var a=t.getPathExpansions();var i=t.getPathToDirection();var o=r?a.contains(r):true;var l=i.get(r)||1;var c=[];if(o){var u;var d;if(l==null||l===1||l===2){u=r?new n(r,false):null;d=this.fetchFacetTreePathHeadRec(e,t,u);c.push(d)}else{c.push(null)}if(l===-1||l===2){u=r?new n(r,true):null;d=this.fetchFacetTreePathHeadRec(e,t,u);c.push(d)}else{c.push(null)}}return s.all(c).spread(function(e,t){var a={path:r,isExpanded:o,outgoing:e,incoming:t};return a})},fetchFacetTreePathHeadRec:function(e,t,r){var a=t.getPathHeadToFilter();var n=a.get(r)||new l(null,10);var i=s.resolve(e.prepareListService(r)).then(function(e){var t=e.fetchItems(n.getConcept(),n.getLimit(),n.getOffset());var r=e.fetchCount(n.getConcept());return[t,r]}).spread(function(a,i){var o=a.map(function(e){return e.val});var l=o.map(function(r){var a=r.path;if(!a){throw new Error("Could not obtain a path for the sub facets of "+JSON.stringify(r))}var n=u.fetchFacetTreePathRec(e,t,a);return n});var d=s.all(l).then(function(e){o.forEach(function(t,r){var a=e[r];c.extend(t,a)});var t={path:r?r.getPath():null,pathHead:r,childCountInfo:i,listFilter:n,children:o};return t});return d});return i}};module.exports=u},{"../util/ObjectUtils":331,"../util/shared":350,"./FacetNodeState":12,"./ListFilter":21,"./Path":22,"./PathHead":23,"./Step":26}],18:[function(e,module,t){var r=e("./facet_tree_service/FacetTreeService");var a=e("../util/collection/HashMap");var n=e("./FacetServiceBuilder");var i=e("./FacetNodeState");var s={createFacetTreeService:function(e,t){var a=t.getFacetConfig();var i=t.getPathToTags();var s=function(e){var r=t.getTagFn();if(r){e=r(e)}return e};var o=n.core(e,a).labelConfig().index().pathToTags(i).tagFn(s).create();var l=new r(o,t.getFacetTreeState());return l}};module.exports=s},{"../util/collection/HashMap":342,"./FacetNodeState":12,"./FacetServiceBuilder":14,"./facet_tree_service/FacetTreeService":52}],19:[function(e,module,t){var r=e("../ext/Class");var a=e("./ListFilter");var n=e("../util/collection/HashMap");var i=e("../util/collection/HashSet");var s=r.create({initialize:function(e,t,r){this.pathExpansions=e||new i;this.pathToDirection=t||new n;this.pathHeadToFilter=r||new n},getPathExpansions:function(){return this.pathExpansions},getPathToDirection:function(){return this.pathToDirection},getPathHeadToFilter:function(){return this.pathHeadToFilter}});module.exports=s},{"../ext/Class":2,"../util/collection/HashMap":342,"../util/collection/HashSet":343,"./ListFilter":21}],20:[function(e,module,t){var r=e("../sparql/Concept");var a=e("../sparql/Relation");var n=e("../util/collection/HashMap");var i=e("../rdf/NodeFactory");var s=e("../rdf/Triple");var o=e("../rdf/NodeUtils");var l=e("../sparql/expr/ExprVar");var c=e("../sparql/expr/E_Equals");var u=e("../sparql/expr/NodeValue");var d=e("../sparql/NodeValueUtils");var p=e("../sparql/expr/E_LogicalNot");var h=e("../sparql/expr/E_OneOf");var v=e("../sparql/element/ElementGroup");var f=e("../sparql/element/ElementFilter");var g=e("../sparql/element/ElementTriplesBlock");var m=e("../sparql/PatternUtils");var x=e("../sparql/ElementUtils");var _=e("../sparql/VarUtils");var b=e("./Step");var y=e("./StepUtils");var S=e("./StepRelation");var C=e("./FacetRelationIndex");var E=e("./PathHead");var w={createConceptResources:function(e,t,a){var n=e.getBaseConcept();var i=e.getRootFacetNode();var s=e.getConstraintManager();var o=a?t:null;var l=s.createElementsAndExprs(i,o);var c=l.getElements();var u=l.getExprs();var d=i.forPath(t);var p=d.getVar();var h=n.getElements();var g=d.getElements();var m=[];m.push.apply(m,g);m.push.apply(m,c);if(n.isSubjectConcept()){if(m.length===0){m=h}}else{m.push.apply(m,h)}var x=u.map(function(e){var t=new f(e);return t});m.push.apply(m,x);var _=new v(m).flatten();var b=new r(_,p);return b},createConceptFacets:function(e,t){var a=this.createRelationFacets(e,t);var n=new r(a.getElement(),a.getSourceVar());return n},createRelationFacets:function(e,t,r){var n=t.getPath();var i=t.isInverse();var o=e.getBaseConcept();var u=e.getRootFacetNode();var p=e.getConstraintManager();var h=null;if(r){h=new b(r.getUri(),i)}var x=null;if(h){x=n.copyAppendStep(h)}var y=p.createElementsAndExprs(u,x);var S=y.toElements();var C=u.forPath(n);var E=C.getVar();var w=o.getElements();var k;if(o.isSubjectConcept()){k=S}else{k=w.concat(S)}var L=m.getVarsMentioned(k);var q=_.freshVar("p",L);var j=_.freshVar("o",L);var A=!i?new s(E,q,j):new s(j,q,E);k.push(new g([A]));if(h){var F=new l(q);var T=new c(F,d.makeNode(r));k.push(new f(T))}var U=C.getElements();k.push.apply(k,U);var V=new v(k).flatten();var N=new a(V,q,j);return N},createStepRelationsProperties:function(e,t,r,n){var i=[];var s=t.getPath();var l=t.isInverse();var c=e.getBaseConcept();var u=e.getRootFacetNode();var d=e.getConstraintManager();var p=r.map(o.getUri);var h=u.forPath(s);var f=d.getConstrainedSteps(s);var g=f.filter(function(e){var t=e.isInverse()===l;if(!t){return false}var r=p.indexOf(e.getPropertyName())>=0;var a=n?!r:r;return a});var m=g.map(y.getPropertyName);var x=[];var _=[];r.forEach(function(e){if(m.indexOf(e.getUri())>=0){_.push(e)}else{x.push(e)}});var b=this.createStepRelations(e,s,g);i.push.apply(i,b);var C=this.createRelationFacets(e,t);var E=this.createElementFilterBindVar(C.getSourceVar(),x,false);if(E!=null){C=new a(new v([C.getElement(),E]),C.getSourceVar(),C.getTargetVar())}if(x.length>0||n){var w=new S(null,C);i.push(w)}return i},createFacetRelationIndex:function(e,t){var r=w.createStepRelationsProperties(e,t,[],true);var a=r.length>0?r[0].getRelation().getSourceVar():null;var s=new n;var o=null;r.forEach(function(e){var t=e.getStep();var r=e.getRelation();var a=t?i.createUri(t.getPropertyName()):null;if(a){s.put(a,r)}else{o=r}});var l=new C(a,o,s);return l},createElementFilterBindVar:function(e,t,r){var a=null;if(t.length>0){var n=new h(new l(e),t);if(r){n=new p(n)}a=new f(n)}return a},createStepRelations:function(e,t,r){var a=this;var n=r.map(function(r){var n=a.createStepRelation(e,t,r);return n});return n},createStepRelation:function(e,t,r){var a=r.getPropertyName();var n=i.createUri(a);var s=new E(t,r.isInverse());var o=this.createRelationFacets(e,s,n);var l=new S(r,o);return l}};module.exports=w},{"../rdf/NodeFactory":92,"../rdf/NodeUtils":93,"../rdf/Triple":95,"../sparql/Concept":202,"../sparql/ElementUtils":206,"../sparql/NodeValueUtils":215,"../sparql/PatternUtils":216,"../sparql/Relation":220,"../sparql/VarUtils":226,"../sparql/element/ElementFilter":231,"../sparql/element/ElementGroup":232,"../sparql/element/ElementTriplesBlock":236,"../sparql/expr/E_Equals":245,"../sparql/expr/E_LogicalNot":253,"../sparql/expr/E_OneOf":256,"../sparql/expr/ExprVar":268,"../sparql/expr/NodeValue":269,"../util/collection/HashMap":342,"./FacetRelationIndex":13,"./PathHead":23,"./Step":26,"./StepRelation":27,"./StepUtils":28}],21:[function(e,module,t){var r=e("../ext/Class");var a=r.create({initialize:function(e,t,r){this.concept=e;this.limit=t;this.offset=r},getConcept:function(){return this.concept},setConcept:function(e){this.concept=e},getLimit:function(){return this.limit},setLimit:function(e){this.limit=e},getOffset:function(){return this.offset},setOffset:function(e){this.offset=e}});module.exports=a},{"../ext/Class":2}],22:[function(e,module,t){var r=e("../ext/Class");var a=e("./Step");var n=r.create({classLabel:"jassa.facete.Path",initialize:function(e){this.steps=e?e:[]},getParent:function(){var e=this.steps.length;var t=e===0?null:new n(this.steps.slice(0,e-1));return t},getLength:function(){return this.steps.length},isEmpty:function(){var e=this.steps.length===0;return e},toString:function(){var e=this.steps.join(" ");return e},concat:function(e){var t=new n(this.steps.concat(e.steps));return t},getLastStep:function(){var e=this.steps;var t=e.length;var r;if(t===0){r=null}else{r=e[t-1]}return r},getSteps:function(){return this.steps},startsWith:function(e){var t=e.steps.length;if(t>this.steps.length){return false}for(var r=0;r<t;++r){var a=this.steps[r];var n=e.steps[r];if(!a.equals(n)){return false}}return true},hashCode:function(){return this.toString()},equals:function(e){if(!e){return false}var t=this.steps.length;if(t!=e.steps.length){return false}var r=this.startsWith(e);return r},copyAppendStep:function(e){var t=this.steps.slice(0);t.push(e);var r=new n(t);return r},toJson:function(){var e=[];var t=this.steps;for(var r=0;r<t.length;++r){var a=t[r];var n=a.toJson();e.push(n)}return e},getPropertyNames:function(){var e=[];var t=this.steps;for(var r=0;r<t.length;++r){var a=t[r];var n=a.getPropertyName();e.push(n)}return e}});n.fromJson=function(e){var t=[];for(var r=0;r<e.length;++r){var i=e[r];var s=a.fromJson(i);t.push(s)}var o=new n(t);return o};n.parse=function(e){e=e.trim();var t=e.length!==0?e.split(" "):[];var r=t.map(function(e){return a.parse(e)
});var i=new n(r);return i};module.exports=n},{"../ext/Class":2,"./Step":26}],23:[function(e,module,t){var r=e("../ext/Class");var a=e("./Path");var n=r.create({initialize:function(e,t){this.path=e;this._isInverse=!!t},getPath:function(){return this.path},isInverse:function(){return this._isInverse},toString:function(){return""+this.path+(this._isInverse?" (inverse)":"")}});n.parse=function(e,t){var r=a.parse(e);var i=new n(r,!!t);return i};module.exports=n},{"../ext/Class":2,"./Path":22}],24:[function(e,module,t){var r=e("../rdf/NodeFactory");var a=e("../sparql/Query");var n=e("../sparql/expr/ExprVar");var i=e("../sparql/SortCondition");var s=[];var o=e("../sparql/expr/E_LogicalNot");var l=e("../sparql/expr/E_Bound");var c={createQueryFacet:function(e,t){if(!e){return null}var c=t.isDistinct();var u=new a;u.setQueryPattern(e);var d=t.getColumns();var p={};var h=[];var v=[];d.forEach(function(e){var t=e.getId();var a=r.createVar(t);var i=new n(a);var o=e.getAggregator();if(o){h.push(t);var l=o.getName();var c=s[l];if(!c){throw new Error("No aggExprFactory for "+l)}var d=c.createExpr(i);i=d;u.getProject().add(a,i)}else{v.push(t);u.getProject().add(a)}p[t]=i});if(h.length>0){v.forEach(function(e){var t=p[e];u.getGroupBy().push(t)});c=false}var f=t.getLimitAndOffset();u.setLimit(f.getLimit());u.setOffset(f.getOffset());var g=t.getSortConditions();g.forEach(function(e){var t=e.getColumnId();var r=p[t];if(!r){console.log("[ERROR] Should not happen");throw new Error("Should not happen")}var a=e.getSortDir();var n=e.getSortType();var s=null;switch(n){case"null":if(h.indexOf(t)<0){if(a>0){s=new i(new o(new l(r)),1)}else if(a<0){s=new i(new l(r),1)}}break;case"data":s=!a?null:new i(r,a);break;default:throw new Error("Should not happen")}if(s){u.getOrderBy().push(s)}});u.setDistinct(c);return u}}},{"../rdf/NodeFactory":92,"../sparql/Query":217,"../sparql/SortCondition":222,"../sparql/expr/E_Bound":243,"../sparql/expr/E_LogicalNot":253,"../sparql/expr/ExprVar":268}],25:[function(e,module,t){},{}],26:[function(e,module,t){var r=e("lodash.isequal");var a=e("../ext/Class");var n=e("../rdf/NodeFactory");var i=e("../rdf/Triple");var s=e("../sparql/element/ElementTriplesBlock");var o=e("../util/ObjectUtils");var l=a.create({classLabel:"jassa.facete.Step",initialize:function(e,t){this.type="property";this.propertyName=e;this._isInverse=t},toJson:function(){var e={isInverse:this.isInverse,propertyName:this.propertyName};return e},getPropertyName:function(){return this.propertyName},isInverse:function(){return this._isInverse},equals:function(e){var t=r(this,e);return t},toString:function(){if(this._isInverse){return"<"+this.propertyName}else{return this.propertyName}},createElement:function(e,t,r){var a=n.createUri(this.propertyName);var o;if(this._isInverse){o=new i(t,a,e)}else{o=new i(e,a,t)}var l=new s([o]);return l}});l.fromJson=function(e){var t=e.propertyName;var r=e.IsInverse();var a=new l(t,r);return a};l.parse=function(e){var t;if(e.charAt(0)==="<"){t=new l(e.substring(1),true)}else{t=new l(e,false)}return t};module.exports=l},{"../ext/Class":2,"../rdf/NodeFactory":92,"../rdf/Triple":95,"../sparql/element/ElementTriplesBlock":236,"../util/ObjectUtils":331,"lodash.isequal":462}],27:[function(e,module,t){var r=e("../ext/Class");var a=r.create({initialize:function(e,t){this.step=e;this.relation=t},getStep:function(){return this.step},getRelation:function(){return this.relation},toString:function(){return this.step+": "+this.relation}});module.exports=a},{"../ext/Class":2}],28:[function(e,module,t){var r={getPropertyName:function(e){var t=e.getPropertyName();return t}};module.exports=r},{}],29:[function(e,module,t){var r=e("lodash.foreach");var a=e("../ext/Class");var n=e("./VarNode");var i=e("./Step");var n=a.create({initialize:function(e,t,r,a,n){this.variableName=e;this.generator=t;this.stepId=r;this.parent=a;this.root=n;if(!this.root){if(this.parent){this.root=a.root}else{this.root=this}}this.idToChild={}},isRoot:function(){var e=this.parent?false:true;return e},getVariableName:function(){return this.variableName},getIdStr:function(){var e=this.parent?this.parent.getIdStr():"";var t=e+this.variableName;return t},getStepId:function(e){return""+JSON.stringify(e)},getSteps:function(){return this.steps},forProperty:function(e,t){var r=new i(e,t);var a=this.forStep(r);return a},forStepId:function(e){var t=this.idToChild[e];if(!t){var r=this.generator.next();t=new n(r,this.generator,e,this);this.idToChild[e]=t}return t},findNodeByVarName:function(e){if(this.variableName===e){return this}var t=[];r(this.idToChild,function(e){t.push(e)});for(var a=0;a<t.length;++a){var n=t[a];var i=n.findNodeByVarName(e);if(i){return i}}return null}});module.exports=n},{"../ext/Class":2,"./Step":26,"./VarNode":29,"lodash.foreach":432}],30:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({getName:function(){throw new Error("Override me")},getDeclaredPaths:function(){console.log("[ERROR] Override me");throw new Error("Override me")},createElementsAndExprs:function(e){throw new Error("Override me")},equals:function(){throw new Error("Override me")},hashCode:function(){throw new Error("Override me")}});module.exports=a},{"../../ext/Class":2}],31:[function(e,module,t){var r=e("../../ext/Class");var a=e("./Constraint");var n=r.create(a,{initialize:function(e,t){this.name=e;this.path=t},getName:function(){return this.name},getDeclaredPaths:function(){return[this.path]},getDeclaredPath:function(){return this.path}});module.exports=n},{"../../ext/Class":2,"./Constraint":30}],32:[function(e,module,t){var r=e("../../ext/Class");var a=e("../../util/ObjectUtils");var n=e("./ConstraintBasePath");var i=r.create(n,{initialize:function($super,e,t,r){$super(e,t);this.value=r},getValue:function(){return this.value},equals:function(e){if(!e instanceof n){return false}var t=this.name==e.name;var r=this.path.equals(e.path);var a=this.value.equals(e.value);var i=t&&r&&a;return i},hashCode:function(){var e=a.hashCode(this,true);return e}});module.exports=i},{"../../ext/Class":2,"../../util/ObjectUtils":331,"./ConstraintBasePath":31}],33:[function(e,module,t){var r=e("../../ext/Class");var a=e("../ConstraintUtils");var n=e("./ConstraintBasePath");var i=e("../../util/ObjectUtils");var s=r.create(n,{classLabel:"jassa.facete.ConstraintConcept",initialize:function($super,e,t){$super("concept",e);this.concept=t},createElementsAndExprs:function(e){var t=a.createConstraintConcept(e,this.path,this.concept);return t},equals:function(e){var t=e&&this.path.equals(e.path)&&""+this.concept===""+e.concept;return t},hashCode:function(){var e=i.hashCode(this,true);return e}});module.exports=s},{"../../ext/Class":2,"../../util/ObjectUtils":331,"../ConstraintUtils":6,"./ConstraintBasePath":31}],34:[function(e,module,t){},{}],35:[function(e,module,t){var r=e("../../ext/Class");var a=e("../ConstraintUtils");var n=e("./ConstraintBasePathValue");var i=r.create(n,{classLabel:"jassa.facete.ConstraintEquals",initialize:function($super,e,t){$super("equals",e,t)},createElementsAndExprs:function(e){var t=a.createConstraintEquals(e,this.path,this.value);return t}});module.exports=i},{"../../ext/Class":2,"../ConstraintUtils":6,"./ConstraintBasePathValue":32}],36:[function(e,module,t){var r=e("../../ext/Class");var a=e("../ConstraintUtils");var n=e("./ConstraintBasePath");var i=r.create(n,{classLabel:"jassa.facete.ConstraintExists",initialize:function($super,e){$super("exists",e)},createElementsAndExprs:function(e){var t=a.createConstraintExists(e,this.path);return t}});module.exports=i},{"../../ext/Class":2,"../ConstraintUtils":6,"./ConstraintBasePath":31}],37:[function(e,module,t){var r=e("../../ext/Class");var a=e("../ConstraintUtils");var n=e("./ConstraintBasePathValue");var i=r.create(n,{classLabel:"jassa.facete.ConstraintLang",initialize:function($super,e,t){$super("lang",e,t)},createElementsAndExprs:function(e){var t=a.createConstraintLang(e,this.path,this.value);return t}});module.exports=i},{"../../ext/Class":2,"../ConstraintUtils":6,"./ConstraintBasePathValue":32}],38:[function(e,module,t){var r=e("../../ext/Class");var a=e("../ConstraintUtils");var n=e("./ConstraintBasePathValue");var i=r.create(n,{classLabel:"jassa.facete.ConstraintRegex",initialize:function($super,e,t){$super("regex",e,t)},createElementsAndExprs:function(e){var t=a.createConstraintRegex(e,this.path,this.value.getLiteralLexicalForm());return t}});module.exports=i},{"../../ext/Class":2,"../ConstraintUtils":6,"./ConstraintBasePathValue":32}],39:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({getConcept:function(e){throw new Error("Override me")}});module.exports=a},{"../../ext/Class":2}],40:[function(e,module,t){var r=e("../../ext/Class");var a=e("./FacetConceptSupplierExact");var n=e("../../sparql/CannedConceptUtils");var i=r.create(a,{initialize:function($super,e){$super(e)},getConcept:function($super,e){var t=this.facetConfig;var r=e.getPath();var a=t.getConstraintManager();var i=t.getBaseConcept();var s=i.isSubjectConcept();var o=r.isEmpty();var l=a.isEmpty();var c=s&&o&&l;var u=c?n.createConceptDeclaredProperties(i.getVar()):$super(e);console.log("ARGH: "+u);return u}});module.exports=i},{"../../ext/Class":2,"../../sparql/CannedConceptUtils":201,"./FacetConceptSupplierExact":41}],41:[function(e,module,t){var r=e("../../ext/Class");var a=e("../../sparql/Concept");var n=e("../FacetUtils");var i=e("./FacetConceptSupplier");var s=r.create(i,{initialize:function(e){this.facetConfig=e},getConcept:function(e){var t=n.createRelationFacets(this.facetConfig,e);var r=new a(t.getElement(),t.getSourceVar());return r}});module.exports=s},{"../../ext/Class":2,"../../sparql/Concept":202,"../FacetUtils":20,"./FacetConceptSupplier":39}],42:[function(e,module,t){var r=e("../../ext/Class");var a=e("../../util/collection/HashMap");var n=e("../FacetUtils");var i=e("./FacetConceptSupplier");var s=r.create({initialize:function(e,t){this.facetConceptSupplierFallback=e;this.pathHeadToConcept=t||new a},getPathHeadToConcept:function(){return this.pathHeadToConcept},getConcept:function(e){var t=this.pathHeadToConcept.get(e);var r=t||this.facetConceptSupplierFallback.getConcept(e);return r}});module.exports=s},{"../../ext/Class":2,"../../util/collection/HashMap":342,"../FacetUtils":20,"./FacetConceptSupplier":39}],43:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({prepareListService:function(e){throw new Error("Not overridden")}});module.exports=a},{"../../ext/Class":2}],44:[function(e,module,t){var r=e("../../ext/Class");var a=e("../../service/list_service/ListServiceArray");var n=e("../../service/list_service/ListServiceTransformItem");var i=e("../../util/shared");var s=i.Promise;var o=r.create({initialize:function(e,t,r){this.facetService=e;this.filterSupplierFn=t;this.itemLimit=r||100},prepareListService:function(e){var t=this;var r=s.resolve(this.facetService.prepareListService(e)).then(function(e){var r=e.fetchCount(null,t.itemLimit);return[r,e]}).spread(function(e,r){var n=e.hasMoreItems?r:r.fetchItems().then(function(e){var r=new a(e,t.filterSupplierFn);return r});return n});return r}});module.exports=o},{"../../ext/Class":2,"../../service/list_service/ListServiceArray":139,"../../service/list_service/ListServiceTransformItem":148,"../../util/shared":350}],45:[function(e,module,t){var r=e("../../ext/Class");var a=e("./FacetService");var n=r.create(a,{initialize:function(e,t){this.facetService=e;this.fn=t},prepareListService:function(e){var t=this;var r=this.facetService.prepareListService(e).then(function(e){var r=t.fn(e);return r});return r}});module.exports=n},{"../../ext/Class":2,"./FacetService":43}],46:[function(e,module,t){var r=e("../../ext/Class");var a=e("./FacetService");var n=e("../../util/collection/HashMap");var i=e("../../service/list_service/ListServiceConceptKeyLookup");var s=e("../../service/list_service/ListServiceTransformItem");var o=r.create(a,{initialize:function(e,t){this.facetService=e;this.fnLookupService=t},prepareListService:function(e){var t=this.fnLookupService(e);var r=this.facetService.prepareListService(e).then(function(e){e=new i(e,t,function(e){var t=e.val.property;return t});return e});return r}});module.exports=o},{"../../ext/Class":2,"../../service/list_service/ListServiceConceptKeyLookup":142,"../../service/list_service/ListServiceTransformItem":148,"../../util/collection/HashMap":342,"./FacetService":43}],47:[function(e,module,t){var r=e("../../ext/Class");var a=e("./FacetService");var n=e("../../util/collection/HashMap");var i=r.create(a,{initialize:function(e,t){this.facetServiceFallback=e;this.pathHeadToFacetService=this.pathHeadToFacetService||new n},getPathHeadToFacetService:function(){return this.pathHeadToFacetService},prepareListService:function(e){var t=this.pathHeadToFacetService.get(e);var r=t||this.facetServiceFallback;var a=r.prepareListService(e);return a}});module.exports=i},{"../../ext/Class":2,"../../util/collection/HashMap":342,"./FacetService":43}],48:[function(e,module,t){var r=e("../../ext/Class");var a=e("../../rdf/NodeFactory");var n=e("../../sparql/Concept");var i=e("../../sparql/ConceptUtils");var s=e("../../service/list_service/ListServiceArray");var o=e("../../service/list_service/ListServiceSparqlQuery");var l=e("../../service/list_service/ListServiceTransformItem");var c=e("./FacetService");var u=e("../FacetUtils");var d=e("../../sparql/RelationUtils");var p=e("../../sparql/VarUtils");var h=e("../Step");var v=e("../Path");var f=e("../../util/shared");var g=f.Promise;var m=r.create(c,{initialize:function(e,t){this.sparqlService=e;this.facetConceptSupplier=t},prepareListService:function(e){var t;if(e==null){var r=new v;var n=[{key:r,val:{path:r,property:a.createUri("http://facete.aksw.org/resource/rootFacet")}}];t=new s(n,function(e){return function(e){return true}})}else{var c=this.facetConceptSupplier.getConcept(e);var u=i.createQueryList(c);t=new o(this.sparqlService,u,c.getVar(),false);t=new l(t,function(t){var r=t.key;var a=new h(r.getUri(),e.isInverse());var n=e.getPath().copyAppendStep(a);var i={key:r,val:{path:n,property:r}};return i})}var d=g.resolve(t);return d}});module.exports=m},{"../../ext/Class":2,"../../rdf/NodeFactory":92,"../../service/list_service/ListServiceArray":139,"../../service/list_service/ListServiceSparqlQuery":145,"../../service/list_service/ListServiceTransformItem":148,"../../sparql/Concept":202,"../../sparql/ConceptUtils":203,"../../sparql/RelationUtils":221,"../../sparql/VarUtils":226,"../../util/shared":350,"../FacetUtils":20,"../Path":22,"../Step":26,"./FacetService":43}],49:[function(e,module,t){},{}],50:[function(e,module,t){var r=e("../../ext/Class");var a=e("../../service/list_service/ListServiceTransformConcept");var n=e("./FacetService");var i=r.create({initialize:function(e,t){this.facetService=e;this.fnTransform=t},prepareListService:function(e){var t=this.facetService.prepareListService(e);var r=this;var n=t.then(function(e){var t=new a(e,r.fnTransform);return t});return n}});module.exports=i},{"../../ext/Class":2,"../../service/list_service/ListServiceTransformConcept":146,"./FacetService":43}],51:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({createFacetService:function(e,t){throw new Error("Override me")}});module.exports=a},{"../../ext/Class":2}],52:[function(e,module,t){var r=e("../../ext/Class");var a=e("../FacetTreeServiceHelpers");var n=r.create({initialize:function(e,t){this.facetService=e;this.facetTreeState=t},fetchFacetTree:function(e){var t=a.fetchFacetTree(this.facetService,this.facetTreeState,e);return t}});module.exports=n},{"../../ext/Class":2,"../FacetTreeServiceHelpers":17}],53:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({prepareConcept:function(e,t){throw new Error("Method not overridden")}});module.exports=a},{"../../ext/Class":2}],54:[function(e,module,t){var r=e("../../ext/Class");var a=e("./FacetValueConceptService");var n=e("../FacetUtils");var i=e("../../util/shared");var s=i.Promise;var o=r.create({initialize:function(e){this.facetConfig=e},prepareConcept:s.method(function(e,t){var r=n.createConceptResources(this.facetConfig,e,t);return r})});module.exports=o},{"../../ext/Class":2,"../../util/shared":350,"../FacetUtils":20,"./FacetValueConceptService":53}],55:[function(e,module,t){var r=e("../../ext/Class");var a=e("../../sparql/Relation");var n=e("../../sparql/RelationUtils");var i=e("../FacetUtils.js");var s=e("../../sparql/ElementUtils");var o=e("../../sparql/ConceptUtils");var l=e("../../service/ServiceUtils");var c=e("../../service/list_service/ListServiceSparqlQuery");var u=e("../../sparql/SortCondition");var d=r.create({initialize:function(e,t,r){this.sparqlService=e;this.rowLimit=r||1e5;this.facetConfig=t},prepareTableService:function(e,t){var r=i.createConceptResources(this.facetConfig,e,t);console.log("FacetValueConcept: "+r+" config: ",this.facetConfig);var d=this.facetConfig.getRootFacetNode().getVar();var p=this;var h=l.fetchCountRows(this.sparqlService,r.getElement(),this.rowLimit).then(function(e){var t=e.hasMoreItems===false;var i;var l;if(t){var h=new a(r.getElement(),r.getVar(),d);var v=s.freshVar(h.getElement(),"c");l=n.createQueryDistinctValueCount(h,v);l.getOrderBy().push(new u(l.getProject().getExpr(v),"desc"));i=new c(p.sparqlService,l,r.getVar())}else{l=o.createQueryList(r);i=new c(p.sparqlService,l,r.getVar())}return i});return h}});module.exports=d},{"../../ext/Class":2,"../../service/ServiceUtils":126,"../../service/list_service/ListServiceSparqlQuery":145,"../../sparql/ConceptUtils":203,"../../sparql/ElementUtils":206,"../../sparql/Relation":220,"../../sparql/RelationUtils":221,"../../sparql/SortCondition":222,"../FacetUtils.js":20}],56:[function(e,module,t){"use strict";var r={ConstraintManager:e("./ConstraintManager"),ConstraintUtils:e("./ConstraintUtils"),CountUtils:e("./CountUtils"),ElementUtils:e("./ElementUtils"),ElementsAndExprs:e("./ElementsAndExprs"),FacetConfig:e("./FacetConfig"),FacetNode:e("./FacetNode"),FacetNodeState:e("./FacetNodeState"),FacetRelationIndex:e("./FacetRelationIndex"),FacetServiceBuilder:e("./FacetServiceBuilder"),FacetServiceUtils:e("./FacetServiceUtils"),FacetTreeConfig:e("./FacetTreeConfig"),FacetTreeServiceHelpers:e("./FacetTreeServiceHelpers"),FacetTreeServiceUtils:e("./FacetTreeServiceUtils"),FacetTreeState:e("./FacetTreeState"),FacetUtils:e("./FacetUtils"),ListFilter:e("./ListFilter"),Path:e("./Path"),PathHead:e("./PathHead"),QueryUtils:e("./QueryUtils"),ServiceUtils:e("./ServiceUtils"),Step:e("./Step"),StepRelation:e("./StepRelation"),StepUtils:e("./StepUtils"),VarNode:e("./VarNode"),Constraint:e("./constraint/Constraint"),ConstraintBasePath:e("./constraint/ConstraintBasePath"),ConstraintBasePathValue:e("./constraint/ConstraintBasePathValue"),ConstraintConcept:e("./constraint/ConstraintConcept"),ConstraintElementFactoryBBoxRange:e("./constraint/ConstraintElementFactoryBBoxRange"),ConstraintEquals:e("./constraint/ConstraintEquals"),ConstraintExists:e("./constraint/ConstraintExists"),ConstraintLang:e("./constraint/ConstraintLang"),ConstraintRegex:e("./constraint/ConstraintRegex"),FacetConceptSupplier:e("./facet_concept_supplier/FacetConceptSupplier"),FacetConceptSupplierDeclared:e("./facet_concept_supplier/FacetConceptSupplierDeclared"),FacetConceptSupplierExact:e("./facet_concept_supplier/FacetConceptSupplierExact"),FacetConceptSupplierMeta:e("./facet_concept_supplier/FacetConceptSupplierMeta"),FacetService:e("./facet_service/FacetService"),FacetServiceClientIndex:e("./facet_service/FacetServiceClientIndex"),FacetServiceFn:e("./facet_service/FacetServiceFn"),FacetServiceLookup:e("./facet_service/FacetServiceLookup"),FacetServiceMeta:e("./facet_service/FacetServiceMeta"),FacetServiceSparql:e("./facet_service/FacetServiceSparql"),FacetServiceTagger:e("./facet_service/FacetServiceTagger"),FacetServiceTransformConcept:e("./facet_service/FacetServiceTransformConcept"),FacetSystem:e("./facet_system/FacetSystem"),FacetTreeService:e("./facet_tree_service/FacetTreeService"),FacetValueConceptService:e("./facet_value_concept_service/FacetValueConceptService"),FacetValueConceptServiceExact:e("./facet_value_concept_service/FacetValueConceptServiceExact"),FacetValueService:e("./facet_value_service/FacetValueService"),LookupServiceConstraintLabels:e("./lookup_service/LookupServiceConstraintLabels"),LookupServiceFacetCount:e("./lookup_service/LookupServiceFacetCount"),LookupServiceFacetExactCount:e("./lookup_service/LookupServiceFacetExactCount"),LookupServiceFacetPreCount:e("./lookup_service/LookupServiceFacetPreCount"),LookupServicePathLabels:e("./lookup_service/LookupServicePathLabels"),Aggregator:e("./table/Aggregator"),ColumnView:e("./table/ColumnView"),FilterString:e("./table/FilterString"),QueryFactoryFacetTable:e("./table/QueryFactoryFacetTable"),SortCondition:e("./table/SortCondition"),TableConfigFacet:e("./table/TableConfigFacet"),TableMod:e("./table/TableMod"),TableUtils:e("./table/TableUtils")};Object.freeze(r);module.exports=r},{"./ConstraintManager":5,"./ConstraintUtils":6,"./CountUtils":7,"./ElementUtils":8,"./ElementsAndExprs":9,"./FacetConfig":10,"./FacetNode":11,"./FacetNodeState":12,"./FacetRelationIndex":13,"./FacetServiceBuilder":14,"./FacetServiceUtils":15,"./FacetTreeConfig":16,"./FacetTreeServiceHelpers":17,"./FacetTreeServiceUtils":18,"./FacetTreeState":19,"./FacetUtils":20,"./ListFilter":21,"./Path":22,"./PathHead":23,"./QueryUtils":24,"./ServiceUtils":25,"./Step":26,"./StepRelation":27,"./StepUtils":28,"./VarNode":29,"./constraint/Constraint":30,"./constraint/ConstraintBasePath":31,"./constraint/ConstraintBasePathValue":32,"./constraint/ConstraintConcept":33,"./constraint/ConstraintElementFactoryBBoxRange":34,"./constraint/ConstraintEquals":35,"./constraint/ConstraintExists":36,"./constraint/ConstraintLang":37,"./constraint/ConstraintRegex":38,"./facet_concept_supplier/FacetConceptSupplier":39,"./facet_concept_supplier/FacetConceptSupplierDeclared":40,"./facet_concept_supplier/FacetConceptSupplierExact":41,"./facet_concept_supplier/FacetConceptSupplierMeta":42,"./facet_service/FacetService":43,"./facet_service/FacetServiceClientIndex":44,"./facet_service/FacetServiceFn":45,"./facet_service/FacetServiceLookup":46,"./facet_service/FacetServiceMeta":47,"./facet_service/FacetServiceSparql":48,"./facet_service/FacetServiceTagger":49,"./facet_service/FacetServiceTransformConcept":50,"./facet_system/FacetSystem":51,"./facet_tree_service/FacetTreeService":52,"./facet_value_concept_service/FacetValueConceptService":53,"./facet_value_concept_service/FacetValueConceptServiceExact":54,"./facet_value_service/FacetValueService":55,"./lookup_service/LookupServiceConstraintLabels":57,"./lookup_service/LookupServiceFacetCount":58,"./lookup_service/LookupServiceFacetExactCount":59,"./lookup_service/LookupServiceFacetPreCount":60,"./lookup_service/LookupServicePathLabels":61,"./table/Aggregator":62,"./table/ColumnView":63,"./table/FilterString":64,"./table/QueryFactoryFacetTable":65,"./table/SortCondition":66,"./table/TableConfigFacet":67,"./table/TableMod":68,"./table/TableUtils":69}],57:[function(e,module,t){var r=e("../../ext/Class");var a=e("../../service/lookup_service/LookupServiceBase");var n=e("./LookupServicePathLabels");var i=e("../../util/collection/HashMap");var s=e("../../util/shared");var o=s.Promise;var l=r.create(a,{initialize:function(e,t){this.lookupServiceNodeLabels=e;this.lookupServicePathLabels=t||new n(e)},lookup:function(e){var t=[];var r=[];e.forEach(function(e){var a=e.getDeclaredPaths();var n=e.getValue?e.getValue():null;t.push.apply(t,a);if(n){r.push(n)}});var a=this.lookupServiceNodeLabels.lookup(r);var n=this.lookupServicePathLabels.lookup(t);var s=o.all([a,n]).spread(function(t,r){var a=new i;e.forEach(function(e){var n=e.getDeclaredPath();var i=e.getValue();var s=r.get(n);var o=t.get(i);var l=s+" = "+o;a.put(e,l)});return a});return s}});module.exports=l},{"../../ext/Class":2,"../../service/lookup_service/LookupServiceBase":151,"../../util/collection/HashMap":342,"../../util/shared":350,"./LookupServicePathLabels":61}],58:[function(e,module,t){var r=e("../../ext/Class");var a=e("../../util/collection/HashMap");var n=e("../../sparql/VarUtils");var i=e("../CountUtils");var s=e("../../service/lookup_service/LookupService");var o=e("../../util/shared");var l=o.Promise;var c=r.create(s,{initialize:function(e,t){this.lsPreCount=e;this.lsExactCount=t},lookup:function(e){var t=this;var r=l.resolve(this.lsPreCount.lookup(e)).then(function(e){var r=e.entries();var a=[];r.forEach(function(e){var t=e.key;var r=e.val;if(!r.hasMoreItems){a.push(t)}});var n=t.lsExactCount.lookup(a);return[e,n]}).spread(function(t,r){var n=new a;e.forEach(function(e){var a=r.get(e);a=a||t.get(e);if(!a){throw new Error("Should not happen")}n.put(e,a)});return n});return r}});module.exports=c},{"../../ext/Class":2,"../../service/lookup_service/LookupService":150,"../../sparql/VarUtils":226,"../../util/collection/HashMap":342,"../../util/shared":350,"../CountUtils":7}],59:[function(e,module,t){var r=e("../../ext/Class");var a=e("../../sparql/VarUtils");var n=e("../CountUtils");var i=e("../../util/collection/HashMap");var s=e("../../service/lookup_service/LookupService");var o=r.create(s,{initialize:function(e,t){this.sparqlService=e;this.facetRelationIndex=t},lookup:function(e){var t=a.c;var r=n.createQueriesExactCount(this.facetRelationIndex,t,e,this.rowLimit);var s=n.execQueries(this.sparqlService,r,this.facetRelationIndex.getSourceVar(),t);var o=s.then(function(e){var t=new i;var r=e.entries();r.forEach(function(e){var r=e.key;var a=e.val;var n={count:a,hasMoreItems:false};t.put(r,n)});return t});return o}});module.exports=o},{"../../ext/Class":2,"../../service/lookup_service/LookupService":150,"../../sparql/VarUtils":226,"../../util/collection/HashMap":342,"../CountUtils":7}],60:[function(e,module,t){var r=e("../../ext/Class");var a=e("../../sparql/VarUtils");var n=e("../CountUtils");var i=e("../../util/collection/HashMap");var s=e("../../service/lookup_service/LookupService");var o=r.create(s,{initialize:function(e,t){this.sparqlService=e;this.facetRelationIndex=t;this.rowLimit=1e4},lookup:function(e){var t=this.rowLimit;var r=a.c;var s=n.createQueriesPreCount(this.facetRelationIndex,r,e,t+1);var o=n.execQueries(this.sparqlService,s,this.facetRelationIndex.getSourceVar(),r);var l=o.then(function(e){var r=new i;var a=e.entries();a.forEach(function(e){var a=e.key;var n=e.val;var i=n>t;var s={count:i?t:n,hasMoreItems:i};r.put(a,s)});return r});return l}});module.exports=o},{"../../ext/Class":2,"../../service/lookup_service/LookupService":150,"../../sparql/VarUtils":226,"../../util/collection/HashMap":342,"../CountUtils":7}],61:[function(e,module,t){var r=e("../../ext/Class");var a=e("lodash.flatten");var n=e("lodash.uniq");var i=e("../../service/lookup_service/LookupServiceBase");var s=e("../../rdf/NodeFactory");var o=e("../../util/collection/HashMap");var l=r.create(i,{initialize:function(e){this.lookupServiceBase=e},lookup:function(e){var t=e.map(function(e){var t=e.getSteps().map(function(e){return e.getPropertyName()});return t});t=a(t);t=n(t);t=t.map(function(e){return s.createUri(e)});var r=this.lookupServiceBase.lookup(t).then(function(t){var r=new o;e.forEach(function(e){var a=e.getSteps().reduce(function(e,r){var a=e;var n=s.createUri(r.getPropertyName());var i=t.get(n);a=a===""?a:a+"&raquo;";a+=i;a=!r.isInverse()?a:a+"&sup1";return a},"");if(a===""){a="Items"}r.put(e,a)});return r});return r}});module.exports=l},{"../../ext/Class":2,"../../rdf/NodeFactory":92,"../../service/lookup_service/LookupServiceBase":151,"../../util/collection/HashMap":342,"lodash.flatten":363,"lodash.uniq":582}],62:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({initialize:function(e,t){this.name=e;this.attrs=t},getName:function(){return this.name},getAttrs:function(){return this.attrs}});module.exports=a},{"../../ext/Class":2}],63:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({initialize:function(e,t){this.tableMod=e;this.columnId=t},getId:function(){return this.columnId},getSortConditions:function(){var e={};var t=this.columnId;this.tableMod.getSortConditions().forEach(function(r){var a=r.getColumnId();if(a===t){var n=r.getSortType();e[n]=r.getSortDir()}});return e},getAggregator:function(){var e=this.tableMod.getAggregator(this.columnId);return e},setAggregator:function(e){this.tableMod.getAggregators()[this.columnId]=e}});module.exports=a},{"../../ext/Class":2}],64:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({initialize:function(e,t){this.str=e;this.mode=t}})},{"../../ext/Class":2}],65:[function(e,module,t){},{}],66:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({initialize:function(e,t,r){this.columnId=e;this.sortDir=t==null?1:t;this.sortType=r||"data"},getColumnId:function(){return this.columnId},getSortType:function(){return this.sortType},setSortType:function(e){this.sortType=e},getSortDir:function(){return this.sortDir},setSortDir:function(e){this.sortDir=e}});module.exports=a},{"../../ext/Class":2}],67:[function(e,module,t){var r=e("../../ext/Class");var a=e("../../util/ArrayUtils");var n=e("./TableMod");var i=e("../ElementUtils");var s=e("../Path");var o=e("../../sparql/Concept");var l=r.create({initialize:function(e,t,r){this.facetConfig=e;this.tableMod=t||new n;this.paths=r||[]},getFacetConfig:function(){return this.facetConfig},getTableMod:function(){return this.tableMod},getPaths:function(){return this.paths},getPath:function(e){var t=this.tableMod.getColumnIds().indexOf(e);var r=this.paths[t];return r},getColumnId:function(e){var t=this.paths.firstIndexOf(e);var r=this.tableMod.getColumnIds()[t];return r},removeColumn:function(e){var t=this.getPath(e);this.paths.remove(t)},getColIdForPath:function(e){var t=this.facetConfig.getRootFacetNode();var r=t.forPath(e);var a=r.getVar().getName();return a},togglePath:function(e){var t=a.toggleItem(this.paths,e);var r=this.getColIdForPath(e);if(t){this.tableMod.addColumn(r)}else{this.tableMod.removeColumn(r)}},createDataConcept:function(){var e=new s;var t=this.paths.slice(0);if(!this.paths.contains(e)){t.push(e)}var r=i.createElementTable(this.facetConfig,t);var a=this.facetConfig.getRootFacetNode();var n=a.getVar();var l=new o(r,n);return l}})},{"../../ext/Class":2,"../../sparql/Concept":202,"../../util/ArrayUtils":326,"../ElementUtils":8,"../Path":22,"./TableMod":68}],68:[function(e,module,t){var r=e("../../ext/Class");var a=e("../../util/ArrayUtils");var n=e("./ColumnView");var i=e("../../util/collection/HashMap");var s=r.create({initialize:function(){this.columnIds=[];this.colIdToColView=new i;this.sortConditions=[];this.colIdToAgg=new i;this.limit=null;this.offset=null;this._isDistinct=true},getLimit:function(){return this.limit},setLimit:function(e){this.limit=e},getOffset:function(){return this.offset},setOffset:function(e){this.offset=e},isDistinct:function(){return this._isDistinct},setDistinct:function(e){this._isDistinct=e},getColumnIds:function(){return this.columnIds},getColumn:function(e){return this.colIdToColView[e]},getColumns:function(){var e=this;var t=this.columnIds.map(function(t){var r=e.colIdToColView[t];return r});return t},getSortConditions:function(){return this.sortConditions},getLimitAndOffset:function(){return this.limitAndOffset},getAggregator:function(e){var t=this.colIdToAgg[e];return t},getAggregators:function(){return this.colIdToAgg},addColumn:function(e,t){var r=this.colIdToColView[e];if(r){throw new Error("Column "+e+" already part of the table")}r=new n(this,e);this.colIdToColView[e]=r;if(!t){this.columnIds.push(e)}return r},removeColumn:function(e){delete this.colIdToColView[e];var t=this;a.filter(this.columnIds,function(t){var r=e!=t;return r});a.filter(this.sortConditions,function(t){var r=e!=t.getColumnId()});delete this.colIdToAgg[e]}});module.exports=s},{"../../ext/Class":2,"../../util/ArrayUtils":326,"../../util/collection/HashMap":342,"./ColumnView":63}],69:[function(e,module,t){var r={createNgGridColumnDefs:function(e){var t=e.getColumns();
var r=t.forEach(function(e){var t={field:e.getId(),displayName:e.getId()};return t});return r}};module.exports=r},{}],70:[function(e,module,t){var r=e("../ext/Class");var a=r.create({createExpr:function(e){throw new Error("Not implemented")}});module.exports=a},{"../ext/Class":2}],71:[function(e,module,t){var r=e("../ext/Class");var a=e("./BboxExprFactory");var n=e("./GeoExprUtils");var i=r.create(a,{initialize:function(e,t,r){this.xVar=e;this.yVar=t;this.castNode=r},createExpr:function(e){var t=n.createExprWgs84Intersects(this.xVar,this.yVar,e,this.castNode);return t}});module.exports=i},{"../ext/Class":2,"./BboxExprFactory":70,"./GeoExprUtils":77}],72:[function(e,module,t){var r=e("../ext/Class");var a=e("./BboxExprFactory");var n=e("./GeoExprUtils");var i=r.create(a,{initialize:function(e,t,r){this.wktVar=e;this.intersectsFnName=t;this.geomFromTextFnName=r},createExpr:function(e){var t=n.createExprOgcIntersects(this.wktVar,e,this.intersectsFnName,this.geomFromTextFnName);return t}});module.exports=i},{"../ext/Class":2,"./BboxExprFactory":70,"./GeoExprUtils":77}],73:[function(e,module,t){var r=e("../ext/Class");var a=e("./Point");var n=e("./Range");var i=r.create({initialize:function(e,t,r,a){this.left=e;this.right=r;this.bottom=t;this.top=a},containsPoint:function(e){return e.x>=this.left&&e.x<this.right&&e.y>=this.bottom&&e.y<this.top},getCenter:function(){return new a(.5*(this.left+this.right),.5*(this.bottom+this.top))},getWidth:function(){return this.right-this.left},getHeight:function(){return this.top-this.bottom},contains:function(e){return e.left>=this.left&&e.right<this.right&&e.bottom>=this.bottom&&e.top<this.top},rangeX:function(){return new n(this.left,this.right)},rangeY:function(){return new n(this.bottom,this.top)},overlap:function(e){if(!e.rangeX||!e.rangeY){console.error("Missing range");throw"Error"}var t=this.rangeX().getOverlap(e.rangeX());if(!t){return null}var r=this.rangeY().getOverlap(e.rangeY());if(!r){return null}return new i(t.min,r.min,r.max,t.max)},isOverlap:function(e){var t=this.overlap(e);return t!=null},toString:function(){return"["+this.left+" - "+this.right+", "+this.bottom+" - "+this.top+"]"}});i.createFromJson=function(e){var t=new i(e.left,e.bottom,e.right,e.top);return t};module.exports=i},{"../ext/Class":2,"./Point":83,"./Range":86}],74:[function(e,module,t){var r=e("../ext/Class");var a=e("lodash.flatten");var n=e("lodash.uniq");var i=e("../service/data_service/DataService");var s=e("../vocab/wgs84");var o=e("../rdf/NodeFactory");var l=e("../util/shared");var c=l.Promise;var u=e("./Bounds");var d=e("./QuadTree");var p=e("./GeoExprUtils");var h=function(){return false};var v=r.create(i,{initialize:function(e,t,r,a){this.listServiceBbox=e;var n=new u(-180,-90,180,90);this.quadTree=new d(n,18,0);this.maxItemsPerTileCount=r||25;this.maxGlobalItemCount=t||50;this.aquireDepth=a||2},fetchData:function(e){var t=this.runWorkflow(e).then(function(e){var t=e.map(function(e){return e.data.docs});var r=t.filter(function(e){return e});r=a(r,true);e.forEach(function(e){if(e.isLoaded){return}var t=p.boundsToWkt(e.getBounds());var a={id:t,zoomClusterBounds:e.getBounds(),wkt:o.createPlainLiteral(t)};r.push(a)});return r});return t},runCheckGlobal:c.method(function(){var e;var t=this.quadTree.getRootNode();if(!t.checkedGlobal){var r=this.listServiceBbox.fetchCount(null,this.maxGlobalItemCount);console.log("dammit",this.listServiceBbox);e=r.then(function(e){var r=!e.hasMoreItems;console.log("Global check counts",e);t.canUseGlobal=r;t.checkedGlobal=true;return r})}else{e=t.canUseGlobal}return e}),runWorkflow:c.method(function(e){var t=this.quadTree.getRootNode();var r=this;return this.runCheckGlobal().then(function(a){console.log("Can use global? ",a);var n;if(a){n=r.runGlobalWorkflow(t)}else{n=r.runTiledWorkflow(e)}return n.then(function(e){return e})})}),runGlobalWorkflow:function(e){var t=this;var r=this.listServiceBbox.fetchItems(null).then(function(r){t.loadTaskAction(e,r);return[e]});return r},runTiledWorkflow:c.method(function(e){var t=this;var r=this.quadTree.aquireNodes(e,this.aquireDepth);r.forEach(function(e){if(!e.data){e.data={}}});r.forEach(function(e){if(e.isCountComplete()&&e.infMinItemCount===0){e.isLoaded=true}});var a=r.filter(function(e){return t.isCountingNeeded(e)});var n=this.createCountTasks(a);return c.all(n).then(function(){var e=r.filter(function(e){return t.isLoadingNeeded(e)});var a=t.createLoadTasks(e);return c.all(a).then(function(){return r})})}),createCountTask:function(e){var t=this;var r=t.maxItemsPerTileCount;var a=this.listServiceBbox.fetchCount(e.getBounds(),r);var n=a.then(function(t){var r=t.count;e.setMinItemCount(t.count);if(r===0){e.isLoaded=true}});return n},isCountingNeeded:function(e){return!(this.isTooManyGeoms(e)||e.isCountComplete())},isLoadingNeeded:function(e){var t=e.isLoaded||e.isCountComplete()&&e.infMinItemCount===0||this.isTooManyGeoms(e);return!t},isTooManyGeoms:function(e){return e.infMinItemCount>=this.maxItemsPerTileCount},createCountTasks:function(e){var t=this;var r=e.map(function(e){return t.createCountTask(e)}).filter(function(e){return e});return r},loadTaskAction:function(e,t){e.data.docs=t;e.isLoaded=true},createLoadTasks:function(e){var t=this;var r=e.map(function(e){var r=t.listServiceBbox.fetchItems(e.getBounds()).then(function(r){t.loadTaskAction(e,r)});return r});return r},finalizeLoading:function(e){var t=[];e.forEach(function(e){if(e.parent){t.push(e.parent)}});t=n(t);var r=function(t){var r=e.indexOf(t);if(r>=0){e[r]=undefined}};var a=false;do{a=false;for(var i in t){var s=t[i];var o=s.children;var l=h(s);if(!l){continue}a=true;o.forEach(r);e.push(s);if(s.parent){t.push(s.parent)}break}}while(a===true);e=e.filter(function(e){return e})}});module.exports=v},{"../ext/Class":2,"../rdf/NodeFactory":92,"../service/data_service/DataService":135,"../util/shared":350,"../vocab/wgs84":355,"./Bounds":73,"./GeoExprUtils":77,"./QuadTree":84,"lodash.flatten":363,"lodash.uniq":582}],75:[function(e,module,t){var r=e("../sparql/Concept");var a=e("../sparql/element/ElementString");var n=e("../sparql/VarUtils");var i={conceptWgs84:new r(a.create("?s <http://www.w3.org/2003/01/geo/wgs84_pos#long> ?x ;  <http://www.w3.org/2003/01/geo/wgs84_pos#lat> ?y"),n.s),conceptGeoVocab:new r(a.create("?s <http://www.opengis.net/ont/geosparql#asWKT> ?w"),n.s)};module.exports=i},{"../sparql/Concept":202,"../sparql/VarUtils":226,"../sparql/element/ElementString":234}],76:[function(e,module,t){var r=e("../service/LookupServiceUtils");var a=e("../service/lookup_service/LookupServiceConst");var n=e("../service/lookup_service/LookupServiceTransform");var i=e("../service/list_service/ListServiceAugmenter");var s=e("../service/list_service/AugmenterLookup");var o=e("../sparql/BestLabelConfig");var l=e("./ListServiceBbox");var c=e("./DataServiceBboxCache");var r=e("../sponate/LookupServiceUtils");var u=e("../sponate/MappedConceptUtils");var d={createGeoDataSourceLabels:function(e,t,d,p){if(p==null){p={}}var h=new l(e,t,d);var v=new o;var f=u.createMappedConceptBestLabel(v);var g=r.createLookupServiceMappedConcept(e,f);g=new n(g,function(e,t){var r={shortLabel:e};return r});var m=new s(g);h=new i(h,m);var x=new a(p);var _=new s(x);h=new i(h,_);var b=new c(h,1500,500,2);return b}};module.exports=d},{"../service/LookupServiceUtils":120,"../service/list_service/AugmenterLookup":137,"../service/list_service/ListServiceAugmenter":140,"../service/lookup_service/LookupServiceConst":154,"../service/lookup_service/LookupServiceTransform":163,"../sparql/BestLabelConfig":198,"../sponate/LookupServiceUtils":286,"../sponate/MappedConceptUtils":289,"./DataServiceBboxCache":74,"./ListServiceBbox":82}],77:[function(e,module,t){var r=e("../sparql/NodeValueUtils");var a=e("../sparql/expr/ExprVar");var n=e("../sparql/expr/E_Cast");var i=e("../sparql/expr/NodeValue");var s=e("../sparql/expr/E_LogicalAnd");var o=e("../sparql/expr/E_Function");var l=e("../sparql/expr/E_GreaterThan");var c=e("../sparql/expr/E_LessThan");var u={createExprWgs84Intersects:function(e,t,i,o){var u=new a(e);var d=new a(t);if(o){u=new n(u,o);d=new n(d,o)}var p=r.makeDecimal(i.left);var h=r.makeDecimal(i.right);var v=r.makeDecimal(i.bottom);var f=r.makeDecimal(i.top);var g=new s(new s(new l(u,p),new c(u,h)),new s(new l(d,v),new c(d,f)));return g},createExprOgcIntersects:function(e,t,n,i){var s="http://www.opengis.net/rdf#";n=n||s+"intersects";i=i||s+"geomFromText";var l=new a(e);var c=this.boundsToWkt(t);var u=r.makeString(c);var d=new o(n,[l,new o(i,[u])]);return d},boundsToWkt:function(e){var t=e.left;var r=e.bottom;var a=e.right;var n=e.top;var i="POLYGON(("+t+" "+r+","+a+" "+r+","+a+" "+n+","+t+" "+n+","+t+" "+r+"))";return i}};module.exports=u},{"../sparql/NodeValueUtils":215,"../sparql/expr/E_Cast":244,"../sparql/expr/E_Function":246,"../sparql/expr/E_GreaterThan":247,"../sparql/expr/E_LessThan":250,"../sparql/expr/E_LogicalAnd":252,"../sparql/expr/ExprVar":268,"../sparql/expr/NodeValue":269}],78:[function(e,module,t){var r=e("../ext/Class");var a=e("../sparql/Concept");var n=e("../sparql/element/ElementGroup");var i=e("../sparql/element/ElementFilter");var s=e("../sponate/MappedConcept");var o=r.create({classLabel:"GeoMapFactory",initialize:function(e,t){this.mappedConcept=e;this.bboxExprFactory=t},createMap:function(e){var t=this.createMapForBounds(e);return t},createMapForGlobal:function(){var e=this.createMapForBounds(null);return e},createMapForBounds:function(e){var t=this.mappedConcept;var r=this.bboxExprFactory;var o=t.getConcept();var l=t.getAgg();var c=o.getElement();var u=c;if(e){var d=r.createExpr(e);var p=new i(d);u=new n([c,p])}var h=new a(u,o.getVar());var v=new s(h,l);return v}});module.exports=o},{"../ext/Class":2,"../sparql/Concept":202,"../sparql/element/ElementFilter":231,"../sparql/element/ElementGroup":232,"../sponate/MappedConcept":287}],79:[function(e,module,t){var r=e("./BboxExprFactoryWkt");var a=e("./BboxExprFactoryWgs84");var n=e("./GeoMapUtils");var i=e("./GeoMapFactory");var s=e("../sparql/VarUtils");var o=e("../sparql/Concept");var l=e("../sparql/element/ElementTriplesBlock");var c=e("../rdf/NodeFactory");var u=e("../rdf/Triple");var d=e("../vocab/rdf");var p=e("../sponate/SponateUtils");var h="bif:st_intersects";var v="bif:st_geomFromText";var f={wgs84MapFactory:new i(n.wgs84GeoView,new a(s.x,s.y)),ogcVirtMapFactory:new i(n.ogcGeoView,new r(s.w,h,v)),createWktMapFactory:function(e,t,a){e=e||"http://www.opengis.net/ont/geosparql#asWKT";t=t||"bif:st_intersects";a=a||"bif:st_geomFromText";var n=c.createUri(e);var d=new o(new l([new u(s.s,n,s.w)]),s.s);var h=p.parseSpec({name:"geoMap-"+e,template:[{id:""+d.getVar(),wkt:s.w}],from:d.getElement()});var v=new i(h,new r(s.w,t,a));return v}};module.exports=f},{"../rdf/NodeFactory":92,"../rdf/Triple":95,"../sparql/Concept":202,"../sparql/VarUtils":226,"../sparql/element/ElementTriplesBlock":236,"../sponate/SponateUtils":294,"../vocab/rdf":353,"./BboxExprFactoryWgs84":71,"./BboxExprFactoryWkt":72,"./GeoMapFactory":78,"./GeoMapUtils":80}],80:[function(e,module,t){var r=e("../sparql/VarUtils");var a=e("../rdf/NodeFactory");var n=e("../sparql/Concept");var i=e("./GeoConceptUtils");var s=e("../sponate/SponateUtils");var o={wgs84GeoView:s.parseSpec({name:"lonlat",template:[{id:""+i.conceptWgs84.getVar(),lon:r.x,lat:r.y,wkt:[r.x,r.y,function(e,t){var r=a.createTypedLiteralFromString("POINT("+e+" "+t+")","http://www.opengis.net/ont/geosparql#wktLiteral");return r}]}],from:i.conceptWgs84.getElement()}),ogcGeoView:s.parseSpec({name:"lonlat",template:[{id:""+i.conceptGeoVocab.getVar(),wkt:r.w}],from:i.conceptGeoVocab.getElement()})};module.exports=o},{"../rdf/NodeFactory":92,"../sparql/Concept":202,"../sparql/VarUtils":226,"../sponate/SponateUtils":294,"./GeoConceptUtils":75}],81:[function(e,module,t){var r=e("../rdf/node/Node");var a=e("../sparql/expr/ExprVar");var n=e("../sparql/expr/NodeValue");var i=e("../sparql/expr/E_LogicalAnd");var s=e("../sparql/expr/E_LogicalOr");var o=e("../sparql/expr/E_Function");var l=e("../sparql/expr/E_Cast");var c=e("../sparql/expr/E_GreaterThan");var u=e("../sparql/expr/E_LessThan");var d={boundsToWkt:function(e){var t=e.left;var r=e.bottom;var a=e.right;var n=e.top;var i="POLYGON(("+t+" "+r+","+a+" "+r+","+a+" "+n+","+t+" "+n+","+t+" "+r+"))";return i},createFilterOgcIntersects:function(e,t){var r="http://www.opengis.net/rdf#";var n=new a(e);var i=this.boundsToWkt(t);var s=new o(r+"intersects",n,new o(r+"geomFromText",i));return s},createWgsFilter:function(e,t,s,o){var d=new a(e);var p=new a(t);if(o){d=new l(d,o);p=new l(p,o)}var h=n.makeNode(r.forValue(s.left));var v=n.makeNode(r.forValue(s.right));var f=n.makeNode(r.forValue(s.bottom));var g=n.makeNode(r.forValue(s.top));var m=new i(new i(new c(d,h),new u(d,v)),new i(new c(p,f),new u(p,g)));return m}};module.exports=d},{"../rdf/node/Node":104,"../sparql/expr/E_Cast":244,"../sparql/expr/E_Function":246,"../sparql/expr/E_GreaterThan":247,"../sparql/expr/E_LessThan":250,"../sparql/expr/E_LogicalAnd":252,"../sparql/expr/E_LogicalOr":254,"../sparql/expr/ExprVar":268,"../sparql/expr/NodeValue":269}],82:[function(e,module,t){var r=e("../ext/Class");var a=e("../service/list_service/ListService");var n=e("../sponate/facade/StoreFacade");var i=r.create(a,{initialize:function(e,t,r){this.sparqlService=e;this.geoMapFactory=t;this.concept=r},createListService:function(e){var t=new n(this.sparqlService);var r=this.geoMapFactory.createMap(e);var a={name:"geoMap",template:r};t.addMap(a);var i=t.geoMap.getListService();return i},fetchItems:function(e,t,r){var a=this.createListService(e);var n=a.fetchItems(this.concept,t,r);return n},fetchCount:function(e,t,r){var a=this.createListService(e);var n=a.fetchCount(this.concept,t,r);return n}});module.exports=i},{"../ext/Class":2,"../service/list_service/ListService":138,"../sponate/facade/StoreFacade":324}],83:[function(e,module,t){var r=e("../ext/Class");var a=r.create({initialize:function(e,t){this.x=e;this.y=t},getX:function(){return this.x},getY:function(){return this.y}});module.exports=a},{"../ext/Class":2}],84:[function(e,module,t){var r=e("../ext/Class");var a=e("./QuadTreeNode");var n=r.create({initialize:function(e,t,r){if(r==null){r=.25}this.node=new a(null,e,t,0,r);this.idToNodes=[]},getRootNode:function(){return this.node},aquireNodes:function(e,t){return this.node.aquireNodes(e,t)},query:function(e,t){return this.node.query(e,t)},insert:function(e){}});module.exports=n},{"../ext/Class":2,"./QuadTreeNode":85}],85:[function(e,module,t){var r=e("../ext/Class");var a=e("./Point");var n=e("./Bounds");var i=e("lodash.reduce");var s=r.create({initialize:function(e,t,r,a,n,i){this.parent=e;this.parentChildIndex=i;this._bounds=t;this._maxDepth=r;this._depth=a;this._k=n;this.isLoaded=false;this.children=null;this.data={};this._minItemCount=null;this.infMinItemCount=null;this.idToPos={};this._classConstructor=s},getId:function(){var e=this.parent;var t=e?e.getId():"";var r=this.parentChildIndex!=null?this.parentChildIndex:"r";var a=t+r;return a},isLeaf:function(){return this.children==null},addItem:function(e,t){this.idToPos[e]=t},addItems:function(e){for(var t in e){var r=e[t];this.addItem(t,r)}},removeItem:function(e){delete this.idToPos[e]},setMinItemCount:function(e){this._minItemCount=e;this.infMinItemCount=e;if(this.parent){this.parent.updateInfMinItemCount()}},getMinItemCount:function(){return this._minItemCount},isCountComplete:function(){if(this.getMinItemCount()!=null){return true}if(this.children){var e=i(this.children,function(e,t){return e&&t.isCountComplete()},true);return e}return false},updateInfMinItemCount:function(){if(!this.children&&this._minItemCount!=null){return}var e=0;this.children.forEach(function(t,r){if(t._minItemCount!=null){e+=t._minItemCount}else if(t.infMinItemCount){e+=t.infMinItemCount}});this.infMinItemCount=e;if(this.parent){this.parent.updateInfMinItemCount()}},getBounds:function(){return this._bounds},getCenter:function(){return this._bounds.getCenter()},subdivide:function(){var e=this._depth+1;var t=this.getCenter();var r=this._k*.5*this._bounds.getWidth();var a=this._k*.5*this._bounds.getHeight();this.children=[];this.children[s.TOP_LEFT]=new this._classConstructor(this,new n(this._bounds.left,t.y-a,t.x+r,this._bounds.top),this._maxDepth,e,this._k,s.TOP_LEFT);this.children[s.TOP_RIGHT]=new this._classConstructor(this,new n(t.x-r,t.y-a,this._bounds.right,this._bounds.top),this._maxDepth,e,this._k,s.TOP_RIGHT);this.children[s.BOTTOM_LEFT]=new this._classConstructor(this,new n(this._bounds.left,this._bounds.bottom,t.x+r,t.y+a),this._maxDepth,e,this._k,s.BOTTOM_LEFT);this.children[s.BOTTOM_RIGHT]=new this._classConstructor(this,new n(t.x-r,this._bounds.bottom,this._bounds.right,t.y+a),this._maxDepth,e,this._k,s.BOTTOM_RIGHT)},getOverlaps:function(e){},query:function(e,t){var r=[];this.queryRec(e,r,t);return r},queryRec:function(e,t,r){if(!this._bounds.isOverlap(e)){return}var a=e.getWidth()/this._bounds.getWidth();var n=e.getHeight()/this._bounds.getHeight();var i=Math.max(a,n);if(this.isLoaded||!this.children||i>=r){t.push(this);return}for(var s in this.children){var o=this.children[s];o.queryRec(e,r,t)}},splitFor:function(e,t,r){if(!this._bounds.isOverlap(e)){return}if(this.isLoaded){if(r){r.push(this)}return}var a=e.getWidth()/this._bounds.getWidth();var n=e.getHeight()/this._bounds.getHeight();var i=Math.max(a,n);if(i>=t||this._depth>=this._maxDepth){if(r){r.push(this)}return}if(!this.children){this.subdivide()}for(var s=0;s<this.children.length;++s){var o=this.children[s];o.splitFor(e,t,r)}},aquireNodes:function(e,t){var r=[];this.splitFor(e,t,r);return r},unlink:function(){if(!this.parent){return}for(var e in this.parent.children){var t=this.parent.children[e];if(t==this){this.parent.children=new s(this.parent,this._bounds,this._depth,this._k)}}}});s.TOP_LEFT=0;s.TOP_RIGHT=1;s.BOTTOM_LEFT=2;s.BOTTOM_RIGHT=3;module.exports=s},{"../ext/Class":2,"./Bounds":73,"./Point":83,"lodash.reduce":495}],86:[function(e,module,t){var r=e("../ext/Class");var a=r.create({initialize:function(e,t){this.min=e;this.max=t},getOverlap:function(e){var t=Math.max(this.min,e.min);var r=Math.min(this.max,e.max);return t>r?null:new a(t,r)}});module.exports=a},{"../ext/Class":2}],87:[function(e,module,t){"use strict";var r={BboxExprFactory:e("./BboxExprFactory"),BboxExprFactoryWgs84:e("./BboxExprFactoryWgs84"),BboxExprFactoryWkt:e("./BboxExprFactoryWkt"),Bounds:e("./Bounds"),DataServiceBboxCache:e("./DataServiceBboxCache"),GeoConceptUtils:e("./GeoConceptUtils"),GeoDataSourceUtils:e("./GeoDataSourceUtils"),GeoExprUtils:e("./GeoExprUtils"),GeoMapFactory:e("./GeoMapFactory"),GeoMapFactoryUtils:e("./GeoMapFactoryUtils"),GeoMapUtils:e("./GeoMapUtils"),GeoUtils:e("./GeoUtils"),ListServiceBbox:e("./ListServiceBbox"),Point:e("./Point"),QuadTree:e("./QuadTree"),QuadTreeNode:e("./QuadTreeNode"),Range:e("./Range")};Object.freeze(r);module.exports=r},{"./BboxExprFactory":70,"./BboxExprFactoryWgs84":71,"./BboxExprFactoryWkt":72,"./Bounds":73,"./DataServiceBboxCache":74,"./GeoConceptUtils":75,"./GeoDataSourceUtils":76,"./GeoExprUtils":77,"./GeoMapFactory":78,"./GeoMapFactoryUtils":79,"./GeoMapUtils":80,"./GeoUtils":81,"./ListServiceBbox":82,"./Point":83,"./QuadTree":84,"./QuadTreeNode":85,"./Range":86}],88:[function(e,module,t){var r=e("./util/shared");var Jassa=function(t,a){r.Promise=t;r.ajax=a;return{ext:e("./ext"),util:e("./util"),rdf:e("./rdf"),vocab:e("./vocab"),sparql:e("./sparql"),service:e("./service"),sponate:e("./sponate"),facete:e("./facete"),geo:e("./geo")}};module.exports=Jassa},{"./ext":4,"./facete":56,"./geo":87,"./rdf":103,"./service":136,"./sparql":271,"./sponate":325,"./util":349,"./util/shared":350,"./vocab":351}],89:[function(e,module,t){var r=e("../ext/Class");var a=r.create({classLabel:"AnonId",getLabelString:function(){throw new Error("not implemented")}});module.exports=a},{"../ext/Class":2}],90:[function(e,module,t){var r=e("../ext/Class");var a=e("./AnonId");var n=r.create(a,{classLabel:"AnonIdStr",initialize:function(e){this.label=e},getLabelString:function(){return this.label},toString:function(){return this.label}});module.exports=n},{"../ext/Class":2,"./AnonId":89}],91:[function(e,module,t){var r=e("../ext/Class");var a=e("./node/Node_Concrete");var n=function(e){var t=e.replace(/\n/g,"\\n").replace(/"/g,'\\"');return t};var i=r.create(a,{classLabel:"jassa.rdf.LiteralLabel",initialize:function(e,t,r,a){this.val=e;this.lex=t;this.lang=r;this.dtype=a},getValue:function(){return this.val},getLexicalForm:function(){return this.lex instanceof String?this.lex:this.lex.toString()},getLanguage:function(){return this.lang},getDatatype:function(){return this.dtype},toString:function(){var e=this.dtype?this.dtype.getUri():null;var t=n(this.lex);var r;if(e){r='"'+t+'"^^<'+e+">"}else{r='"'+t+'"'+(this.lang?"@"+this.lang:"")}return r}});module.exports=i},{"../ext/Class":2,"./node/Node_Concrete":106}],92:[function(e,module,t){var r=e("./AnonIdStr");var a=e("./node/Var");var n=e("./node/Node");var i=e("./node/Node_Uri");var s=e("./node/Node_Blank");var o=e("./node/Node_Literal");var l=e("./LiteralLabel");var c=e("./TypeMapper");var u=e("./rdf_datatype/DefaultRdfDatatypes");var d=/"([^"\\]*(\\.[^"\\]*)*)"/;var p=function(e){var t;if(e.charAt(0)==="<"){t=e.slice(1,-1)}else{throw new Error("[ERROR] Cannot deal with "+e)}return t};var h={createAnon:function(e){return new s(e)},createUri:function(e){return new i(e)},createVar:function(e){return new a(e)},createPlainLiteral:function(e,t){if(t==null){t=""}var r=new l(e,e,t);return new o(r)},createTypedLiteralFromValue:function(e,t){var r=u[t];if(!r){var a=c.getInstance();r=a.getSafeTypeByName(t)}var n=r.unparse(e);var i=null;var s=new l(e,n,i,r);return new o(s)},createTypedLiteralFromString:function(e,t){var r=u[t];if(!r){var a=c.getInstance();r=a.getSafeTypeByName(t)}var n=r.parse(e);var i=e;var s="";var d=new l(n,i,s,r);return new o(d)},createFromTalisRdfJson:function(e){if(!e||typeof e.type==="undefined"){throw new Error("Invalid node: "+JSON.stringify(e))}var t;switch(e.type){case"bnode":var a=new r(e.value);t=new h.createAnon(a);break;case"uri":t=h.createUri(e.value);break;case"literal":var n=e.lang||e["xml:lang"];t=h.createPlainLiteral(e.value,n);break;case"typed-literal":t=h.createTypedLiteralFromString(e.value,e.datatype);break;default:console.log("Unknown type: '"+e.type+"'");throw new Error("Bailing out")}return t},parseRdfTerm:function(e){if(!e){throw new Error("[ERROR] Null Pointer Exception")}e=e.trim();if(e.length===0){throw new Error("[ERROR] Empty string")}var t=e.charAt(0);var a;switch(t){case"<":var n=e.slice(1,-1);a=h.createUri(n);break;case"_":var i=new r(e);a=h.createAnon(i);break;case'"':var s=d.exec(e);var o=s[0];var l=o.slice(1,-1);var c=o.length;var u=e.charAt(c);if(!u){a=h.createTypedLiteralFromString(l,"http://www.w3.org/2001/XMLSchema#string")}switch(u){case"":case"@":var v=e.substr(c+1);a=h.createPlainLiteral(l,v);break;case"^":var f=e.substr(c+2);var g=p(f);a=h.createTypedLiteralFromString(l,g);break;default:throw new Error("[ERROR] Excepted @ or ^^")}break;default:throw new Error("Could not parse "+e)}return a}};module.exports=h},{"./AnonIdStr":90,"./LiteralLabel":91,"./TypeMapper":97,"./node/Node":104,"./node/Node_Blank":105,"./node/Node_Literal":108,"./node/Node_Uri":109,"./node/Var":111,"./rdf_datatype/DefaultRdfDatatypes":113}],93:[function(e,module,t){var r={getSubstitute:function(e,t){var r=t(e);if(!r){r=e}return r},pushVar:function(e,t){if(t.isVariable()){var r=false;e.forEach(function(e){r=r||t.equals(e)});if(!r){e.push(t)}}return e},getLang:function(e){var t=e&&e.isLiteral()?e.getLiteralLanguage():null;return t},getUri:function(e){var t=e&&e.isUri()?e.getUri():null;return t},getValue:function(e){var t;if(e==null){t=null}else if(e.isUri()){t=e.getUri()}else if(e.isBlank()){t=e.toString()}else if(e.isLiteral()){t=e.getLiteralValue()}else{throw new Error("Unknow node type: ",e)}return t}};module.exports=r},{}],94:[function(e,module,t){var r=e("../ext/Class");var a=function(e,t){if(t===""){return true}if(e==null||t==null){return false}e=String(e);t=String(t);return e.length>=t.length&&e.slice(0,t.length)===t};var n=function(e){return typeof e==="function"};var i=function(e,t){var r;for(r in t){if(hasOwnProperty.call(t,r)){e[r]=t[r]}}return e};var s=r.create({initialize:function(e){this.prefixes=e?e:{}},expandPrefix:function(){throw new Error("Not implemented yet - sorry")},getNsPrefixMap:function(){return this.prefixes},getNsPrefixURI:function(e){return this.prefixes[e]},getNsURIPrefix:function(e){var t=null;var r=null;for(var n in this.prefixes){if(this.prefixes.hasOwnProperty(n)){var i=this.prefixes[n];if(a(e,i)){if(!r||i.length>r.length){t=n;r=i}}}}return t},qnameFor:function(){},removeNsPrefix:function(e){delete this.prefixes[e]},samePrefixMappingAs:function(){throw new Error("Not implemented yet - Sorry")},setNsPrefix:function(e,t){this.prefixes[e]=t;return this},setNsPrefixes:function(e){var t=n(e.getNsPrefixMap)?e.getNsPrefixMap():e;for(var r in t){if(t.hasOwnProperty(r)){var a=t[r];this.setNsPrefix(r,a)}}return this},shortForm:function(e){var t=this.getNsURIPrefix(e);var r;if(t){var a=this.prefixes[t];var n=e.substring(a.length);r=t+":"+n}else{r=e}return r},addPrefix:function(e,t){this.prefixes[e]=t},getPrefix:function(e){var t=this.prefixes[e];return t},addJson:function(e){i(this.prefixes,e)},getJson:function(){return this.prefixes}});module.exports=s},{"../ext/Class":2}],95:[function(e,module,t){var r=e("../ext/Class");var a=e("./NodeUtils");var n=r.create({classLabel:"jassa.rdf.Triple",initialize:function(e,t,r){this.subject=e;this.predicate=t;this.object=r},toString:function(){return this.subject+" "+this.predicate+" "+this.object},copySubstitute:function(e){var t=new n(a.getSubstitute(this.subject,e),a.getSubstitute(this.predicate,e),a.getSubstitute(this.object,e));return t},getSubject:function(){return this.subject},getPredicate:function(){return this.predicate},getObject:function(){return this.object},getVarsMentioned:function(){var e=[];a.pushVar(e,this.subject);a.pushVar(e,this.predicate);a.pushVar(e,this.object);return e}});module.exports=n},{"../ext/Class":2,"./NodeUtils":93}],96:[function(e,module,t){var r=e("lodash.uniq");var a={uniqTriples:function(e){var t=r(e,false,function(e){return e.toString()});return t}};module.exports=a},{"lodash.uniq":582}],97:[function(e,module,t){var r=e("../ext/Class");var a=e("./rdf_datatype/DefaultRdfDatatypes");var n=e("./rdf_datatype/BaseDatatype");var i={enableSilentAcceptanceOfUnknownDatatypes:true};var s=null;var o=r.create({classLabel:"jassa.rdf.TypeMapper",initialize:function(e){this.uriToDt=e},getSafeTypeByName:function(e){var t=this.uriToDt;var r=t[e];if(r==null){if(e==null){return null}else{if(i.enableSilentAcceptanceOfUnknownDatatypes){r=new n(e);this.registerDatatype(r)}else{console.log("Attempted to created typed literal using an unknown datatype - "+e);throw new Error("Bailing out")}}}return r},registerDatatype:function(e){var t=e.getUri();this.uriToDt[t]=e}});o.staticInstance=null;o.getInstance=function(){if(o.staticInstance==null){o.staticInstance=new o(a)}return o.staticInstance};module.exports=o},{"../ext/Class":2,"./rdf_datatype/BaseDatatype":112,"./rdf_datatype/DefaultRdfDatatypes":113}],98:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({classLabel:"DatatypeLabel",parse:function(){throw new Error("Not implemented")},unparse:function(){throw new Error("Not implemented")}});module.exports=a},{"../../ext/Class":2}],99:[function(e,module,t){var r=e("../../ext/Class");var a=e("./DatatypeLabel");var n=r.create(a,{classLabel:"jassa.rdf.DatatypeLabelFloat",parse:function(e){return parseFloat(e)},unparse:function(e){return e.toString()}});module.exports=n},{"../../ext/Class":2,"./DatatypeLabel":98}],100:[function(e,module,t){var r=e("../../ext/Class");var a=e("./DatatypeLabel");var n=r.create(a,{classLabel:"jassa.rdf.DatatypeLabelInteger",parse:function(e){return parseInt(e,10)},unparse:function(e){return e.toString()}});module.exports=n},{"../../ext/Class":2,"./DatatypeLabel":98}],101:[function(e,module,t){var r=e("../../ext/Class");var a=e("./DatatypeLabel");var n=r.create(a,{classLabel:"jassa.rdf.DatatypeLabelString",parse:function(e){return e},unparse:function(e){return e.toString()}});module.exports=n},{"../../ext/Class":2,"./DatatypeLabel":98}],102:[function(e,module,t){var r=e("./DatatypeLabelInteger");var a=e("./DatatypeLabelFloat");var n=e("./DatatypeLabelString");var i={xinteger:new r,xfloat:new a,xdouble:new a,xstring:new n,decimal:new a};module.exports=i},{"./DatatypeLabelFloat":99,"./DatatypeLabelInteger":100,"./DatatypeLabelString":101}],103:[function(e,module,t){"use strict";var r={AnonId:e("./AnonId"),AnonIdStr:e("./AnonIdStr"),LiteralLabel:e("./LiteralLabel"),NodeFactory:e("./NodeFactory"),NodeUtils:e("./NodeUtils"),PrefixMappingImpl:e("./PrefixMappingImpl"),Triple:e("./Triple"),TripleUtils:e("./TripleUtils"),TypeMapper:e("./TypeMapper"),DatatypeLabel:e("./datatype/DatatypeLabel"),DatatypeLabelFloat:e("./datatype/DatatypeLabelFloat"),DatatypeLabelInteger:e("./datatype/DatatypeLabelInteger"),DatatypeLabelString:e("./datatype/DatatypeLabelString"),DefaultDatatypeLabels:e("./datatype/DefaultDatatypeLabels"),Node:e("./node/Node"),Node_Blank:e("./node/Node_Blank"),Node_Concrete:e("./node/Node_Concrete"),Node_Fluid:e("./node/Node_Fluid"),Node_Literal:e("./node/Node_Literal"),Node_Uri:e("./node/Node_Uri"),Node_Variable:e("./node/Node_Variable"),Var:e("./node/Var"),BaseDatatype:e("./rdf_datatype/BaseDatatype"),DefaultRdfDatatypes:e("./rdf_datatype/DefaultRdfDatatypes"),RdfDatatype:e("./rdf_datatype/RdfDatatype"),RdfDatatypeBase:e("./rdf_datatype/RdfDatatypeBase"),RdfDatatypeLabel:e("./rdf_datatype/RdfDatatypeLabel"),TypedValue:e("./rdf_datatype/TypedValue")};Object.freeze(r);module.exports=r},{"./AnonId":89,"./AnonIdStr":90,"./LiteralLabel":91,"./NodeFactory":92,"./NodeUtils":93,"./PrefixMappingImpl":94,"./Triple":95,"./TripleUtils":96,"./TypeMapper":97,"./datatype/DatatypeLabel":98,"./datatype/DatatypeLabelFloat":99,"./datatype/DatatypeLabelInteger":100,"./datatype/DatatypeLabelString":101,"./datatype/DefaultDatatypeLabels":102,"./node/Node":104,"./node/Node_Blank":105,"./node/Node_Concrete":106,"./node/Node_Fluid":107,"./node/Node_Literal":108,"./node/Node_Uri":109,"./node/Node_Variable":110,"./node/Var":111,"./rdf_datatype/BaseDatatype":112,"./rdf_datatype/DefaultRdfDatatypes":113,"./rdf_datatype/RdfDatatype":114,"./rdf_datatype/RdfDatatypeBase":115,"./rdf_datatype/RdfDatatypeLabel":116,"./rdf_datatype/TypedValue":117}],104:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({classLabel:"Node",getUri:function(){throw new Error("not a URI node")},getName:function(){throw new Error("is not a variable node")},getBlankNodeId:function(){throw new Error("is not a blank node")},getBlankNodeLabel:function(){return this.getBlankNodeId().getLabelString()},getLiteral:function(){throw new Error("is not a literal node")},getLiteralValue:function(){throw new Error("is not a literal node")},getLiteralLexicalForm:function(){throw new Error("is not a literal node")},getLiteralDatatype:function(){throw new Error("is not a literal node")},getLiteralDatatypeUri:function(){throw new Error("is not a literal node")},isBlank:function(){return false},isUri:function(){return false},isLiteral:function(){return false},isVariable:function(){return false},equals:function(e){var t=false;if(e==null){t=false}else if(this.isLiteral()){if(e.isLiteral()){var r=this.getLiteralLexicalForm()===e.getLiteralLexicalForm();var a=this.getLiteralDatatypeUri()===e.getLiteralDatatypeUri();var n=this.getLiteralLanguage()===e.getLiteralLanguage();t=r&&a&&n}}else if(this.isUri()){if(e.isUri()){t=this.getUri()===e.getUri()}}else if(this.isVariable()){if(e.isVariable()){t=this.getName()===e.getName()}}else if(this.isBlank()){if(e.isBlank()){t=this.getBlankNodeLabel()===e.getBlankNodeLabel()}}else{throw new Error("not implemented yet")}return t
}});module.exports=a},{"../../ext/Class":2}],105:[function(e,module,t){var r=e("../../ext/Class");var a=e("./Node_Concrete");var n=r.create(a,{classLabel:"jassa.rdf.Node_Blank",initialize:function(e){this.anonId=e},isBlank:function(){return true},getBlankNodeId:function(){return this.anonId},toString:function(){return"_:"+this.anonId}});module.exports=n},{"../../ext/Class":2,"./Node_Concrete":106}],106:[function(e,module,t){var r=e("../../ext/Class");var a=e("./Node");var n=r.create(a,{classLabel:"jassa.rdf.Node_Concrete",isConcrete:function(){return true}});module.exports=n},{"../../ext/Class":2,"./Node":104}],107:[function(e,module,t){var r=e("../../ext/Class");var a=e("./Node");var n=r.create(a,{classLabel:"jassa.rdf.Node_Fluid",isConcrete:function(){return false}});module.exports=n},{"../../ext/Class":2,"./Node":104}],108:[function(e,module,t){var r=e("../../ext/Class");var a=e("./Node_Concrete");var n=r.create(a,{classLabel:"Node_Literal",initialize:function(e){this.literalLabel=e},isLiteral:function(){return true},getLiteral:function(){return this.literalLabel},getLiteralValue:function(){return this.literalLabel.getValue()},getLiteralLexicalForm:function(){return this.literalLabel.getLexicalForm()},getLiteralDatatype:function(){return this.literalLabel.getDatatype()},getLiteralDatatypeUri:function(){var e=this.getLiteralDatatype();var t=e?e.getUri():null;return t},getLiteralLanguage:function(){return this.literalLabel.getLanguage()},toString:function(){return this.literalLabel.toString()}});module.exports=n},{"../../ext/Class":2,"./Node_Concrete":106}],109:[function(e,module,t){var r=e("../../ext/Class");var a=e("./Node_Concrete");var n=r.create(a,{classLabel:"jassa.rdf.Node_Uri",initialize:function(e){this.uri=e},isUri:function(){return true},getUri:function(){return this.uri},toString:function(){return"<"+this.uri+">"}});module.exports=n},{"../../ext/Class":2,"./Node_Concrete":106}],110:[function(e,module,t){var r=e("../../ext/Class");var a=e("./Node_Fluid");var n=r.create(a,{classLabel:"jassa.rdf.Node_Variable",isVariable:function(){return true}});module.exports=n},{"../../ext/Class":2,"./Node_Fluid":107}],111:[function(e,module,t){var r=e("../../ext/Class");var a=e("./Node_Variable");var n=r.create(a,{classLabel:"Var",initialize:function(e){this.name=e},getName:function(){return this.name},toString:function(){return"?"+this.name}});module.exports=n},{"../../ext/Class":2,"./Node_Variable":110}],112:[function(e,module,t){var r=e("../../ext/Class");var a=e("./RdfDatatype");var n=e("./TypedValue");var i=r.create(a,{classLabel:"jassa.rdf.BaseDatatype",initialize:function(e){this.datatypeUri=e},getUri:function(){return this.datatypeUri},unparse:function(e){var t;if(e instanceof n){t=e.getLexicalValue()}else{t=e.toString()}return t},parse:function(e){return new n(e,this.datatypeUri)},toString:function(){return"Datatype ["+this.datatypeUri+"]"}});module.exports=i},{"../../ext/Class":2,"./RdfDatatype":114,"./TypedValue":117}],113:[function(e,module,t){var r=e("../../vocab/xsd");var a=e("../datatype/DefaultDatatypeLabels");var n=e("./RdfDatatypeLabel");var i={};var s=function(e,t){var r=e.getUri();i[r]=new n(r,t)};s(r.xint,a.xinteger);s(r.xlong,a.xinteger);s(r.xinteger,a.xinteger);s(r.xstring,a.xstring);s(r.xfloat,a.xfloat);s(r.xdouble,a.xdouble);s(r.decimal,a.xfloat);module.exports=i},{"../../vocab/xsd":356,"../datatype/DefaultDatatypeLabels":102,"./RdfDatatypeLabel":116}],114:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({classLabel:"RdfDatatype",getUri:function(){throw new Error("Not implemented")},unparse:function(){throw new Error("Not implemented")},parse:function(){throw new Error("Not implemented")}});module.exports=a},{"../../ext/Class":2}],115:[function(e,module,t){var r=e("../../ext/Class");var a=e("./RdfDatatype");var n=r.create(a,{classLabel:"jassa.rdf.RdfDatatypeBase",initialize:function(e){this.uri=e},getUri:function(){return this.uri}});module.exports=n},{"../../ext/Class":2,"./RdfDatatype":114}],116:[function(e,module,t){var r=e("../../ext/Class");var a=e("./RdfDatatypeBase");var n=r.create(a,{classLabel:"jassa.rdf.RdfDatatype_Label",initialize:function($super,e,t){$super(e);this.datatypeLabel=t},parse:function(e){return this.datatypeLabel.parse(e)},unparse:function(e){return this.datatypeLabel.unparse(e)}});module.exports=n},{"../../ext/Class":2,"./RdfDatatypeBase":115}],117:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({classLabel:"jassa.rdf.TypedValue",initialize:function(e,t){this.lexicalValue=e;this.datatypeUri=t},getLexicalValue:function(){return this.lexicalValue},getDatatypeUri:function(){return this.datatypeUri}});module.exports=a},{"../../ext/Class":2}],118:[function(e,module,t){var r=e("lodash.defaults");var a={createSparqlRequestAjaxSpec:function(e,t,a,n,i){var s=t;if(s&&s.length===1){s=s[0]}var o={query:a,"default-graph-uri":s};var l={url:e,dataType:"json",crossDomain:true,traditional:true,data:o};r(o,n);r(l,i);return l}};module.exports=a},{"lodash.defaults":357}],119:[function(e,module,t){var r=e("../ext/Class");var a=e("../sparql/ExprUtils");var n=r.create({initialize:function(e,t){this.sparqlService=e;this.element=t},lookupByIterator:function(e){var t=[];while(e.hasNext()){var r=e.nextBinding();var n=a.bindingToExprs(r);var i=n.join(", ");t.push({binding:r,exprs:n,exprsKey:i})}}});module.exports=n},{"../ext/Class":2,"../sparql/ExprUtils":210}],120:[function(e,module,t){var r=e("../util/collection/HashMap");var a=e("../util/shared");var n=a.Promise;var i={lookup:function(e,t){var r;if(!e||!t){r=n.resolve([])}else{r=e.lookup(t)}return r},zip:function(e,t){var a=n.all(t).then(function(){var t=new r;for(var a=0;a<e.length;++a){var n=e[a];var i=arguments[a];t.put(n,i)}return t});return a},unmapKeys:function(e,t,a){var n=new r;e.forEach(function(e){var r=t(e);var i=a.get(r);n.put(e,i)});return n},fetchItemsMapped:function(e,t,r){var a=t.map(r);var n=e.fetchItems(a).then(function(e){var a=i.unmapKeys(t,r,e);return a});return n},fetchCountsMapped:function(e,t,r){var a=t.map(r);var n=e.fetchCounts(a).then(function(e){var a=i.unmapKeys(t,r,e);return a});return n}};module.exports=i},{"../util/collection/HashMap":342,"../util/shared":350}],121:[function(e,module,t){var r={computeRange:function(e,t,r){var a=t||0;var n=a%r;a-=n;var i=e;var s;if(i){s=i;var o=i%r;i+=r-o}var l={limit:i,offset:a,subLimit:s,subOffset:n};return l}};module.exports=r},{}],122:[function(e,module,t){var r=e("../ext/Class");var a=r.create({initialize:function(e,t){this.query=e;var r=e.getOffset();var a=e.getLimit();this.nextOffset=r||0;this.nextRemaining=a==null?null:a;this.pageSize=t},getPageSize:function(){return this.pageSize},next:function(){var e=this.nextOffset===0?null:this.nextOffset;this.query.setOffset(e);if(this.nextRemaining==null){this.query.setLimit(this.pageSize);this.nextOffset+=this.pageSize}else{var t=Math.min(this.pageSize,this.nextRemaining);this.nextOffset+=t;this.nextRemaining-=t;if(t===0){return null}this.query.setLimit(t)}return this.query}});module.exports=a},{"../ext/Class":2}],123:[function(e,module,t){var r=e("../ext/Class");var a=e("./cache/CacheSimple");var n=r.create({initialize:function(e,t){this.executionCache=e?e:{};this.resultCache=t?t:new a},getExecutionCache:function(){return this.executionCache},getResultCache:function(){return this.resultCache}});module.exports=n},{"../ext/Class":2,"./cache/CacheSimple":130}],124:[function(e,module,t){var r=e("../ext/Class");var a=r.create({initialize:function(e,t){this.varNames=e||[];this.bindings=t||[]},getVarNames:function(){return this.varNames},getBindings:function(){return this.bindings},toString:function(){return"ResultSetPart: vars="+this.varNames+", bindings="+this.bindings}});module.exports=a},{"../ext/Class":2}],125:[function(e,module,t){var r=e("../util/collection/HashMap");var a=e("../util/collection/IteratorArray");var n=e("../sparql/VarUtils");var i=e("./result_set/ResultSetArrayIteratorBinding");var s=e("./ResultSetPart");var o=e("../sparql/Binding");var l={jsonToResultSet:function(e){var t=e.head.vars;var r=e.results.bindings;var n=r.map(function(e){var t=o.fromTalisJson(e);return t});var s=new a(n);var l=new i(s,t);return l},partition:function(e,t){var a=e.getVarNames();var n=new r;while(e.hasNext()){var i=e.next();var o=i.get(t);var l=n.get(o);if(l==null){l=new s(a);n.put(o,l)}l.getBindings().push(i)}return n},createResultSetFromBindings:function(e,t){var r=new a(e);var n=new i(r,t);return n},createEmptyResultSet:function(e){var t=e.getProjectVars();var r=n.getVarNames(t);var a=this.createResultSetFromBindings([],r);return a}};module.exports=l},{"../sparql/Binding":199,"../sparql/VarUtils":226,"../util/collection/HashMap":342,"../util/collection/IteratorArray":346,"./ResultSetPart":124,"./result_set/ResultSetArrayIteratorBinding":176}],126:[function(e,module,t){var r=e("lodash.union");var a=e("../util/shared");var n=a.Promise;var i=e("./result_set/ResultSetArrayIteratorBinding");var s=e("../util/ArrayUtils");var o=e("../util/collection/IteratorArray");var l=e("../sparql/expr/ExprVar");var c=e("../sparql/element/ElementFilter");var u=e("../sparql/expr/E_OneOf");var d=e("../sparql/element/ElementSubQuery");var p=e("../sparql/VarUtils");var h=e("../sparql/Binding");var v=e("../sparql/ConceptUtils");var f=e("../sparql/ElementUtils");var g=e("../sparql/QueryUtils");var m={constrainQueryVar:function(e,t,r){var a=new l(t);var n=this.constrainQueryExprVar(e,a,r);return n},constrainQueryExprVar:function(e,t,r){var a=e.clone();var n=new c(new u(t,r));a.getElements().push(n);return a},chunkQuery:function(e,t,r,a){var n=s.chunk(r,a);var i=new l(t);var o=this;var c=n.map(function(){var t=o.constrainQueryExprVar(e,i,r);return t});return c},mergeResultSets:function(e){var t=[];var a=[];e.forEach(function(e){var n=e.getVarNames();a=r(a,n);var i=e.getIterator().getArray();t.push.apply(t,i)});var n=new o(t);var s=new i(n,a);return s},execSelectForNodes:function(e,t,r,a,i){var s=this.chunkQuery(t,r,a,i);var o=s.map(function(t){var r=e.createQueryExecution(t);var a=r.execSelect();return a});var l=n.all(o);var c=this;var u=l.then(function(){var e=c.mergeResultSets(arguments);return e});return u},consumeResultSet:function(e){while(e.hasNext()){e.nextBinding()}},resultSetToList:function(e,t){var r=[];while(e.hasNext()){var a=e.nextBinding();var n=a.get(t);r.push(n)}return r},resultSetToInt:function(e,t){var r=null;if(e.hasNext()){var a=e.nextBinding();var n=a.get(t);r=n.getLiteralValue()}return r},fetchList:function(e,t){var r=this;var a=e.execSelect().then(function(e){var a=r.resultSetToList(e,t);return a});return a},fetchInt:function(e,t,r){var a=e.createQueryExecution(t);var n=this.fetchIntQe(a,r);return n},fetchIntQe:function(e,t){var r=this;var a=e.execSelect().then(function(e){var a=r.resultSetToInt(e,t);return a});return a},fetchCountConcept:n.method(function(e,t,r,a){var n=v.freshVar(t);var i=r==null?null:r+1;var s=a==null?null:a+1;var o=v.createQueryCount(t,n,i,s);return m.fetchInt(e,o,n).then(function(e){var t=a!=null?null:r!=null?e>r:false;var n={hasMoreItems:t,count:t?r:e,itemLimit:r,rowLimit:a};return n})}),fetchCountRows:function(e,t,r){var a=f.freshVar(t,"c");var n=f.createQueryCountRows(t,a,r+1);var i=this.fetchInt(e,n,a).then(function(e){var t={count:Math.min(e,r),hasMoreItems:e>r,rowLimit:r};return t});return i},fetchCountQuery:n.method(function(e,t,r,a){var n=[new d(t)];var i=t.getVarsMentioned();var s=p.createVarGen("c",i);var o=s.next();var l=g.createQueryCount(n,null,null,o,null,null,null);var c=e.createQueryExecution(l);c.setTimeout(r);return m.fetchIntQe(c,o).then(function(e){return{count:e,limit:null,hasMoreItems:false}}).caught(function(){var t=g.createQueryCount(n,a+1,null,o,null,null,null);var r=e.createQueryExecution(t);return m.fetchIntQe(r,o).then(function(e){return{count:e,limit:a,hasMoreItems:e>a}})})}),fetchItemsConcept:function(e,t,r,a){var n=v.createQueryList(t,r,a);var i=e.createQueryExecution(n);var s=i.execSelect().then(function(e){var r=m.resultSetToList(e,t.getVar());return r});return s}};module.exports=m},{"../sparql/Binding":199,"../sparql/ConceptUtils":203,"../sparql/ElementUtils":206,"../sparql/QueryUtils":219,"../sparql/VarUtils":226,"../sparql/element/ElementFilter":231,"../sparql/element/ElementSubQuery":235,"../sparql/expr/E_OneOf":256,"../sparql/expr/ExprVar":268,"../util/ArrayUtils":326,"../util/collection/IteratorArray":346,"../util/shared":350,"./result_set/ResultSetArrayIteratorBinding":176,"lodash.union":559}],127:[function(e,module,t){var r=e("../ext/Class");var a=e("./sparql_service/SparqlServiceHttp");var n=e("./sparql_service/SparqlServicePaginate");var i=e("./sparql_service/SparqlServicePageExpand");var s=e("./sparql_service/SparqlServiceCache");var o=e("./sparql_service/SparqlServiceVirtFix");var l=e("./sparql_service/SparqlServiceLimit");var c=r.create({initialize:function(e){this.sparqlService=e},create:function(){return this.sparqlService},paginate:function(e){this.sparqlService=new n(this.sparqlService,e);return this},pageExpand:function(e){this.sparqlService=new i(this.sparqlService,e);return this},cache:function(e){this.sparqlService=new s(this.sparqlService,e);return this},virtFix:function(){this.sparqlService=new o(this.sparqlService);return this},limit:function(e){this.sparqlService=new l(this.sparqlService,e);return this}});c.http=function(e,t,r,n){var i=new a(e,t,r,n);var s=new c(i);return s};module.exports=c},{"../ext/Class":2,"./sparql_service/SparqlServiceCache":180,"./sparql_service/SparqlServiceHttp":186,"./sparql_service/SparqlServiceLimit":187,"./sparql_service/SparqlServicePageExpand":188,"./sparql_service/SparqlServicePaginate":189,"./sparql_service/SparqlServiceVirtFix":191}],128:[function(e,module,t){var r=e("lodash.uniq");var a=e("../sparql/VarUtils");var n=e("./ServiceUtils");var i=e("../util/collection/IteratorArray");var s=e("./result_set/ResultSetArrayIteratorBinding");var o=e("../util/shared");var l=o.Promise;var c={bindingToJsMap:function(e,t){var r={};e.forEach(function(e){var a=e.getName();r[a]=t.get(e)});return r},createNgGridOptionsFromQuery:function(e){if(!e){return[]}var t=e.getProjectVars();var r=a.getVarNames(t);var n=r.map(function(e){var t={field:e,displayName:e};return t});return n},fetchCount:function(e,t,r,a){var i;if(!e||!t){i=new l(function(e){e(0)})}else{t=t.clone();t.setLimit(null);t.setOffset(null);i=n.fetchCountQuery(e,t,r,a)}return i},fetchData:function(e,t,r,a){if(!e||!t){var n=new i([]);var o=[];var u=new s(n,o);return new l(function(e){e(u)})}t=t.clone();t.setLimit(r);t.setOffset(a);var d=e.createQueryExecution(t);var p=d.execSelect().then(function(e){var r=[];var a=t.getProjectVars();while(e.hasNext()){var n=e.next();var i=c.bindingToJsMap(a,n);r.push(i)}return r});return p},collectNodes:function(e){var t=[];e.forEach(function(e){e.forEach(function(e){t.push(e)})});t=r(t,false,function(e){return e.toString()});return t},fetchSchemaTableConfigFacet:function(e,t){var r=e.getPaths().getArray();var a=t.lookup(r);var n=a.then(function(t){var a=r.map(function(r){var a={field:e.getColumnId(r),displayName:t.get(r),path:r};return a});var n={colDefs:a};return n});return n},transformToNodeLabels:function(e,t){var r=this.collectNodes(t);var a=e.lookup(r);var n=a.then(function(e){var r=t.map(function(t){var r={};t.forEach(function(t,a){var n=e.get(t);r[a]={node:t,displayLabel:n}});return r});return r});return n}};module.exports=c},{"../sparql/VarUtils":226,"../util/collection/IteratorArray":346,"../util/shared":350,"./ServiceUtils":126,"./result_set/ResultSetArrayIteratorBinding":176,"lodash.uniq":582}],129:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({getItem:function(e){throw new Error("not implemented")},setItem:function(e,t){throw new Error("not implemented")}});module.exports=a},{"../../ext/Class":2}],130:[function(e,module,t){var r=e("../../ext/Class");var a=e("./Cache");var n=r.create(a,{initialize:function(e){this.data=e||{}},getItem:function(e){var t=this.data[e];return t},setItem:function(e,t){this.data[e]=t}});module.exports=n},{"../../ext/Class":2,"./Cache":129}],131:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({initialize:function(e){this.v=e;this.orders=[];this.restrictions=[];this.subCriteria=[]},createCriteria:function(e,t,r){var n=new a;this.subCriteria.push({property:e})},add:function(e){},getVar:function(){return this.v},addOrder:function(e){this.orders.push(e)},toSparqlString:function(){},createListService:function(){}});module.exports=a},{"../../ext/Class":2}],132:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({initialize:function(e,t){this.property=e;this._isAscending=t},isAscending:function(){return this._isAscending}});module.exports=a},{"../../ext/Class":2}],133:[function(e,module,t){var r={gt:function(e,t){}};module.exports=r},{}],134:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({initialize:function(e){}});module.exports=a},{"../../ext/Class":2}],135:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({fetchData:function(){throw new Error("Not implemented")}});module.exports=a},{"../../ext/Class":2}],136:[function(e,module,t){"use strict";var r={AjaxUtils:e("./AjaxUtils"),BindingLookup:e("./BindingLookup"),LookupServiceUtils:e("./LookupServiceUtils"),PageExpandUtils:e("./PageExpandUtils"),QueryPaginator:e("./QueryPaginator"),RequestCache:e("./RequestCache"),ResultSetPart:e("./ResultSetPart"),ResultSetUtils:e("./ResultSetUtils"),ServiceUtils:e("./ServiceUtils"),SparqlServiceBuilder:e("./SparqlServiceBuilder"),TableServiceUtils:e("./TableServiceUtils"),Cache:e("./cache/Cache"),CacheSimple:e("./cache/CacheSimple"),Criteria:e("./criteria/Criteria"),Order:e("./criteria/Order"),Restrictions:e("./criteria/Restrictions"),ServiceBuilder:e("./criteria/ServiceBuilder"),DataService:e("./data_service/DataService"),AugmenterLookup:e("./list_service/AugmenterLookup"),ListService:e("./list_service/ListService"),ListServiceArray:e("./list_service/ListServiceArray"),ListServiceAugmenter:e("./list_service/ListServiceAugmenter"),ListServiceConcept:e("./list_service/ListServiceConcept"),ListServiceConceptKeyLookup:e("./list_service/ListServiceConceptKeyLookup"),ListServiceIndexSubString:e("./list_service/ListServiceIndexSubString"),ListServicePageExpand:e("./list_service/ListServicePageExpand"),ListServiceSparqlQuery:e("./list_service/ListServiceSparqlQuery"),ListServiceTransformConcept:e("./list_service/ListServiceTransformConcept"),ListServiceTransformConceptMode:e("./list_service/ListServiceTransformConceptMode"),ListServiceTransformItem:e("./list_service/ListServiceTransformItem"),ListServiceTransformItems:e("./list_service/ListServiceTransformItems"),LookupService:e("./lookup_service/LookupService"),LookupServiceBase:e("./lookup_service/LookupServiceBase"),LookupServiceCache:e("./lookup_service/LookupServiceCache"),LookupServiceChunker:e("./lookup_service/LookupServiceChunker"),LookupServiceConst:e("./lookup_service/LookupServiceConst"),LookupServiceDelegateBase:e("./lookup_service/LookupServiceDelegateBase"),LookupServiceFn:e("./lookup_service/LookupServiceFn"),LookupServiceIdFilter:e("./lookup_service/LookupServiceIdFilter"),LookupServiceKeyMap:e("./lookup_service/LookupServiceKeyMap"),LookupServiceMap:e("./lookup_service/LookupServiceMap"),LookupServiceMulti:e("./lookup_service/LookupServiceMulti"),LookupServiceSparqlQuery:e("./lookup_service/LookupServiceSparqlQuery"),LookupServiceTimeout:e("./lookup_service/LookupServiceTimeout"),LookupServiceTransform:e("./lookup_service/LookupServiceTransform"),LookupServiceTransformKey:e("./lookup_service/LookupServiceTransformKey"),QueryCacheBindingHashSingle:e("./query_cache/QueryCacheBindingHashSingle"),QueryCacheNodeFactory:e("./query_cache/QueryCacheNodeFactory"),QueryCacheNodeFactoryImpl:e("./query_cache/QueryCacheNodeFactoryImpl"),QueryExecution:e("./query_execution/QueryExecution"),QueryExecutionCache:e("./query_execution/QueryExecutionCache"),QueryExecutionDelegate:e("./query_execution/QueryExecutionDelegate"),QueryExecutionFailover:e("./query_execution/QueryExecutionFailover"),QueryExecutionHttp:e("./query_execution/QueryExecutionHttp"),QueryExecutionPageExpand:e("./query_execution/QueryExecutionPageExpand"),QueryExecutionPaginate:e("./query_execution/QueryExecutionPaginate"),ResultSet:e("./result_set/ResultSet"),ResultSetArrayIteratorBinding:e("./result_set/ResultSetArrayIteratorBinding"),ResultSetHashJoin:e("./result_set/ResultSetHashJoin"),SparqlService:e("./sparql_service/SparqlService"),SparqlServiceBaseString:e("./sparql_service/SparqlServiceBaseString"),SparqlServiceCache:e("./sparql_service/SparqlServiceCache"),SparqlServiceConsoleLog:e("./sparql_service/SparqlServiceConsoleLog"),SparqlServiceFactory:e("./sparql_service/SparqlServiceFactory"),SparqlServiceFactoryConst:e("./sparql_service/SparqlServiceFactoryConst"),SparqlServiceFactoryDefault:e("./sparql_service/SparqlServiceFactoryDefault"),SparqlServiceFailover:e("./sparql_service/SparqlServiceFailover"),SparqlServiceHttp:e("./sparql_service/SparqlServiceHttp"),SparqlServiceLimit:e("./sparql_service/SparqlServiceLimit"),SparqlServicePageExpand:e("./sparql_service/SparqlServicePageExpand"),SparqlServicePaginate:e("./sparql_service/SparqlServicePaginate"),SparqlServiceReliableLimit:e("./sparql_service/SparqlServiceReliableLimit"),SparqlServiceVirtFix:e("./sparql_service/SparqlServiceVirtFix"),TableService:e("./table_service/TableService"),TableServiceDelegateBase:e("./table_service/TableServiceDelegateBase"),TableServiceFacet:e("./table_service/TableServiceFacet"),TableServiceListService:e("./table_service/TableServiceListService"),TableServiceNodeLabels:e("./table_service/TableServiceNodeLabels"),TableServiceQuery:e("./table_service/TableServiceQuery")};Object.freeze(r);module.exports=r},{"./AjaxUtils":118,"./BindingLookup":119,"./LookupServiceUtils":120,"./PageExpandUtils":121,"./QueryPaginator":122,"./RequestCache":123,"./ResultSetPart":124,"./ResultSetUtils":125,"./ServiceUtils":126,"./SparqlServiceBuilder":127,"./TableServiceUtils":128,"./cache/Cache":129,"./cache/CacheSimple":130,"./criteria/Criteria":131,"./criteria/Order":132,"./criteria/Restrictions":133,"./criteria/ServiceBuilder":134,"./data_service/DataService":135,"./list_service/AugmenterLookup":137,"./list_service/ListService":138,"./list_service/ListServiceArray":139,"./list_service/ListServiceAugmenter":140,"./list_service/ListServiceConcept":141,"./list_service/ListServiceConceptKeyLookup":142,"./list_service/ListServiceIndexSubString":143,"./list_service/ListServicePageExpand":144,"./list_service/ListServiceSparqlQuery":145,"./list_service/ListServiceTransformConcept":146,"./list_service/ListServiceTransformConceptMode":147,"./list_service/ListServiceTransformItem":148,"./list_service/ListServiceTransformItems":149,"./lookup_service/LookupService":150,"./lookup_service/LookupServiceBase":151,"./lookup_service/LookupServiceCache":152,"./lookup_service/LookupServiceChunker":153,"./lookup_service/LookupServiceConst":154,"./lookup_service/LookupServiceDelegateBase":155,"./lookup_service/LookupServiceFn":156,"./lookup_service/LookupServiceIdFilter":157,"./lookup_service/LookupServiceKeyMap":158,"./lookup_service/LookupServiceMap":159,"./lookup_service/LookupServiceMulti":160,"./lookup_service/LookupServiceSparqlQuery":161,"./lookup_service/LookupServiceTimeout":162,"./lookup_service/LookupServiceTransform":163,"./lookup_service/LookupServiceTransformKey":164,"./query_cache/QueryCacheBindingHashSingle":165,"./query_cache/QueryCacheNodeFactory":166,"./query_cache/QueryCacheNodeFactoryImpl":167,"./query_execution/QueryExecution":168,"./query_execution/QueryExecutionCache":169,"./query_execution/QueryExecutionDelegate":170,"./query_execution/QueryExecutionFailover":171,"./query_execution/QueryExecutionHttp":172,"./query_execution/QueryExecutionPageExpand":173,"./query_execution/QueryExecutionPaginate":174,"./result_set/ResultSet":175,"./result_set/ResultSetArrayIteratorBinding":176,"./result_set/ResultSetHashJoin":177,"./sparql_service/SparqlService":178,"./sparql_service/SparqlServiceBaseString":179,"./sparql_service/SparqlServiceCache":180,"./sparql_service/SparqlServiceConsoleLog":181,"./sparql_service/SparqlServiceFactory":182,"./sparql_service/SparqlServiceFactoryConst":183,"./sparql_service/SparqlServiceFactoryDefault":184,"./sparql_service/SparqlServiceFailover":185,"./sparql_service/SparqlServiceHttp":186,"./sparql_service/SparqlServiceLimit":187,"./sparql_service/SparqlServicePageExpand":188,"./sparql_service/SparqlServicePaginate":189,"./sparql_service/SparqlServiceReliableLimit":190,"./sparql_service/SparqlServiceVirtFix":191,"./table_service/TableService":192,"./table_service/TableServiceDelegateBase":193,"./table_service/TableServiceFacet":194,"./table_service/TableServiceListService":195,"./table_service/TableServiceNodeLabels":196,"./table_service/TableServiceQuery":197}],137:[function(e,module,t){var r=e("../../ext/Class");var a=e("../../util/ObjectUtils");var n=r.create({initialize:function(e,t,r){this.lookupService=e;this.itemToKeyFn=t||function(e){return e.key};this.mergeFn=r||function(e,t){var r=a.extend(e,t);return r}},augment:function(e){var t=e.map(this.itemToKeyFn);var r=this;var a=this.lookupService.lookup(t).then(function(a){for(var n=0;n<t.length;++n){var i=t[n];var s=e[n];var o=a.get(i);e[n]=r.mergeFn(s,o)}return e});return a}});module.exports=n},{"../../ext/Class":2,"../../util/ObjectUtils":331}],138:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({fetchItems:function(e,t,r){throw new Error("Not implemented")},fetchCount:function(e,t,r){throw new Error("Not implemented")}});module.exports=a},{"../../ext/Class":2}],139:[function(e,module,t){var r=e("../../ext/Class");var a=e("../ServiceUtils");var n=e("./ListService");var i=e("../../util/shared");var s=i.Promise;var o=r.create(n,{initialize:function(e,t){this.items=e;this.fnFilterSupplier=t},fetchItems:function(e,t,r){var a=this.fnFilterSupplier(e);var n=this.items.filter(a);var i=r||0;var o=t?i+t:n.length;var l=n.slice(i,o);return s.resolve(l)},fetchCount:function(e,t,r){var a=this.fnFilterSupplier(e);var n=this.items.filter(a);var i=n.length;var o=t!=null?Math.min(i,t):i;var l={count:o,hasMoreItems:o<i};return s.resolve(l)}});module.exports=o},{"../../ext/Class":2,"../../util/shared":350,"../ServiceUtils":126,"./ListService":138}],140:[function(e,module,t){var r=e("../../ext/Class");var a=e("./ListService");var n=r.create(a,{initialize:function(e,t){this.listService=e;this.augmenter=t},fetchItems:function(e,t,r){var a=this;var n=this.listService.fetchItems(e,t,r).then(function(e){var t=a.augmenter.augment(e);return t});return n},fetchCount:function(e,t,r){var a=this.listService.fetchCount(e,t,r);return a}});module.exports=n},{"../../ext/Class":2,"./ListService":138}],141:[function(e,module,t){var r=e("../../ext/Class");var a=e("../ServiceUtils");var n=e("./ListService");var i=r.create(n,{initialize:function(e){this.sparqlService=e},fetchItems:function(e,t,r){var n=a.fetchItemsConcept(this.sparqlService,e,t,r);return n},fetchCount:function(e,t,r){var n=a.fetchCountConcept(this.sparqlService,e,t,r);return n}});module.exports=i},{"../../ext/Class":2,"../ServiceUtils":126,"./ListService":138}],142:[function(e,module,t){var r=e("lodash.values");var a=e("../../ext/Class");var n=e("./ListService");var i=e("../ServiceUtils");var s=e("../../util/shared");var o=s.Promise;var l=e("../../sparql/ConceptUtils");var c=e("../../util/ObjectUtils");var u=a.create(n,{initialize:function(e,t,r,a,n){this.keyListService=e;this.keyLookupService=t;this.keyFn=r||function(e){return e};this.resolveFn=function(e,t){c.extend(e.val||e,t);return e};this.isLeftJoin=n==null?true:n},fetchItems:function(e,t,r){var a=this;var n=o.resolve(this.keyListService.fetchItems(e,t,r)).then(function(e){var t=e.map(a.keyFn);return[e,a.keyLookupService.lookup(t)]}).spread(function(e,t){var r=e.map(function(e){var r=a.keyFn(e);var n=t.get(r);var i=a.resolveFn(e,n);return i});return r});return n},fetchCount:o.method(function(e,t,r){var a;if(this.isLeftJoin){a=this.keyListService.fetchCount(e,t,r)}else{var n=this;a=this.keyListService.fetchItems(e,t).then(function(e){var t=e.map(n.keyFn);return n.keyLookupService.lookup(t)}).then(function(e){var r=e.keys();var a=r.length;var n={count:a,hasMoreItems:t==null?false:null};return n})}return a})});module.exports=u},{"../../ext/Class":2,"../../sparql/ConceptUtils":203,"../../util/ObjectUtils":331,"../../util/shared":350,"../ServiceUtils":126,"./ListService":138,"lodash.values":637}],143:[function(e,module,t){var r=e("../../ext/Class");var a=e("../PageExpandUtils");var n=e("./ListService");var i=r.create(n,{initialize:function(e,t,r,a,n){this.delegate=e;this.filterSupplierFn=t;this.countThreshold=r||1e3;this.itemLimit=a;this.rowLimit=n;this.strToPromise={}},getBestCandKey:function(e){e=e||"";var t=Object.keys(this.strToPromise);var r=this;var a=t.filter(function(t){var r=e.indexOf(t)!==-1;return r});var n=null;var i=null;a.forEach(function(t){var a=r.strToPromise[t];if(a.isFulfilled()){var s=a.value();var o=s?s.length:null;if(o!=null&&(i==null||o<i)){n=t;i=o}}else{if(i==null&&e.indexOf(n)!==-1){n=e}}});return n},filterEntries:function(e,t){var r=this.filterSupplierFn(e);var a=t.filter(r);return a},fetchItems:function(e,t,r){var a=this;var n=this.strToPromise[""];if(n==null||n.isRejected()){n=this.fetchItemsForStr(null)}var i=n.then(function(t){var r=t||e!=null&&a.fetchItemsForStr(e);return r}).then(function(n){var i=r||0;var s=i+(t||n.length);var o=n?a.filterEntries(e,n).slice(i,s):a.delegate.fetchItems(e,t,r);return o});return i},fetchItemsForStr:function(e){var t=this.getBestCandKey(e);var r=t!=null?this.strToPromise[t]:r=this.fetchForStr(e);return r},removeSubsumedStrs:function(e){var t=this;var r=Object.keys(this.strToPromise);r.forEach(function(r){if(e!==r&&r.indexOf(e)!==-1){delete t.strToPromise[r]}})},fetchForStr:function(e){var t=this;if(e===""){e=null}var r=this.delegate.fetchCount(e,this.itemLimit,this.rowLimit).then(function(r){var a=null;if(r.hasMoreItems===false&&r.count<t.countThreshold){a=t.delegate.fetchItems(e).then(function(r){t.removeSubsumedStrs(e);return r})}return a});var a=e||"";this.strToPromise[a]=r;return r},fetchCount:function(e,t,r){var a=this;var n=this.getBestCandKey(e);var i;if(n!=null){var s=this.strToPromise[n];i=s.then(function(n){var i;if(!n){i=a.delegate.fetchCount(e,t,r)}else{var s=a.filterEntries(e,n);i={count:s.length,hasMoreItems:false}}return i})}else{i=this.delegate.fetchCount(e,t,r)}return i}});module.exports=i},{"../../ext/Class":2,"../PageExpandUtils":121,"./ListService":138}],144:[function(e,module,t){var r=e("../../ext/Class");var a=e("../PageExpandUtils");var n=e("./ListService");var i=r.create(n,{initialize:function(e,t){this.listService=e;this.pageSize=t},fetchItems:function(e,t,r){var n=a.computeRange(t,r,this.pageSize);var i=this.listService.fetchItems(e,n.limit,n.offset);var s=i.then(function(e){var t=n.subLimit?n.subOffset+n.subLimit:e.length;var r=e.slice(n.subOffset,t);return r});return s},fetchCount:function(e,t,r){var a=this.listService.fetchCount(e,t,r);return a}});module.exports=i},{"../../ext/Class":2,"../PageExpandUtils":121,"./ListService":138}],145:[function(e,module,t){var r=e("../../ext/Class");var a=e("lodash.values");var n=e("../../util/shared");var i=n.Promise;var s=e("../../sparql/Concept");var o=e("../../sparql/ConceptUtils");var l=e("../ServiceUtils");var c=e("../ResultSetUtils");var u=e("./ListService");var d=r.create(u,{initialize:function(e,t,r,a){if(t.getLimit()||t.getOffset()){throw new Error("Limit and offset in attribute queries not yet supported")}this.sparqlService=e;this.attrQuery=t;this.attrVar=r;this.isLeftJoin=a},fetchItems:function(e,t,r){var n=this.attrVar;if(!e){e=o.createSubjectConcept()}var i=o.createAttrQuery(this.attrQuery,n,this.isLeftJoin,e,t,r);var s=this.sparqlService.createQueryExecution(i);var l=s.execSelect().then(function(e){var t=c.partition(e,n);
var r=t.entries();var i=a(r);return i});return l},fetchCount:function(e,t,r){if(!e){e=o.createSubjectConcept()}var a;if(this.isLeftJoin){var n=o.createAttrQuery(this.attrQuery,this.attrVar,this.isLeftJoin,e,t,null);a=new s(n.getQueryPattern(),this.attrVar)}else{var i=new s(this.attrQuery.getQueryPattern(),this.attrVar);a=o.createCombinedConcept(i,e,true,false,false)}var c=l.fetchCountConcept(this.sparqlService,a,t,r);return c}});module.exports=d},{"../../ext/Class":2,"../../sparql/Concept":202,"../../sparql/ConceptUtils":203,"../../util/shared":350,"../ResultSetUtils":125,"../ServiceUtils":126,"./ListService":138,"lodash.values":637}],146:[function(e,module,t){var r=e("../../ext/Class");var a=e("./ListService");var n=r.create(a,{initialize:function(e,t){this.listService=e;this.fnTransformConcept=t;if(!t){throw new Error("No transformation function provided")}},fetchItems:function(e,t,r){var a=this.fnTransformConcept(e);var n=this.listService.fetchItems(a,t,r);return n},fetchCount:function(e,t,r){var a=this.fnTransformConcept(e);var n=this.listService.fetchCount(a,t,r);return n}});module.exports=n},{"../../ext/Class":2,"./ListService":138}],147:[function(e,module,t){var r=e("../../ext/Class");var a=e("./ListService");var n=e("../../sparql/search/KeywordSearchUtils");var i={regex:n.createConceptRegexLabelOnly,fulltext:n.createConceptBifContains};var s=r.create({initialize:function(e,t,r){this.listService=e;this.labelRelationFn=t;this.idToFilterFn=r||i},createConcept:function(e){var t;if(e==null||e.searchString==null||e.searchString.trim()===""){t=null}else{var r=this.labelRelationFn();var a=e.mode?e.mode:"default";var n=this.idToFilterFn[a];if(!n){throw new Error('No filter function registered for mode "'+a+'"')}t=n(r,e.searchString)}return t},fetchItems:function(e,t,r){var a=this.createConcept(e);var n=this.listService.fetchItems(a,t,r);return n},fetchCount:function(e,t,r){var a=this.createConcept(e);var n=this.listService.fetchCount(a,t,r);return n}});module.exports=s},{"../../ext/Class":2,"../../sparql/search/KeywordSearchUtils":279,"./ListService":138}],148:[function(e,module,t){var r=e("../../ext/Class");var a=e("./ListService");var n=r.create(a,{initialize:function(e,t){this.listService=e;this.fnTransformItem=t},fetchItems:function(e,t,r){var a=this;var n=this.listService.fetchItems(e,t,r).then(function(e){var t=e.map(a.fnTransformItem);return t});return n},fetchCount:function(e,t,r){var a=this.listService.fetchCount(e,t,r);return a}});module.exports=n},{"../../ext/Class":2,"./ListService":138}],149:[function(e,module,t){var r=e("../../ext/Class");var a=e("./ListService");var n=e("../../util/shared");var i=n.Promise;var s=r.create(a,{initialize:function(e,t){this.listService=e;this.fnTransformItems=t},fetchItems:i.method(function(e,t,r){var a=this;var n=this.listService.fetchItems(e,t,r).then(function(e){var t=a.fnTransformItems(e);return t});return n}),fetchCount:function(e,t,r){var a=this.listService.fetchCount(e,t,r);return a}});module.exports=s},{"../../ext/Class":2,"../../util/shared":350,"./ListService":138}],150:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({getIdStr:function(){throw new Error("Not overridden")},lookup:function(e){throw new Error("Not overridden")}});module.exports=a},{"../../ext/Class":2}],151:[function(e,module,t){var r=e("../../ext/Class");var a=e("./LookupService");var n=r.create(a,{getIdStr:function(e){var t=e.toString();return t}});module.exports=n},{"../../ext/Class":2,"./LookupService":150}],152:[function(e,module,t){var r=e("../../ext/Class");var a=e("lodash.uniq");var n=e("./LookupServiceDelegateBase");var i=e("../RequestCache");var s=e("../../util/collection/HashMap");var o=e("../../util/shared");var l=o.Promise;var c=r.create(n,{initialize:function($super,e,t){$super(e);this.requestCache=t||new i},lookup:function(e){var t=this;var r=a(e,false,function(e){var r=t.getIdStr(e);return r});var n=new s;var i=this.requestCache.getResultCache();var o=this.requestCache.getExecutionCache();var c=[];var u=[];var d=[];r.forEach(function(e){var r=t.getIdStr(e);var a=i.getItem(r);if(!a){var s=o[r];if(s){u.push(e);var l=d.find(function(e){var t=e===s;return t});if(!l){d.push(s)}}else{c.push(e);u.push(e)}}else{n.put(e,a)}});if(c.length>0){var p=this.fetchAndCache(c);d.push(p)}var h=l.all(d).then(function(){var e=arguments;u.forEach(function(t){var r=null;e.find(function(e){r=e.get(t);return Boolean(r)});if(r){n.put(t,r)}});return n});return h},fetchAndCache:function(e){var t=this.requestCache.getResultCache();var r=this.requestCache.getExecutionCache();var a=this;var n=this.delegate.lookup(e);var i=n.then(function(n){var i=new s;e.forEach(function(e){var r=a.getIdStr(e);var s=n.get(e);t.setItem(r,s);i.put(e,s)});e.forEach(function(e){var t=a.getIdStr(e);delete r[t]});return i});e.forEach(function(e){var t=a.getIdStr(e);r[t]=i});return i}});module.exports=c},{"../../ext/Class":2,"../../util/collection/HashMap":342,"../../util/shared":350,"../RequestCache":123,"./LookupServiceDelegateBase":155,"lodash.uniq":582}],153:[function(e,module,t){var r=e("../../ext/Class");var a=e("lodash.uniq");var n=e("../../util/ArrayUtils");var i=e("../../util/collection/HashMap");var s=e("./LookupServiceDelegateBase");var o=e("../../util/shared");var l=o.Promise;var c=r.create(s,{initialize:function($super,e,t){$super(e);this.maxChunkSize=t},lookup:function(e){var t=this;var r=a(e,false,function(e){var r=t.getIdStr(e);return r});var s=n.chunk(r,this.maxChunkSize);var o=s.map(function(e){var r=t.delegate.lookup(e);return r});var c=l.app(o).then(function(){var e=new i;arguments.forEach(function(t){e.putAll(t)});return e});return c}});module.exports=c},{"../../ext/Class":2,"../../util/ArrayUtils":326,"../../util/collection/HashMap":342,"../../util/shared":350,"./LookupServiceDelegateBase":155,"lodash.uniq":582}],154:[function(e,module,t){var r=e("../../ext/Class");var a=e("./LookupServiceBase");var n=e("../../util/collection/HashMap");var i=e("../../util/shared");var s=i.Promise;var o=r.create(a,{initialize:function(e){this.data=e},lookup:function(e){var t=new n;var r=this;e.forEach(function(e){t.put(e,r.data)});var a=s.resolve(t);return a}});module.exports=o},{"../../ext/Class":2,"../../util/collection/HashMap":342,"../../util/shared":350,"./LookupServiceBase":151}],155:[function(e,module,t){var r=e("../../ext/Class");var a=e("./LookupService");var n=r.create(a,{initialize:function(e){this.delegate=e},getIdStr:function(e){var t=this.delegate.getIdStr(e);return t}});module.exports=n},{"../../ext/Class":2,"./LookupService":150}],156:[function(e,module,t){var r=e("../../ext/Class");var a=e("./LookupServiceBase");var n=e("../../util/collection/HashMap");var i=e("../../util/shared");var s=i.Promise;var o=r.create(a,{initialize:function(e){this.fn=e},lookup:s.method(function(e){var t=new n;var r=this;e.forEach(function(e){var a=r.fn(e);if(typeof a!=="undefined"){t.put(e,a)}});return t})});module.exports=o},{"../../ext/Class":2,"../../util/collection/HashMap":342,"../../util/shared":350,"./LookupServiceBase":151}],157:[function(e,module,t){var r=e("../../ext/Class");var a=e("./LookupServiceDelegateBase");var n=r.create(a,{initialize:function($super,e,t){$super(e);this.predicateFn=t},lookup:function(e){var t=e.filter(this.predicateFn);var r=this.delegate.lookup(t);return r}});module.exports=n},{"../../ext/Class":2,"./LookupServiceDelegateBase":155}],158:[function(e,module,t){var r=e("../../ext/Class");var a=e("./LookupService");var n=e("../../util/ObjectUtils");var i=e("../../util/collection/HashMap");var s=e("../../util/shared");var o=s.Promise;var l=r.create(a,{initialize:function(e){this.fnTransformKey=e||n.identity},lookup:function(e){var t=new i;var r=this;e.forEach(function(e){var a=r.fnTransformKey(e);t.put(e,a)});return o.resolve(t)}});module.exports=l},{"../../ext/Class":2,"../../util/ObjectUtils":331,"../../util/collection/HashMap":342,"../../util/shared":350,"./LookupService":150}],159:[function(e,module,t){var r=e("../../ext/Class");var a=e("./LookupServiceBase");var n=e("../../util/collection/HashMap");var i=e("../../util/shared");var s=i.Promise;var o=r.create(a,{initialize:function(e){this.map=e},lookup:s.method(function(e){var t=new n;var r=this;e.forEach(function(e){var a=r.map.get(e);t.put(e,a)});return t})});module.exports=o},{"../../ext/Class":2,"../../util/collection/HashMap":342,"../../util/shared":350,"./LookupServiceBase":151}],160:[function(e,module,t){var r=e("../../ext/Class");var a=e("./LookupService");var n=e("../../util/collection/HashMap");var i=e("../../util/shared");var s=i.Promise;var o=r.create(a,{initialize:function(e){this.attrToLookupService=e},lookup:function(e){var t=this;var r={};var a=Object.keys(this.attrToLookupService);a.forEach(function(a){var n=t.attrToLookupService[a];if(n){r[a]=n.lookup(e)}else{r[a]=null}});var i=s.props(r).then(function(t){var r=new n;e.forEach(function(e){var n={};a.forEach(function(r){var a=t[r];var i=a?a.get(e):null;n[r]=i});r.put(e,n)});return r});return i}});module.exports=o},{"../../ext/Class":2,"../../util/collection/HashMap":342,"../../util/shared":350,"./LookupService":150}],161:[function(e,module,t){var r=e("../../ext/Class");var a=e("../../util/shared");var n=a.Promise;var i=e("../../util/collection/HashMap");var s=e("../../sparql/expr/ExprVar");var o=e("../../sparql/expr/E_OneOf");var l=e("../../sparql/element/ElementFilter");var c=e("../../sparql/element/ElementGroup");var u=e("../ResultSetUtils");var d=e("./LookupServiceBase");var p=r.create(d,{initialize:function(e,t,r){this.sparqlService=e;this.query=t;this.v=r},lookup:function(e){var t=e.some(function(e){var t=e==null;return t});if(t){throw new Error("Lookup requests must not include null values as it most likely indicates a problem")}var r=this.v;var a;if(e.length===0){a=n.resolve(new i)}else{var d=this.query.clone();var p=new l(new o(new s(r),e));var h=new c([d.getQueryPattern(),p]);d.setQueryPattern(h);var v=this.sparqlService.createQueryExecution(d);a=v.execSelect().then(function(e){var t=u.partition(e,r);return t})}return a}});module.exports=p},{"../../ext/Class":2,"../../sparql/element/ElementFilter":231,"../../sparql/element/ElementGroup":232,"../../sparql/expr/E_OneOf":256,"../../sparql/expr/ExprVar":268,"../../util/collection/HashMap":342,"../../util/shared":350,"../ResultSetUtils":125,"./LookupServiceBase":151}],162:[function(e,module,t){var r=e("../../ext/Class");var a=e("./LookupServiceDelegateBase");var n=e("../../util/collection/HashMap");var i=e("../../util/shared");var s=i.Promise;var o=function(){var e;var t;var r=new s(function(){e=arguments[0];t=arguments[1]});return{resolve:e,reject:t,promise:r}};var l=r.create(a,{initialize:function($super,e,t,r){$super(e);this.delayInMs=t;this.maxRefreshCount=r||0;this.idStrToId={};this.currentDeferred=null;this.currentPromise=null;this.currentTimer=null;this.currentRefreshCount=0},getIdStr:function(e){var t=this.delegate.getIdStr(e);return t},lookup:function(e){if(!this.currentDeferred){this.currentDeferred=o();this.currentPromise=this.currentDeferred.promise()}var t=this;e.forEach(function(e){var r=t.getIdStr(e);var a=t.idStrToId[r];if(!a){t.idStrToId[r]=e}});if(!this.currentTimer){this.startTimer()}var r=this.currentPromise.then(function(t){var r=new n;e.forEach(function(e){var a=t.get(e);r.put(e,a)});return r});return r},startTimer:function(){var e=this;var t=this.currentRefreshCount;var r=e.currentDeferred;this.currentTimer=setTimeout(function(){if(e.maxRefreshCount<0||t<e.maxRefreshCount){++e.currentRefreshCount;e.startTimer();return}var a=[];for(var n in e.idStrToId){a.push(e.idStrToId[n])}e.idStrToId={};e.currentRefreshCount=0;e.currentDeferred=null;e.currentTimer=null;e.delegate.lookup(a).then(function(e){r.resolve(e)})},this.delayInMs)}});module.exports=l},{"../../ext/Class":2,"../../util/collection/HashMap":342,"../../util/shared":350,"./LookupServiceDelegateBase":155}],163:[function(e,module,t){var r=e("../../ext/Class");var a=e("./LookupServiceDelegateBase");var n=r.create(a,{initialize:function($super,e,t,r){$super(e);this.fnTransform=t;this.fnNullHandler=r},lookup:function(e){var t=this.fnTransform;var r=this.fnNullHandler;var a=this.delegate.lookup(e).then(function(a){e.forEach(function(e){var n=a.get(e);if(n!=null){var i=t(n,e);a.put(e,i)}else if(r){n=r(e);if(n!=null){a.put(e,n)}}});return a});return a}});module.exports=n},{"../../ext/Class":2,"./LookupServiceDelegateBase":155}],164:[function(e,module,t){var r=e("../../ext/Class");var a=e("./LookupServiceDelegateBase");var n=e("../../util/collection/HashMap");var i=r.create(a,{initialize:function($super,e,t){$super(e);this.fnKey=t},lookup:function(e){var t=this;var r=new n;e.forEach(function(e){var a=t.fnKey(e);r.put(a,e)});var a=r.keys();var i=this.delegate.lookup(a).then(function(e){var t=new n;e.entries().forEach(function(e){var a=r.get(e.key);t.put(a,e.val)});return t});return i}});module.exports=i},{"../../ext/Class":2,"../../util/collection/HashMap":342,"./LookupServiceDelegateBase":155}],165:[function(e,module,t){var r=e("../../ext/Class");var a=e("../../sparql/ExprEvaluatorImpl");var n=e("../../util/collection/IteratorArray");var i=e("../result_set/ResultSetArrayIteratorBinding");var s=e("../../sparql/expr/E_OneOf");var o=e("../../sparql/element/ElementFilter");var l=e("../../util/shared");var c=l.Promise;var u=r.create({initialize:function(e,t,r){this.sparqlService=e;this.query=t;this.indexExpr=r;this.maxChunkSize=50;this.exprEvaluator=new a;this.nodeToBindings={};this.nodeMisses={}},fetchResultSet:function(e){var t=this;var r=this.nodeToBindings;var a=this.analyze(e);var s=[];a.cachedNodes.forEach(function(e){var t=r.getItem(e.toString());s.push.apply(s,t)});var o=a.nonCachedChunks.map(function(e){var r=t.fetchChunk(e);return r});var l=c.all(o);var u=this.exprEvaluator;var d=this.indexExpr;return l.then(function(){var e={};for(var t=0;t<arguments.length;++t){var a=arguments[t];while(a.hasNext()){var o=a.nextBinding();s.push(o);var l=u.eval(d,o);var c=l.toString();e[c]=l;var p=r.getItem(c);if(p==null){p=[];r.setItem(c,p)}p.push(o)}}var h=new n(s);var v=new i(h);return v})},fetchChunk:function(e){var t=this.query.clone();var r=new s(this.indexExpr,e);var a=new o([r]);t.getElements().push(a);var n=this.sparqlService.createQueryExecution(t);var i=n.execSelect();return i},analyze:function(e){var t=this.nodeToBindings;var r=[];var a=[];e.forEach(function(e){var n=t.getItem(e.toString());if(n==null){a.push(e)}else{r.push(e)}});var n=this.maxChunkSize;var i=[];for(var s=0;s<a.length;s+=n){var o=e.slice(s,s+n);i.push(o)}var l={cachedNodes:r,nonCachedNodes:a,nonCachedChunks:i,maxChunkSize:n};return l}});module.exports=u},{"../../ext/Class":2,"../../sparql/ExprEvaluatorImpl":208,"../../sparql/element/ElementFilter":231,"../../sparql/expr/E_OneOf":256,"../../util/collection/IteratorArray":346,"../../util/shared":350,"../result_set/ResultSetArrayIteratorBinding":176}],166:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({createQueryCache:function(){throw new Error("Not overridden")}});module.exports=a},{"../../ext/Class":2}],167:[function(e,module,t){var r=e("../../ext/Class");var a=e("./QueryCacheNodeFactory");var n=e("./QueryCacheBindingHashSingle");var i=r.create(a,{initialize:function(){this.keyToCache={}},createQueryCache:function(e,t,r){var a="cache:/"+e.getServiceId()+"/"+e.getServiceState()+"/"+t+"/"+r;console.log("cache requested with id: "+a);var i=this.keyToCache.getItem(a);if(i==null){i=new n(e,t,r);this.keyToCache.addItem(a,i)}return i}});module.exports=i},{"../../ext/Class":2,"./QueryCacheBindingHashSingle":165,"./QueryCacheNodeFactory":166}],168:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({execSelect:function(){throw new Error("Not overridden")},execAsk:function(){throw new Error("Not overridden")},execDescribeTriples:function(){throw new Error("Not overridden")},execConstructTriples:function(){throw new Error("Not overridden")},setTimeout:function(){throw new Error("Not overridden")}});module.exports=a},{"../../ext/Class":2}],169:[function(e,module,t){var r=e("../../ext/Class");var a=e("./QueryExecution");var n=e("../../util/collection/IteratorArray");var i=e("../result_set/ResultSetArrayIteratorBinding");var s=e("../../util/shared");var o=s.Promise;var l=r.create(a,{initialize:function(e,t,r){this.queryExecution=e;this.cacheKey=t;this.requestCache=r},createResultSetFromCacheData:function(e){var t=new n(e.bindings);var r=e.varNames;var a=new i(t,r);return a},setTimeout:function(e){this.queryExecution.setTimeout(e)},execSelect:function(){var e=this.cacheKey;var t=this.requestCache;var r=t.getResultCache();var a=t.getExecutionCache();var n=a[e];if(!n){var i=r.getItem(e);if(i){n=o.resolve(i)}else{var s=this.queryExecution.execSelect();var l=s.then(function(e){var t={bindings:e.getBindings(),varNames:e.getVarNames()};return t});var c=false;n=l.then(function(t){c=true;delete a[e];r.setItem(e,t);return t});if(!c){a[e]=n}}}else{console.log("[INFO] Joined query execution for: "+e)}var u=this;var d=n.then(function(e){var t=u.createResultSetFromCacheData(e);return t});return d}});module.exports=l},{"../../ext/Class":2,"../../util/collection/IteratorArray":346,"../../util/shared":350,"../result_set/ResultSetArrayIteratorBinding":176,"./QueryExecution":168}],170:[function(e,module,t){var r=e("../../ext/Class");var a=e("./QueryExecution");var n=r.create(a,{initialize:function(e,t){this.sparqlService=e;this.query=t;this.timeout=null},setTimeout:function(e){this.timeout=e},createQueryExecution:function(e){var t=this.sparqlService.createQueryExecution(e||this.query);t.setTimeout(this.timeout);return t},execSelect:function(){var e=this.createQueryExecution().execSelect(this.query);return e},execAsk:function(){var e=this.createQueryExecution().execAsk(this.query);return e}});module.exports=n},{"../../ext/Class":2,"./QueryExecution":168}],171:[function(e,module,t){var r=e("../../ext/Class");var a=e("./QueryExecution");var n=e("../QueryPaginator");var i=e("../../util/collection/IteratorArray");var s=e("../result_set/ResultSetArrayIteratorBinding");var o=e("../../util/shared");var l=o.Promise;var c=r.create(a,{initialize:function(e){this.sparqlServices=e;this.timeoutInMillis=null},execSelect:function(){var e=this.sparqlServices.createQueryExecution(this.query);e.setTimeout(this.timeoutInMillis);return e},setTimeout:function(e){this.timeoutInMillis=e}});module.exports=c},{"../../ext/Class":2,"../../util/collection/IteratorArray":346,"../../util/shared":350,"../QueryPaginator":122,"../result_set/ResultSetArrayIteratorBinding":176,"./QueryExecution":168}],172:[function(e,module,t){var r=e("../../ext/Class");var a=e("./QueryExecution");var n=e("../ResultSetUtils");var i=e("../AjaxUtils");var s=e("../../util/shared");var o=s.ajax;var l=s.Promise;var c=r.create(a,{initialize:function(e,t,r,a,n){this.queryString=e;this.serviceUri=t;this.defaultGraphUris=r;this.ajaxOptions=a||{};this.httpArgs=n},execSelect:function(){var e=this.execAny().then(function(e){var t;try{t=n.jsonToResultSet(e)}catch(r){console.log("Error processing result set. Response was: ",e);throw r}return t});return e},execAsk:function(){var e=this.execAny().then(function(e){return e.boolean});return e},execConstructTriples:function(){throw new Error("Not implemented yet")},execDescribeTriples:function(){throw new Error("Not implemented yet")},setTimeout:function(e){this.ajaxOptions.timeout=e},getTimeout:function(){return this.ajaxOptions.timeout},execAny:function(){var e=i.createSparqlRequestAjaxSpec(this.serviceUri,this.defaultGraphUris,this.queryString,this.httpArgs,this.ajaxOptions);var t=o(e);return t}});module.exports=c},{"../../ext/Class":2,"../../util/shared":350,"../AjaxUtils":118,"../ResultSetUtils":125,"./QueryExecution":168}],173:[function(e,module,t){var r=e("../../ext/Class");var a=e("./QueryExecutionDelegate");var n=e("../PageExpandUtils");var i=e("../../util/collection/IteratorArray");var s=e("../result_set/ResultSetArrayIteratorBinding");var o=r.create(a,{initialize:function($super,e,t,r){$super(e,t);this.pageSize=r},execSelect:function(){var e=this.query.clone();var t=n.computeRange(e.getLimit(),e.getOffset(),this.pageSize);e.setLimit(t.limit);e.setOffset(t.offset);var r=this.createQueryExecution(e);var a=r.execSelect();var o=a.then(function(e){var r=e.getIterator().getArray();var a=t.subLimit?t.subOffset+t.subLimit:r.length;var n=r.slice(t.subOffset,a);var o=e.getVarNames();var l=new i(n);var c=new s(l,o);return c});return o}});module.exports=o},{"../../ext/Class":2,"../../util/collection/IteratorArray":346,"../PageExpandUtils":121,"../result_set/ResultSetArrayIteratorBinding":176,"./QueryExecutionDelegate":170}],174:[function(e,module,t){var r=e("../../ext/Class");var a=e("./QueryExecution");var n=e("../QueryPaginator");var i=e("../../util/collection/IteratorArray");var s=e("../result_set/ResultSetArrayIteratorBinding");var o=e("../../util/shared");var l=o.Promise;var c=r.create(a,{initialize:function(e,t,r){this.defaultPageSize=1e3;this.sparqlService=e;this.query=t;this.pageSize=r;this.timeoutInMillis=null},executeSelectRec:l.method(function(e,t){var r=e.next();if(!r){return t}var a=this;var n=this.sparqlService.createQueryExecution(r);n.setTimeout(this.timeoutInMillis);var o=n.execSelect().then(function(n){if(!n){throw new Error("Null result set for query: "+r)}var o;if(!t){o=n}else{var l=t.getIterator().getArray();var c=n.getIterator().getArray();var u=l.concat(c);var d=new i(u);o=new s(d)}var p=n.getIterator().getArray().length;var h=e.getPageSize();var v=p===0||p<h;if(!v){o=a.executeSelectRec(e,n)}return o});return o}),execSelect:function(){var e=this.query.clone();var t=this.pageSize||c.defaultPageSize;var r=new n(e,t);return this.executeSelectRec(r,null)},setTimeout:function(e){this.timeoutInMillis=e;if(!c.timeoutMsgShown){console.log("[WARN] Only preliminary timeout implementation for paginated query execution.");c.timeoutMsgShown=true}}});module.exports=c},{"../../ext/Class":2,"../../util/collection/IteratorArray":346,"../../util/shared":350,"../QueryPaginator":122,"../result_set/ResultSetArrayIteratorBinding":176,"./QueryExecution":168}],175:[function(e,module,t){var r=e("../../ext/Class");var a=e("../../util/collection/Iterator");var n=r.create(a,{getVarNames:function(){throw new Error("Override me")}});module.exports=n},{"../../ext/Class":2,"../../util/collection/Iterator":344}],176:[function(e,module,t){var r=e("../../ext/Class");var a=e("./ResultSet");var n=r.create(a,{initialize:function(e,t){this.itBinding=e;this.varNames=t},hasNext:function(){return this.itBinding.hasNext()},next:function(){return this.nextBinding()},nextBinding:function(){return this.itBinding.next()},getVarNames:function(){return this.varNames},getBindings:function(){return this.itBinding.getArray()},getIterator:function(){return this.itBinding}});module.exports=n},{"../../ext/Class":2,"./ResultSet":175}],177:[function(e,module,t){var r=e("../../ext/Class");var a=e("../../util/collection/IteratorAbstract");var n=r.create(a,{initialize:function(e,t,r,a){this.rsA=e;this.serviceB=t;this.elementB=r;this.expr=a;e.getVarsMentioned();a.getVarsMentioned()},$prefetch:function(){}});module.exports=n},{"../../ext/Class":2,"../../util/collection/IteratorAbstract":345}],178:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({getServiceId:function(){throw new Error("[ERROR] Method not overridden")},getStateHash:function(){throw new Error("[ERROR] Method not overridden")},createQueryExecution:function(){throw new Error("[ERROR] Method not overridden")}});module.exports=a},{"../../ext/Class":2}],179:[function(e,module,t){var r=e("../../ext/Class");var a=e("./SparqlService");var n=r.create(a,{createQueryExecution:function(e){var t;if(Object.toString(e)==="[object String]"){t=this.createQueryExecutionStr(e)}else{t=this.createQueryExecutionObj(e)}return t},createQueryExecutionObj:function(e){var t=e.toString();var r=this.createQueryExecutionStr(t);return r},createQueryExecutionStr:function(){throw new Error("Not implemented")}});module.exports=n},{"../../ext/Class":2,"./SparqlService":178}],180:[function(e,module,t){var r=e("../../ext/Class");var a=e("./SparqlService");var n=e("../RequestCache");var i=e("../query_execution/QueryExecutionCache");var s=r.create(a,{initialize:function(e,t){this.sparqlService=e;this.requestCache=t||new n},getServiceId:function(){return this.sparqlService.getServiceId()},getStateHash:function(){return this.sparqlService.getStateHash()},hashCode:function(){return"cached:"+this.sparqlService.hashCode()},createQueryExecution:function(e){var t=this.sparqlService.getServiceId();var r=this.sparqlService.getStateHash();var a=""+e;var n=t+"-"+r+a;var s=this.sparqlService.createQueryExecution(e);var o=new i(s,n,this.requestCache);return o}});module.exports=s},{"../../ext/Class":2,"../RequestCache":123,"../query_execution/QueryExecutionCache":169,"./SparqlService":178}],181:[function(e,module,t){var r=e("../../ext/Class");var a=e("./SparqlService");var n=r.create(a,{initialize:function(e){this.sparqlService=e},getServiceId:function(){return this.sparqlService.getServiceId()},getStateHash:function(){return this.sparqlService.getStateHash()},hashCode:function(){return"console-log:"+this.sparqlService.hashCode()},createQueryExecution:function(e){console.log("SparqlServiceConsoleLog saw query: "+e);var t=this.sparqlService.createQueryExecution(e);return t}});module.exports=n},{"../../ext/Class":2,"./SparqlService":178}],182:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({createSparqlService:function(){throw new Error("Not overridden")}});module.exports=a},{"../../ext/Class":2}],183:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({initialize:function(e){this.sparqlService=e},createSparqlService:function(){var e=this.sparqlService;if(e==null){throw new Error("[ERROR] Creation of a SPARQL service requested, but none was provided")}return e},setSparqlService:function(e){this.sparqlService=e}});module.exports=a},{"../../ext/Class":2}],184:[function(e,module,t){var r=e("../../ext/Class");var a=e("./SparqlServiceHttp");var n=e("./SparqlServiceCache");var i=r.create({initialize:function(){this.hashToCache={}},createSparqlService:function(e,t){var r=new a(e,t);r=new n(r);var i=r.getStateHash();var s=this.hashToCache[i];var o;if(s){o=s}else{this.hashToCache[i]=r;o=r}return o}});module.exports=i},{"../../ext/Class":2,"./SparqlServiceCache":180,"./SparqlServiceHttp":186}],185:[function(e,module,t){var r=e("../../ext/Class");var a=e("./SparqlService");var n=e("../query_execution/QueryExecutionFailover");var i=r.create(a,{initialize:function(e){this.sparqlServices=e},getServiceId:function(){return this.sparqlService.getServiceId()},getStateHash:function(){return this.sparqlService.getStateHash()},hashCode:function(){return"failover:"+this.sparqlService.hashCode()},createQueryExecution:function(e){return new n(this.sparqlServices)}});module.exports=i},{"../../ext/Class":2,"../query_execution/QueryExecutionFailover":171,"./SparqlService":178}],186:[function(e,module,t){var r=e("../../ext/Class");var a=e("lodash.defaults");var n=e("./SparqlServiceBaseString");var i=e("../query_execution/QueryExecutionHttp");var s=e("../../ext/JSONCanonical");var o=r.create(n,{initialize:function(e,t,r,a){this.serviceUri=e;this.defaultGraphUris=t;this.ajaxOptions=r;this.httpArgs=a},getServiceId:function(){return this.serviceUri},getStateHash:function(){var e=s.stringify(this.defaultGraphUris);e+=s.stringify(this.httpArgs);return e},hashCode:function(){return this.getServiceId()+"/"+this.getStateHash()},setDefaultGraphs:function(e){this.defaultGraphUris=e},getDefaultGraphs:function(){return this.defaultGraphUris},createQueryExecutionStr:function(e){var t=a({},this.ajaxOptions);var r=new i(e,this.serviceUri,this.defaultGraphUris,t,this.httpArgs);return r},createQueryExecutionObj:function($super,e){if(true){if(e.flatten){var t=e;e=t.flatten()}}var r=$super(e);return r}});module.exports=o},{"../../ext/Class":2,"../../ext/JSONCanonical":3,"../query_execution/QueryExecutionHttp":172,"./SparqlServiceBaseString":179,"lodash.defaults":357}],187:[function(e,module,t){var r=e("../../ext/Class");var a=e("./SparqlService");var n=r.create(a,{initialize:function(e,t){this.sparqlService=e;this.maxLimit=t},getServiceId:function(){return this.sparqlService.getServiceId()},getStateHash:function(){return this.sparqlService.getStateHash()},hashCode:function(){return"maxLimit:"+this.sparqlService.hashCode()},createQueryExecution:function(e){var t=e.getLimit();if(t==null||t>this.maxLimit){e=e.clone();e.setLimit(this.maxLimit)}var r=this.sparqlService.createQueryExecution(e);return r}});module.exports=n},{"../../ext/Class":2,"./SparqlService":178}],188:[function(e,module,t){var r=e("../../ext/Class");var a=e("../query_execution/QueryExecutionPageExpand");var n=e("./SparqlService");var i=r.create(n,{initialize:function(e,t){this.sparqlService=e;this.pageSize=t},getServiceId:function(){return this.sparqlService.getServiceId()},getStateHash:function(){return this.sparqlService.getStateHash()},hashCode:function(){return"page-expand:"+this.sparqlService.hashCode()},createQueryExecution:function(e){var t=new a(this.sparqlService,e,this.pageSize);return t}});module.exports=i},{"../../ext/Class":2,"../query_execution/QueryExecutionPageExpand":173,"./SparqlService":178}],189:[function(e,module,t){var r=e("../../ext/Class");var a=e("./SparqlService");var n=e("../query_execution/QueryExecutionPaginate");var i=r.create(a,{initialize:function(e,t){this.defaultPageSize=1e3;this.sparqlService=e;this.pageSize=t},getServiceId:function(){return this.sparqlService.getServiceId()},getStateHash:function(){return this.sparqlService.getStateHash()},hashCode:function(){return"paginate:"+this.sparqlService.hashCode()},createQueryExecution:function(e){var t=new n(this.sparqlService,e,this.pageSize);return t}});module.exports=i},{"../../ext/Class":2,"../query_execution/QueryExecutionPaginate":174,"./SparqlService":178}],190:[function(e,module,t){var r=e("../../ext/Class");var a=e("./SparqlService");var n=e("../../sparql/element/ElementGroup");var i=r.create({initialize:function(e){},createQueryExecution:function(e){},applyTransform:function(e){var t=e.getQueryPattern();if(t instanceof n){var r=t.getArgs();var a=[];var i=[];r.forEach(function(){})}}});module.exports=i},{"../../ext/Class":2,"../../sparql/element/ElementGroup":232,"./SparqlService":178}],191:[function(e,module,t){var r=e("../../ext/Class");var a=e("./SparqlService");var n=e("../../sparql/expr/ExprAggregator");var i=e("../../sparql/Query");var s=e("../../sparql/element/ElementSubQuery");var o=r.create(a,{initialize:function(e){this.sparqlService=e},getServiceId:function(){return this.sparqlService.getServiceId()},getStateHash:function(){return this.sparqlService.getStateHash()},hashCode:function(){return"virtfix:"+this.sparqlService.hashCode()},createQueryExecution:function(e){var t=e.getOrderBy();var r=e.getLimit();var a=e.getOffset();var n=a!=null&&r==null;var o=e.getAggregators().length>0;var l=t.length>0&&(r||a)||o;var c=n||l;var u=c?e.clone():e;if(n){r=2e9;u.setLimit(r)}if(l){var d=u;d.setLimit(null);d.setOffset(null);var p=new s(d);u=new i;u.setQueryPattern(p);u.setLimit(r);u.setOffset(a);u.setQueryResultStar(true)}var h=this.sparqlService.createQueryExecution(u);return h}});module.exports=o},{"../../ext/Class":2,"../../sparql/Query":217,"../../sparql/element/ElementSubQuery":235,"../../sparql/expr/ExprAggregator":260,"./SparqlService":178}],192:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({fetchSchema:function(){throw new Error("Override me")},fetchCount:function(e){throw new Error("Override me")},fetchData:function(e,t){throw new Error("Override me")}});module.exports=a},{"../../ext/Class":2}],193:[function(e,module,t){var r=e("../../ext/Class");var a=e("./TableService");var n=r.create(a,{initialize:function(e){this.delegate=e},fetchSchema:function(){var e=this.delegate.fetchSchema();
return e},fetchCount:function(){var e=this.delegate.fetchCount();return e},fetchData:function(){var e=this.delegate.fetchData();return e}});module.exports=n},{"../../ext/Class":2,"./TableService":192}],194:[function(e,module,t){var r=e("../../ext/Class");var a=e("./TableServiceNodeLabels");var n=e("../TableServiceUtils");var i=r.create(a,{initialize:function($super,e,t,r,a){$super(e,r);this.tableConfigFacet=t;this.lookupServicePathLabels=a},fetchSchema:function(){var e=n.fetchSchemaTableConfigFacet(this.tableConfigFacet,this.lookupServicePathLabels);return e}});module.exports=i},{"../../ext/Class":2,"../TableServiceUtils":128,"./TableServiceNodeLabels":196}],195:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({initialize:function(e){this.listService=e},fetchCount:function(e,t){this.listService.fetchCount(null,e,t)},fetchData:function(){}});module.exports=a},{"../../ext/Class":2}],196:[function(e,module,t){var r=e("../../ext/Class");var a=e("./TableServiceDelegateBase");var n=e("../TableServiceUtils");var i=r.create(a,{initialize:function($super,e,t){$super(e);this.lookupServiceNodeLabels=t},fetchData:function(e,t){var r=this.delegate.fetchData(e,t);var a=this;var i=r.then(function(e){var t=n.transformToNodeLabels(a.lookupServiceNodeLabels,e);return t});return i}});module.exports=i},{"../../ext/Class":2,"../TableServiceUtils":128,"./TableServiceDelegateBase":193}],197:[function(e,module,t){var r=e("../../ext/Class");var a=e("./TableService");var n=e("../TableServiceUtils");var i=e("../../util/shared");var s=i.Promise;var o=r.create(a,{initialize:function(e,t,r,a){this.sparqlService=e;this.query=t;this.timeoutInMillis=r||3e3;this.secondaryCountLimit=a||1e3},fetchSchema:function(){var e={colDefs:n.createNgGridOptionsFromQuery(this.query)};return new s(function(t){t(e)})},fetchCount:function(){var e=n.fetchCount(this.sparqlService,this.query,this.timeoutInMillis,this.secondaryCountLimit);return e},fetchData:function(e,t){var r=n.fetchData(this.sparqlService,this.query,e,t);return r}});module.exports=o},{"../../ext/Class":2,"../../util/shared":350,"../TableServiceUtils":128,"./TableService":192}],198:[function(e,module,t){var r=e("../ext/Class");var a=e("../vocab/rdfs");var n=e("./VarUtils");var i=r.create({initialize:function(e,t,r,i,s){this.langs=e||["en",""];this.predicates=t||[a.label];this.subjectVar=i||n.x;this.predicateVar=s||n.y;this.objectVar=r||n.z},getLangs:function(){return this.langs},getPredicates:function(){return this.predicates},getSubjectVar:function(){return this.subjectVar},getPredicateVar:function(){return this.predicateVar},getObjectVar:function(){return this.objectVar},toString:function(){var e=["BestLabelConfig",this.langs,this.predicates,this.subjectVar,this.predicateVar,this.objectVar].join(", ");return e}});module.exports=i},{"../ext/Class":2,"../vocab/rdfs":354,"./VarUtils":226}],199:[function(e,module,t){var r=e("../rdf/NodeFactory");var a=e("../rdf/node/Var");var n=function(e){this.varNameToEntry=e?e:{}};n.create=function(e){var t={};for(var a in e){var i=e[a];t[a]={v:r.createVar(a),node:i}}var s=new n(t);return s};n.fromTalisJson=function(e){var t={};for(var a in e){var i=e[a];var s=r.createFromTalisRdfJson(i);t[a]=s}var o=n.create(t);return o};n.prototype={put:function(e,t){this.varNameToEntry[e.getName()]={v:e,node:t}},get:function(e){if(!(e instanceof a)){throw new Error("var not an instance of Var")}var t=e.getName();var r=this.varNameToEntry[t];var n=r?r.node:null;return n},entries:function(){var e=[];for(var t in this.varNameToEntry){var r=this.varNameToEntry[t];e.push(r)}var a=e.sort(function(e,t){return e.v.getName()>t.v.getName()?1:-1});return a},toString:function(){var e=this.entries();var t=e.map(function(e){return'"'+e.v.getName()+'": "'+e.node+'"'});var r="{"+t.join(", ")+"}";return r},getVars:function(){var e=[];for(var t in this.varNameToEntry){var r=this.varNameToEntry[t];e.push(r.v)}return e}};module.exports=n},{"../rdf/NodeFactory":92,"../rdf/node/Var":111}],200:[function(e,module,t){var r=e("../vocab/xsd");var a=e("../rdf/NodeFactory");var n=e("./Binding");var i={cloneBinding:function(e){var t=new n;var r=e.entries();r.forEach(function(e){t.put(e.v,e.node)});return t},cloneBindings:function(e){var t=e.map(function(e){var t=i.cloneBinding(e);return t});return t},addRowIds:function(e,t,n){n=n||0;e.forEach(function(e,i){var s=n+i;var o=a.createTypedLiteralFromString(""+s,r.xinteger);e.put(t,o)});return e}};module.exports=i},{"../rdf/NodeFactory":92,"../vocab/xsd":356,"./Binding":199}],201:[function(e,module,t){var r=e("../vocab/rdf");var a=e("../vocab/owl");var n=e("../rdf/Triple");var i=e("../sparql/element/ElementTriplesBlock");var s=e("../sparql/element/ElementFilter");var o=e("../sparql/element/ElementGroup");var l=e("../sparql/expr/E_LogicalOr");var c=e("../sparql/expr/E_Equals");var u=e("../sparql/expr/ExprVar");var d=e("../sparql/Concept");var p=e("../sparql/NodeValueUtils");var h=e("../sparql/VarUtils");var v={createConceptDeclaredProperties:function(e,t){e=e||h.s;t=t||h.o;var v=new u(t);var f=p.makeNode(r.Property);var g=p.makeNode(a.DatatypeProperty);var m=p.makeNode(a.ObjectProperty);var x=p.makeNode(a.AnnotationProperty);var _=new d(new o([new i([new n(e,r.type,t)]),new s(new l(new c(v,f),new l(new c(v,g),new l(new c(v,m),new c(v,x)))))]),e);return _}};module.exports=v},{"../rdf/Triple":95,"../sparql/Concept":202,"../sparql/NodeValueUtils":215,"../sparql/VarUtils":226,"../sparql/element/ElementFilter":231,"../sparql/element/ElementGroup":232,"../sparql/element/ElementTriplesBlock":236,"../sparql/expr/E_Equals":245,"../sparql/expr/E_LogicalOr":254,"../sparql/expr/ExprVar":268,"../vocab/owl":352,"../vocab/rdf":353}],202:[function(e,module,t){var r=e("../ext/Class");var a=e("./ElementUtils");var n=e("./element/ElementGroup");var i=e("./element/ElementTriplesBlock");var s=r.create({classLabel:"jassa.sparql.Concept",initialize:function(e,t){this.element=e;this.variable=t},toJson:function(){var e={element:JSON.parse(JSON.stringify(this.element)),variable:this.variable};return e},getElement:function(){return this.element},getVarsMentioned:function(){var e=this.getElement().getVarsMentioned();return e},hasTriples:function(){var e=this.getElements();var t=a.getElementsDirectTriples(e);var r=t.length>0;return r},getElements:function(){var e;if(this.element instanceof n){e=this.element.elements}else{e=[this.element]}return e},getVar:function(){return this.variable},getVariable:function(){if(!this.warningShown){this.warningShown=true}return this.getVar()},toString:function(){return""+this.element+"; "+this.variable},isSubjectConcept:function(){var e=false;var t=this.variable;var r=this.element;if(r instanceof i){var a=r.triples;if(a.length===1){var n=a[0];var s=n.getSubject();var o=n.getPredicate();var l=n.getObject();e=t.equals(s)&&o.isVariable()&&l.isVariable()}}return e},createOptimizedConcept:function(){var e=this.getElement();var t=e.flatten();var r=new s(t,this.variable);return r},getOptimizedElement:function(){return null}});s.createFromElements=function(e,t){var r;if(e.length==1){r=e[0]}else{r=new n(e)}var a=new s(r,t);return a};module.exports=s},{"../ext/Class":2,"./ElementUtils":206,"./element/ElementGroup":232,"./element/ElementTriplesBlock":236}],203:[function(e,module,t){var r=e("../rdf/node/Node");var a=e("../rdf/NodeFactory");var n=e("../rdf/Triple");var i=e("../util/collection/HashMap");var s=e("./../vocab/rdf");var o=e("./VarUtils");var l=e("./ElementUtils");var c=e("./expr/ExprAggregator");var u=e("./agg/AggCount");var d=e("./expr/ExprVar");var p=e("./expr/E_Equals");var h=e("./element/ElementTriplesBlock");var v=e("./element/ElementOptional");var f=e("./element/ElementSubQuery");var g=e("./element/ElementGroup");var m=e("./element/ElementFilter");var x=e("./QueryUtils");var _=e("./NodeValueUtils");var b=e("./Query");var y=e("./Concept");var S={createVarMap:function(e,t){var r=e.getElement();var a=t.getElement();var n=e.getVar();var i=r.getVarsMentioned();var s=a.getVarsMentioned();var o=[e.getVar()];var c=[t.getVar()];var u=l.createJoinVarMap(i,s,o,c);return u},createRenamedConcept:function(e,t){var r=this.createVarMap(e,t);var a=e.getVar();var n=t.getElement();var i=l.createRenamedElement(n,r);var s=new y(i,a);return s},renameVars:function(e,t){var r=o.fnSubst(t);var a=r(e.getVar());var n=e.getElement().copySubstitute(r);var i=new y(n,a);return i},createCombinedConcept:function(e,t,r,a,n){var s=e.getVar();var o=t.getVar();if(!o.equals(s)){var l=new i;l.put(o,s);t=this.renameVars(t,l)}var c;if(r){c=this.createRenamedConcept(e,t)}else{c=t}var u=c.getElements();var d=e.getElement();var p;if(u.length>0){if(c.isSubjectConcept()){p=e.getElement()}else{var h=[];if(a){d=new v(e.getElement())}h.push(d);if(n){u=[new f(c.asQuery())]}h.push.apply(h,u);p=new g(h);p=p.flatten()}}else{p=d}var m=new y(p,s);return m},createSubjectConcept:function(e,t,r){e=e||o.s;t=t||o._p_;r=r||o._o_;var a=new h([new n(e,t,r)]);var i=new y(a,e);return i},createTypeConcept:function(e,t){var i=e instanceof r?e:a.createUri(e);var o=!t?a.createVar("s"):t instanceof r?t:a.createVar(t);var l=new y(new h([new n(o,s.type,i)]),o);return l},createQueryList:function(e,t,r){var a=new b;a.setDistinct(true);a.setLimit(t);a.setOffset(r);a.getProject().add(e.getVar());a.setQueryPattern(e.getElement());return a},freshVar:function(e,t){t=t||"c";var r=e.getVarsMentioned();var a=o.createVarGen(t,r);var n=a.next();return n},wrapAsSubQuery:function(e,t){var r=new f(e);var a=new b;a.setQuerySelectType();a.getProject().add(t);a.setQueryPattern(r);return a},createQueryCount:function(e,t,r,a){var n=this.createQueryList(e);if(a!=null){n.setDistinct(false);n.setLimit(a);n=this.wrapAsSubQuery(n,e.getVar());n.setDistinct(true)}if(r!=null){n.setLimit(r)}var i=new f(n);var s=new b;s.setQuerySelectType();s.getProject().add(t,new c(null,new u));s.setQueryPattern(i);return s},createQueryRawSize:function(e,t,r,a){var n=e.getVar();var i=e.getElement();var s=new d(n);var o=_.makeNode(t);var l=new m(new p(s,o));var h=new g([i,l]).flatten();if(a!=null){var v=new b;v.setQuerySelectType();v.getProject().add(n);v.setQueryPattern(h);v.setLimit(a);h=new f(v)}var x=new b;x.setQuerySelectType();x.getProject().add(n);x.getProject().add(r,new c(null,new u));x.setQueryPattern(h);x.getGroupBy().push(s);return x},isGroupedOnlyByVar:function(e,t){var r=false;var a=e.getGroupBy().length===1;if(a){var n=e.getGroupBy()[0];if(n instanceof d){var i=n.asVar();r=i.equals(t)}}return r},isDistinctConceptVar:function(e,t){var r=e.isDistinct();var a=e.getProjectVars();var n=!e.isQueryResultStar()&&a&&a.length===1;var i=r&&n&&a[0].equals(t);return i},isConceptQuery:function(e,t){var r=this.isGroupedOnlyByVar(e,t);var a=this.isDistinctConceptVar(e,t);var n=r||a;return n},createAttrQuery:function(e,t,r,a,n,i){var s=new y(new f(e),t);var o=S.createRenamedConcept(s,a);var l=this.isConceptQuery(e,t);var c;if(l){c=e.clone();if(!o.isSubjectConcept()){var u=new g([e.getQueryPattern(),o.getElement()]);u=u.flatten();c.setQueryPattern(u)}c.setLimit(n);c.setOffset(i)}else{var d=n!=null||i!=null;var p;if(d){var h;if(r){h=o}else{var m;if(o.isSubjectConcept()){m=e.getQueryPattern()}else{m=new g([e.getQueryPattern(),o.getElement()])}h=new y(m,t)}var x=S.createQueryList(h,n,i);p=new f(x)}else{p=o.getElement()}var _=e.clone();var b=_.getQueryPattern();var C;if(!d&&(!a||a.isSubjectConcept())){C=b}else{if(r){C=new g([p,new v(b)])}else{C=new g([b,p])}}_.setQueryPattern(C);c=_}return c}};module.exports=S},{"../rdf/NodeFactory":92,"../rdf/Triple":95,"../rdf/node/Node":104,"../util/collection/HashMap":342,"./../vocab/rdf":353,"./Concept":202,"./ElementUtils":206,"./NodeValueUtils":215,"./Query":217,"./QueryUtils":219,"./VarUtils":226,"./agg/AggCount":227,"./element/ElementFilter":231,"./element/ElementGroup":232,"./element/ElementOptional":233,"./element/ElementSubQuery":235,"./element/ElementTriplesBlock":236,"./expr/E_Equals":245,"./expr/ExprAggregator":260,"./expr/ExprVar":268}],204:[function(e,module,t){},{}],205:[function(e,module,t){var r={joinElements:function(e,t){var r=t.map(function(e){return e.toString()});var a=r.filter(function(e){return e.length!==0});return a.join(e)}};module.exports=r},{}],206:[function(e,module,t){var r=e("lodash.uniq");var a=e("./element/ElementTriplesBlock");var n=e("./element/ElementFilter");var i=e("./element/ElementGroup");var s=e("./element/ElementSubQuery");var o=e("./../rdf/TripleUtils");var l=e("./VarUtils");var c=e("./GenSym");var u=e("./GeneratorBlacklist");var d=e("../util/collection/HashBidiMap");var p=e("../rdf/NodeFactory");var h=e("./Query");var v=e("./expr/ExprAggregator");var f=e("./agg/AggCount");var g={createQueryCountRows:function(e,t,r){var a;if(r==null){a=e}else{var n=new h;n.setQuerySelectType();n.setQueryPattern(e);n.setQueryResultStar(true);n.setLimit(r);a=new s(e)}var i=new h;i.setQuerySelectType();i.setQueryPattern(a);i.getProject().add(t,new v(null,new f));return i},createFilterElements:function(e){var t=e.map(function(e){var t=new n(e);return t});return t},createElementsTriplesBlock:function(e){var t=[];if(e.length>0){var r=new a(e);t.push(r)}return t},createDistinctVarMap:function(e,t,r){var a=e.map(l.getVarName);if(r==null){var n=new c("v");r=new u(n,a)}var i=new d;t.forEach(function(e){var t=e.getName();var n;if(a.indexOf(t)!==-1){var s=r.next();n=p.createVar(s)}else{n=e}i.put(e,n)});return i},createJoinVarMap:function(e,t,r,a,n){if(r.length!==a.length){console.log("[ERROR] Cannot join on different number of columns");throw"Bailing out"}var i=g.createDistinctVarMap(e,t,n);for(var s=0;s<r.length;++s){var o=r[s];var l=a[s];i.put(l,o)}return i},createRenamedElement:function(e,t){var r=l.fnSubst(t);var a=e.copySubstitute(r);return a},getElementsDirectTriples:function(e){var t=[];for(var r=0;r<e.length;++r){var n=e[r];if(n instanceof a){t.push.apply(t,n.triples)}}return t},freshVar:function(e,t){var r=this.freshVarGen(e,t);var a=r.next();console.log("freshVar: "+a);return a},freshVarGen:function(e,t){t=t||"v";var r=e.getVarsMentioned();var a=l.freshVarGen(t,r);return a}};module.exports=g},{"../rdf/NodeFactory":92,"../util/collection/HashBidiMap":341,"./../rdf/TripleUtils":96,"./GenSym":211,"./GeneratorBlacklist":213,"./Query":217,"./VarUtils":226,"./agg/AggCount":227,"./element/ElementFilter":231,"./element/ElementGroup":232,"./element/ElementSubQuery":235,"./element/ElementTriplesBlock":236,"./expr/ExprAggregator":260,"lodash.uniq":582}],207:[function(e,module,t){var r=e("../ext/Class");var a=r.create({eval:function(){throw new Error("Not overridden")}});module.exports=a},{"../ext/Class":2}],208:[function(e,module,t){var r=e("../ext/Class");var a=e("./expr/NodeValue");var n=e("./NodeValueUtils");var i=e("./ExprEvaluator");var s=r.create(i,{eval:function(e,t){var r;var a;if(e.isVar()){a=e.getExprVar();r=this.evalExprVar(a,t)}else if(e.isFunction()){a=e.getFunction();r=this.evalExprFunction(a,t)}else if(e.isConstant()){a=e.getConstant();r=this.evalConstant(a,t)}else{throw new Error("Unsupported expr type")}return r},evalExprVar:function(e,t){var r=e.asVar();var i=t.get(r);var s;if(i==null){return a.nvNothing}else{s=n.makeNode(i)}return s},evalExprFunction:function(){},evalNodeValue:function(){}});module.exports=s},{"../ext/Class":2,"./ExprEvaluator":207,"./NodeValueUtils":215,"./expr/NodeValue":269}],209:[function(e,module,t){var r={newBinaryExpr:function(e,t){if(t.length!==2){throw new Error("Invalid argument")}var r=t[0];var a=t[1];var n=new e(r,a);return n},newUnaryExpr:function(e,t){if(t.length!==1){throw new Error("Invalid argument")}var r=t[0];var a=new e(r);return a},joinElements:function(e,t){var r=t.map(function(e){return e.toString()});var a=r.filter(function(e){return e.length!==0});return a.join(e)}};module.exports=r},{}],210:[function(e,module,t){var r=e("./expr/ExprVar");var a=e("./expr/NodeValue");var n=e("./NodeValueUtils");var i=e("./expr/E_Equals");var s=e("./expr/E_LogicalAnd");var o=e("./expr/E_LogicalOr");var l={copySubstitute:function(e,t){var r=function(e){var r=null;if(e.isVar()){var a=t.get(e);if(a!=null){r=a}}if(r==null){r=e}return r};var a=e.copySubstitute(r);return a},bindingToExprs:function(e,t){if(t==null){t=e.getVars()}var a=[];t.forEach(function(t){var s=new r(t);var o=e.get(t);var l=n.makeNode(o);var c=new i(s,l);a.push(c)});return a},opify:function(e,t){var r=e;var a=[];while(r.length>1){for(var n=0;n<r.length;n+=2){var i=r[n];if(n+1===r.length){a.push(i);break}var s=r[n+1];var o=t(i,s);a.push(o)}r=a;a=[]}return r[0]},andify:function(e){var t=this.opify(e,function(e,t){return new s(e,t)});return t},orify:function(e){var t=this.opify(e,function(e,t){return new o(e,t)});return t}};module.exports=l},{"./NodeValueUtils":215,"./expr/E_Equals":245,"./expr/E_LogicalAnd":252,"./expr/E_LogicalOr":254,"./expr/ExprVar":268,"./expr/NodeValue":269}],211:[function(e,module,t){var r=e("../ext/Class");var a=e("./Generator");var n=r.create(a,{initialize:function(e,t){this.prefix=e?e:"v";this.nextValue=t?t:0},next:function(){++this.nextValue;var e=this.prefix+"_"+this.nextValue;return e}});n.create=function(e){var t=new n(e,0);return t};module.exports=n},{"../ext/Class":2,"./Generator":212}],212:[function(e,module,t){var r=e("../ext/Class");var a=r.create({next:function(){throw new Error("Override me")}});module.exports=a},{"../ext/Class":2}],213:[function(e,module,t){var r=e("../ext/Class");var a=e("./Generator");var n=r.create(a,{initialize:function(e,t){this.generator=e;this.blacklist=t},next:function(){var e;do{e=this.generator.next()}while(this.blacklist.indexOf(e)!==-1);return e}});module.exports=n},{"../ext/Class":2,"./Generator":212}],214:[function(e,module,t){var r=e("../rdf/Triple");var a=e("../rdf/NodeFactory");var n=e("./NodeValueUtils");var i=e("./expr/ExprVar");var s=e("./expr/E_OneOf");var o=e("./expr/E_LangMatches");var l=e("./expr/E_LogicalOr");var c=e("./expr/E_Lang");var u=e("./expr/E_Bound");var d=e("./expr/E_Regex");var p=e("./expr/E_Str");var h=e("./ExprUtils");var v=e("./Concept");var f=e("./Relation");var g=e("./ConceptUtils");var m=e("./element/ElementTriplesBlock");var x=e("./element/ElementGroup");var _=e("./element/ElementOptional");var b=e("./element/ElementFilter");var y=e("./VarUtils");var S={createRelationPrefLabels:function(e){var t=e.getLangs();var a=e.getPredicates();var l=e.getSubjectVar();var u=e.getPredicateVar();var d=e.getObjectVar();var p=new i(l);var v=new i(u);var g=new i(d);var _=t.map(function(e){var t=new o(new c(g),n.makeString(e));return t});var y=h.orify(_);var S=new s(v,a);var C=[];C.push(new m([new r(l,u,d)]));C.push(new b(S));C.push(new b(y));var E=new x(C);var w=new f(E,l,d);return w}};module.exports=S},{"../rdf/NodeFactory":92,"../rdf/Triple":95,"./Concept":202,"./ConceptUtils":203,"./ExprUtils":210,"./NodeValueUtils":215,"./Relation":220,"./VarUtils":226,"./element/ElementFilter":231,"./element/ElementGroup":232,"./element/ElementOptional":233,"./element/ElementTriplesBlock":236,"./expr/E_Bound":243,"./expr/E_Lang":248,"./expr/E_LangMatches":249,"./expr/E_LogicalOr":254,"./expr/E_OneOf":256,"./expr/E_Regex":257,"./expr/E_Str":258,"./expr/ExprVar":268}],215:[function(e,module,t){var r=e("../rdf/NodeFactory");var a=e("./expr/NodeValue");var n=e("./expr/NodeValueNode");var i=e("../rdf/AnonIdStr");var s=e("../vocab/xsd");var o={nvNothing:new a(r.createAnon(new i("node value nothing"))),createLiteral:function(e,t){var a=r.createTypedLiteralFromValue(e,t);var i=new n(a);return i},makeString:function(e){return o.createLiteral(e,s.xstring.getUri())},makeInteger:function(e){return o.createLiteral(e,s.xint.getUri())},makeDecimal:function(e){return o.createLiteral(e,s.decimal.getUri())},makeFloat:function(e){return o.createLiteral(e,s.xfloat.getUri())},makeNode:function(e){var t=new n(e);return t}};module.exports=o},{"../rdf/AnonIdStr":90,"../rdf/NodeFactory":92,"../vocab/xsd":356,"./expr/NodeValue":269,"./expr/NodeValueNode":270}],216:[function(e,module,t){var r=e("lodash.union");var a=function(e){return typeof e==="function"};var n={getVarsMentioned:function(e){var t=e.reduce(function(e,t){var n=t.getVarsMentioned;if(!n||!a(n)){console.log("[ERROR] .getVarsMentioned not found on object ",t)}var i=t.getVarsMentioned();var s=r(e,i);return s},[]);return t}};module.exports=n},{"lodash.union":559}],217:[function(e,module,t){var r=e("../ext/Class");var a=e("lodash.union");var n=e("../util/ObjectUtils");var i=e("./VarExprList");var s=e("../util/ArrayUtils");var o=e("./ElementHelpers");var l=e("./ElementUtils");var c=e("./QueryType");var u=e("./expr/ExprAggregator");var d=r.create({classLabel:"jassa.sparql.Query",initialize:function(){this.type=0;this.distinct=false;this.reduced=false;this.queryResultStar=false;this.projectVars=new i;this.groupBy=[];this.orderBy=[];this.queryPattern=null;this.constructTemplate=null;this.limit=null;this.offset=null},getAggregators:function(){var e=this.getProject().entries();var t=[];e.forEach(function(e){var r=e.expr;if(r instanceof u){var a=r.getAggregator();t.push(a)}});return t},setQuerySelectType:function(){this.type=0},isQueryResultStar:function(){return this.queryResultStar},setQueryResultStar:function(e){this.queryResultStar=e},getQueryPattern:function(){return this.queryPattern},setQueryPattern:function(e){this.queryPattern=e},getProjectVars:function(){var e=this.projectVars?this.projectVars.getVars():null;return e},setProjectVars:function(e){this.projectVars=e},getProject:function(){return this.projectVars},getGroupBy:function(){return this.groupBy},getOrderBy:function(){return this.orderBy},getLimit:function(){return this.limit},getOffset:function(){return this.offset},toStringOrderBy:function(){var e=this.orderBy&&this.orderBy.length>0?"Order By "+this.orderBy.join(" ")+" ":"";return e},toStringGroupBy:function(){var e=this.groupBy&&this.groupBy.length>0?"Group By "+this.groupBy.join(" ")+" ":"";return e},clone:function(){return this.copySubstitute(n.identity)},flatten:function(){var e=this.clone();e.queryPattern=this.queryPattern?this.queryPattern.flatten():null;return e},getVarsMentioned:function(){if(!d.warnGetVarsMentioned){console.log("[WARN] sparql.Query.getVarsMentioned(): Not implemented properly yet. Things may break!");d.warnGetVarsMentioned=true}var e=this.queryPattern.getVarsMentioned();return e},copySubstitute:function(e){var t=new d;t.type=this.type;t.distinct=this.distinct;t.reduced=this.reduced;t.queryResultStar=this.queryResultStar;t.limit=this.limit;t.offset=this.offset;t.projectVars=this.projectVars.copySubstitute(e);if(this.constructTemplate){t.constructTemplate=this.constructTemplate.copySubstitute(e)}t.orderBy=this.orderBy==null?null:this.orderBy.map(function(t){return t.copySubstitute(e)});t.groupBy=this.groupBy==null?null:this.groupBy.map(function(t){return t.copySubstitute(e)});t.queryPattern=this.queryPattern.copySubstitute(e);return t},setOptions:function(e){if(typeof e==="undefined"){return}if(typeof e.limit!=="undefined"){this.setLimit(e.limit)}if(typeof e.offset!=="undefined"){this.setOffset(e.offset)}if(typeof e.distinct!=="undefined"){this.setDistinct(e.distinct)}},setOffset:function(e){this.offset=e?e:null},setLimit:function(e){if(e===0){this.limit=0}else{this.limit=e?e:null}},isDistinct:function(){return this.distinct},setDistinct:function(e){this.distinct=e===true},isReduced:function(){return this.reduced},setReduced:function(e){this.reduced=e===true},toString:function(){switch(this.type){case c.Select:return this.toStringSelect();case c.Construct:return this.toStringConstruct()}},toStringProjection:function(){var e=this.queryResultStar?"*":this.projectVars.toString();return e},toStringLimitOffset:function(){var e="";if(this.limit!=null){e+=" Limit "+this.limit}if(this.offset!=null){e+=" Offset "+this.offset}return e},toStringSelect:function(){var e=this.distinct?"Distinct ":"";var t="Select "+e+this.toStringProjection()+" {"+this.queryPattern+"} "+this.toStringGroupBy()+this.toStringOrderBy()+this.toStringLimitOffset();return t},toStringConstruct:function(){var e="Construct "+this.constructTemplate+" {"+this.queryPattern+"}"+this.toStringOrderBy()+this.toStringLimitOffset();return e}});module.exports=d},{"../ext/Class":2,"../util/ArrayUtils":326,"../util/ObjectUtils":331,"./ElementHelpers":205,"./ElementUtils":206,"./QueryType":218,"./VarExprList":224,"./expr/ExprAggregator":260,"lodash.union":559}],218:[function(e,module,t){var r={};r.Unknown=-1;r.Select=0;r.Construct=1;r.Ask=2;r.Describe=3;module.exports=r},{}],219:[function(e,module,t){var r=e("./expr/ExprVar");var a=e("./expr/ExprAggregator");var n=e("./agg/AggCount");var i=e("./element/ElementGroup");var s=e("./element/ElementUnion");var o=e("./element/ElementSubQuery");var l=e("./Query");var c={createQueryCount:function(e,t,s,c,u,d,p){var h=e.length===1?e[0]:new i(e);var v=s?new r(s):null;var f;var g=t||d||u&&u.length>0;if(g){var m=new l;m.setQueryPattern(h);if(u){for(var x=0;x<u.length;++x){var _=u[x];m.getProject().add(_)}}if(s){m.getProject().add(s)}if(m.getProjectVars().length===0){m.setQueryResultStar(true)}m.setDistinct(d);m.setLimit(t);f=new o(m)}else{f=new i(e)}var b=new l;b.setQueryPattern(f);if(u){u.forEach(function(e){b.getProject().add(e);b.getGroupBy().push(new r(e))})}b.getProject().add(c,new a(null,new n));return b},createQueryUnionSubQueries:function(e,t){var r;if(e.length===0){r=null}else{if(e.length===1){r=e[0]}else{t=t||e[0].getProjectVars();var a=e.map(function(e){var t=new o(e);return t});var n=new s(a);r=new l;r.setQuerySelectType();t.forEach(function(e){r.getProject().add(e)});r.setQueryPattern(n)}}return r}};module.exports=c},{"./Query":217,"./agg/AggCount":227,"./element/ElementGroup":232,"./element/ElementSubQuery":235,"./element/ElementUnion":237,"./expr/ExprAggregator":260,"./expr/ExprVar":268}],220:[function(e,module,t){var r=e("../ext/Class");var a=r.create({initialize:function(e,t,r){this.element=e;this.sourceVar=t;this.targetVar=r},getElement:function(){return this.element},getSourceVar:function(){return this.sourceVar},getTargetVar:function(){return this.targetVar},toString:function(){var e="("+[this.element,this.sourceVar,this.targetVar].join("; ")+")";return e}});module.exports=a},{"../ext/Class":2}],221:[function(e,module,t){var r=e("./Relation");var a=e("./Query");var n=e("./expr/ExprVar");var i=e("./expr/ExprAggregator");var s=e("./element/ElementSubQuery");var o=e("./agg/AggCountVarDistinct");var l=e("./Concept");var c=e("./ConceptUtils");var u={createQueryDistinctValueCount:function(e,t){var r=new a;var s=r.getProject();s.add(e.getSourceVar());s.add(t,new i(null,new o(new n(e.getTargetVar()))));r.setQueryPattern(e.getElement());r.getGroupBy().push(new n(e.getSourceVar()));return r},createQueryRawSize:function(e,t,r,a){var n=new l(e.getElement(),e.getSourceVar());var i=c.createQueryRawSize(n,t,r,a);return i},createQueryValueCount:function(e,t,r,s){var l=this.createRelationWithLimit(e,s);var c=new a;var u=c.getProject();u.add(e.getSourceVar());u.add(r,new i(null,new o(new n(e.getTargetVar()))));c.setQueryPattern(e.getElement());c.getGroupBy().push(new n(e.getSourceVar()))},createRelationDistinctValueCount:function(e,t){var a=this.createQueryDistinctValueCount(e,t);var n=new s(a);var i=new r(n,e.getSourceVar(),t);return i}};module.exports=u},{"./Concept":202,"./ConceptUtils":203,"./Query":217,"./Relation":220,"./agg/AggCountVarDistinct":228,"./element/ElementSubQuery":235,"./expr/ExprAggregator":260,"./expr/ExprVar":268}],222:[function(e,module,t){var r=e("../ext/Class");var a=r.create({classLabel:"jassa.sparql.SortCondition",initialize:function(e,t){this.expr=e;this.direction=t},getExpr:function(){return this.expr},getDirection:function(){return this.direction},toString:function(){var e;if(this.direction==="asc"){e="Asc("+this.expr+")"}else if(this.direction==="desc"){e="Desc("+this.expr+")"}else{e=""+this.expr}return e},copySubstitute:function(e){var t=this.expr.copySubstitute(e);var r=new a(t,this.direction);return r}});module.exports=a},{"../ext/Class":2}],223:[function(e,module,t){var r=e("../ext/Class");var a=e("../rdf/NodeFactory");var n=e("./VarUtils");var i=r.create({classLabel:"jassa.sparql.SparqlString",initialize:function(e,t){this.value=e;this.varsMentioned=t?t:[]},toString:function(){return this.value},getString:function(){return this.value},copySubstitute:function(e){var t=this.value;var r=[];var a="@@@@";var n=new RegExp(a,"g");this.varsMentioned.forEach(function(n){var i="\\?"+n.getName()+"([^\\w])?";var s=new RegExp(i,"g");var o=e(n);if(o){var l;if(o.isVariable()){l=a+o.getName();r.push(o)}else{l=o.toString()}t=t.replace(s,l+"$1")}else{r.push(n)}});t=t.replace(n,"?");return new i(t,r)},getVarsMentioned:function(){return this.varsMentioned}});i.create=function(e,t){var r;if(t!=null){r=t.map(function(e){return a.createVar(e)})}else{r=n.extractSparqlVars(e)}var s=new i(e,r);return s};module.exports=i},{"../ext/Class":2,"../rdf/NodeFactory":92,"./VarUtils":226}],224:[function(e,module,t){var r=e("../ext/Class");var a=e("../util/collection/HashMap");var n=r.create({initialize:function(){this.vars=[];this.varToExpr=new a},contains:function(e){var t=this.vars.some(function(t){var r=t.equals(e);return r});return t},getVars:function(){return this.vars},getExpr:function(e){var t=this.varToExpr.get(e);return t},getExprMap:function(){return this.varToExpr},add:function(e,t){this.vars.push(e);if(t){this.varToExpr.put(e,t)}},addAll:function(e){this.vars.push.apply(this.vars,e)},entries:function(){var e=this;var t=this.vars.map(function(t){var r=e.varToExpr.get(t);return{v:t,expr:r}});return t},copySubstitute:function(e){var t=new n;var r=this.entries();for(var a=0;a<r.length;++a){var i=r[a];var s=e(i.v);var o=i.expr?i.expr.copySubstitute(e):null;t.add(s,o)}return t},toString:function(){var e=[];var t=this.entries();for(var r=0;r<t.length;++r){var a=t[r];var n=a.v;var i=a.expr;if(i){e.push("("+i+" As "+n+")")}else{e.push(n.toString())}}var s=e.join(" ");return s}});module.exports=n},{"../ext/Class":2,"../util/collection/HashMap":342}],225:[function(e,module,t){var r=e("../ext/Class");var a=e("../rdf/NodeFactory");var n=r.create({initialize:function(e){this.genSym=e},next:function(){var e=this.genSym.next();var t=a.createVar(e);return t}});module.exports=n},{"../ext/Class":2,"../rdf/NodeFactory":92}],226:[function(e,module,t){var r=e("./GenSym");var a=e("./GeneratorBlacklist");var n=e("./VarGen");var i=e("../rdf/NodeFactory");var s=e("../util/StringUtils");var o={g:i.createVar("g"),s:i.createVar("s"),p:i.createVar("p"),o:i.createVar("o"),_s_:i.createVar("_s_"),_p_:i.createVar("_p_"),_o_:i.createVar("_o_"),v:i.createVar("v"),w:i.createVar("w"),x:i.createVar("x"),y:i.createVar("y"),z:i.createVar("z"),a:i.createVar("a"),b:i.createVar("b"),c:i.createVar("c"),createVars:function(e){var t=e.map(function(e){return i.createVar(e)});return t},getVarName:function(e){return e.getName()},getVarNames:function(e){var t=e.map(function(e){return e.getName()});return t},createVarGen:function(e,t){if(!e){e="v"}var i=this.getVarNames(t);var s=r.create(e);var o=new a(s,i);var l=new n(o);return l},varPattern:/\?(\w+)/g,extractSparqlVars:function(e){var t=s.extractAllRegexMatches(this.varPattern,e,1);var r=[];for(var a=0;a<t.length;++a){var n=t[a];var o=i.createVar(n);r.push(o)}return r},freshVarGen:function(e,t){var i=o.getVarNames(t);var s=r.create(e);var l=new a(s,i);var c=new n(l);return c},freshVar:function(e,t){var r=this.freshVarGen(e,t);var a=r.next();return a},fnSubst:function(e){var t=function(t){var r=e.get(t);return r};return t}};module.exports=o},{"../rdf/NodeFactory":92,"../util/StringUtils":336,"./GenSym":211,"./GeneratorBlacklist":213,"./VarGen":225}],227:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({initialize:function(){},copySubstitute:function(e){return new a},getVarsMentioned:function(){return[]},toString:function(){return"Count(*)"}});module.exports=a},{"../../ext/Class":2}],228:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({initialize:function(e){this.expr=e},copySubstitute:function(e){var t=this.expr.copySubstitute(e);
var r=new a(t);return r},getVarsMentioned:function(){return this.expr.getVarsMentioned()},toString:function(){var e="Count(Distinct "+this.expr+")";return e}});module.exports=a},{"../../ext/Class":2}],229:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({classLabel:"jassa.sparql.Element"});module.exports=a},{"../../ext/Class":2}],230:[function(e,module,t){var r=e("../../ext/Class");var a=e("lodash.union");var n=e("../../rdf/NodeUtils");var i=e("./Element");var s=r.create(i,{classLabel:"jassa.sparql.ElementBind",initialize:function(e,t){this.expr=t;this.variable=e},getArgs:function(){return[]},getExpr:function(){return this.expr},getVar:function(){return this.variable},getVarsMentioned:function(){return a(this.expr.getVarsMentioned(),this.variable)},copy:function(){return new s(this.variable,this.expr)},copySubstitute:function(e){return new s(n.getSubstitute(this.variable,e),this.expr.copySubstitute(e))},flatten:function(){return this},toString:function(){return"bind("+this.expr+" as "+this.variable+")"}});module.exports=s},{"../../ext/Class":2,"../../rdf/NodeUtils":93,"./Element":229,"lodash.union":559}],231:[function(e,module,t){var r=e("../../ext/Class");var a=e("../ExprUtils");var n=e("./Element");var i=r.create(n,{classLabel:"jassa.sparql.ElementFilter",initialize:function(e){if(Array.isArray(e)){throw new Error("[WARN] Array argument for filter is deprecated")}this.expr=e},getArgs:function(){return[]},copy:function(e){if(e.length!==0){throw new Error("Invalid argument")}var t=new i(this.expr);return t},copySubstitute:function(e){var t=this.expr.copySubstitute(e);return new i(t)},getVarsMentioned:function(){return this.expr.getVarsMentioned()},flatten:function(){return this},toString:function(){return"Filter("+this.expr+")"}});module.exports=i},{"../../ext/Class":2,"../ExprUtils":210,"./Element":229}],232:[function(e,module,t){var r=e("lodash.uniq");var a=e("../../ext/Class");var n=e("./Element");var i=e("./ElementFilter");var s=e("./ElementTriplesBlock");var o=e("../../rdf/TripleUtils");var l=e("./../ElementHelpers");var c=e("../PatternUtils");var u=a.create(n,{classLabel:"jassa.sparql.ElementGroup",initialize:function(e){this.elements=e?e:[];if(!Array.isArray(this.elements)){throw new Error(this.classLabel+" expects a single argument of type array, got ["+arguments.length+"] args; "+typeof e+": "+e)}},addElement:function(e){this.elements.push(e)},getArgs:function(){return this.elements},copy:function(e){var t=new u(e);return t},copySubstitute:function(e){var t=this.elements.map(function(t){return t.copySubstitute(e)});return new u(t)},getVarsMentioned:function(){var e=c.getVarsMentioned(this.elements);return e},toString:function(){return l.joinElements(" . ",this.elements)},flatten:function(){var e=this.elements.map(function(e){var t=e.flatten();return t});var t=[];e.forEach(function(e){if(e instanceof u){t.push.apply(t,e.elements)}else{t.push(e)}});var a=[];var n=[];var l=[];t.forEach(function(e){if(e instanceof s){a.push.apply(a,e.getTriples())}else if(e instanceof i){n.push(e)}else{l.push(e)}});var c=[];if(a.length>0){var d=o.uniqTriples(a);c.push(new s(d))}c.push.apply(c,l);var p=r(n,false,function(e){return e.toString()});c.push.apply(c,p);var h=c.length===1?c[0]:new u(c);return h}});module.exports=u},{"../../ext/Class":2,"../../rdf/TripleUtils":96,"../PatternUtils":216,"./../ElementHelpers":205,"./Element":229,"./ElementFilter":231,"./ElementTriplesBlock":236,"lodash.uniq":582}],233:[function(e,module,t){var r=e("../../ext/Class");var a=e("./Element");var n=r.create(a,{classLabel:"jassa.sparql.ElementOptional",initialize:function(e){this.optionalElement=e;if(!(e instanceof a)){throw new Error(this.classLabel+" only accepts an instance of Element as the argument")}},getArgs:function(){return[this.optionalElement]},copy:function(e){if(e.length!==1){throw new Error("Invalid argument")}var t=new n(e[0]);return t},getVarsMentioned:function(){return this.optionalElement.getVarsMentioned()},copySubstitute:function(e){return new n(this.optionalElement.copySubstitute(e))},flatten:function(){var e=new n(this.optionalElement.flatten());return e},toString:function(){return"Optional {"+this.optionalElement+"}"}});module.exports=n},{"../../ext/Class":2,"./Element":229}],234:[function(e,module,t){var r=e("../../ext/Class");var a=e("./Element");var n=e("../SparqlString");var i=r.create(a,{classLabel:"jassa.sparql.ElementString",initialize:function(e){this.sparqlString=e},getArgs:function(){return[]},copy:function(e){if(e.length!==0){throw new Error("Invalid argument")}return this},toString:function(){return this.sparqlString.getString()},copySubstitute:function(e){var t=this.sparqlString.copySubstitute(e);return new i(t)},getVarsMentioned:function(){return this.sparqlString.getVarsMentioned()},flatten:function(){return this}});i.create=function(e,t){var r=n.create(e,t);var a=new i(r);return a};module.exports=i},{"../../ext/Class":2,"../SparqlString":223,"./Element":229}],235:[function(e,module,t){var r=e("../../ext/Class");var a=e("./Element");var n=r.create(a,{classLabel:"jassa.sparql.ElementSubQuery",initialize:function(e){this.query=e},getQuery:function(){return this.query},getArgs:function(){return[]},copy:function(e){if(e.length!==0){throw new Error("Invalid argument")}var t=new n(this.query);return t},toString:function(){return"{ "+this.query+" }"},copySubstitute:function(e){return new n(this.query.copySubstitute(e))},flatten:function(){return new n(this.query.flatten())},getVarsMentioned:function(){return this.query.getVarsMentioned()}});module.exports=n},{"../../ext/Class":2,"./Element":229}],236:[function(e,module,t){var r=e("lodash.union");var a=e("../../ext/Class");var n=e("../../rdf/TripleUtils");var i=e("./Element");var s=a.create(i,{classLabel:"jassa.sparql.ElementTriplesBlock",initialize:function(e){this.triples=e?e:[]},getArgs:function(){return[]},copy:function(e){if(e.length!==0){throw new Error("Invalid argument")}var t=new s(this.triples);return t},getTriples:function(){return this.triples},addTriples:function(e){this.triples=this.triples.concat(e)},uniq:function(){this.triples=n.uniqTriples(this.triples)},copySubstitute:function(e){var t=this.triples.map(function(t){return t.copySubstitute(e)});return new s(t)},getVarsMentioned:function(){var e=[];this.triples.forEach(function(t){e=r(e,t.getVarsMentioned())});return e},flatten:function(){var e=n.uniqTriples(this.triples);var t=new s(e);return t},toString:function(){return this.triples.join(" . ")}});module.exports=s},{"../../ext/Class":2,"../../rdf/TripleUtils":96,"./Element":229,"lodash.union":559}],237:[function(e,module,t){var r=e("lodash.uniq");var a=e("../../ext/Class");var n=e("./Element");var i=e("./ElementFilter");var s=e("./ElementTriplesBlock");var o=e("../../rdf/TripleUtils");var l=e("./../ElementHelpers");var c=e("../PatternUtils");var u=a.create(n,{classLabel:"jassa.sparql.ElementUnion",initialize:function(e){this.elements=e?e:[];if(!Array.isArray(this.elements)){throw new Error(this.classLabel+" expects a single argument of type array, got ["+arguments.length+"] args; "+typeof e+": "+e)}},addElement:function(e){this.elements.push(e)},getArgs:function(){return this.elements},copy:function(e){var t=new u(e);return t},copySubstitute:function(e){var t=this.elements.map(function(t){return t.copySubstitute(e)});return new u(t)},getVarsMentioned:function(){var e=c.getVarsMentioned(this.elements);return e},toString:function(){var e="{"+this.elements.join(" } Union {")+"}";return e},flatten:function(){var e=this.elements.map(function(e){var t=e.flatten();return t});var t=new u(e);return t}});module.exports=u},{"../../ext/Class":2,"../../rdf/TripleUtils":96,"../PatternUtils":216,"./../ElementHelpers":205,"./Element":229,"./ElementFilter":231,"./ElementTriplesBlock":236,"lodash.uniq":582}],238:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({createElement:function(){throw new Error("Not overridden")}});module.exports=a},{"../../ext/Class":2}],239:[function(e,module,t){var r=e("../../ext/Class");var a=e("../element/ElementGroup");var n=e("./ElementFactory");var i=r.create(n,{initialize:function(e,t,r){this.simplify=e;this.elementFactories=t;this.forceGroup=r},isSimplify:function(){return this.simplify},getElementFactories:function(){return this.elementFactories},isForceGroup:function(){return this.forceGroup},createElement:function(){var e=this.elementFactories.map(function(e){var t=e.createElement();return t});var t=e.filter(function(e){return e!=null});var r=new a(t);if(this.simplify){r=r.flatten()}if(!this.forceGroup){var n=r.getArgs();if(n.length===1){r=n[0]}}return r}});module.exports=i},{"../../ext/Class":2,"../element/ElementGroup":232,"./ElementFactory":238}],240:[function(e,module,t){var r=e("../../ext/Class");var a=e("./ElementFactory");var n=r.create(a,{initialize:function(e){this.element=e},createElement:function(){return this.element}});module.exports=n},{"../../ext/Class":2,"./ElementFactory":238}],241:[function(e,module,t){var r=e("../../ext/Class");var a=e("../join/JoinType");var n=e("../ElementUtils");var i=e("../element/ElementOptional");var s=e("../element/ElementGroup");var o=e("./ElementFactory");var l=r.create(o,{initialize:function(e,t,r,n,i){this.elementFactoryA=e;this.elementFactoryB=t;this.joinVarsA=r;this.joinVarsB=n;this.joinType=i?i:a.INNER_JOIN},createElement:function(){var e=this.elementFactoryA.createElement();var t=this.elementFactoryB.createElement();var r=e.getVarsMentioned();var o=t.getVarsMentioned();var l=n.createJoinVarMap(o,r,this.joinVarsB,this.joinVarsA);e=n.createRenamedElement(e,l);if(this.joinType===a.LEFT_JOIN){t=new i(t)}var c=new s([e,t]);return c}});module.exports=l},{"../../ext/Class":2,"../ElementUtils":206,"../element/ElementGroup":232,"../element/ElementOptional":233,"../join/JoinType":278,"./ElementFactory":238}],242:[function(e,module,t){var r=e("../../ext/Class");var a=e("../join/JoinType");var n=e("../join/JoinBuilder");var i=e("../element/ElementGroup");var s=e("./ElementFactory");var o=r.create(s,{initialize:function(e,t,r){this.conceptFactoryA=e;this.conceptFactoryB=t;this.joinType=r||a.INNER_JOIN},createElement:function(){var e=this.conceptFactoryA.createConcept();var t=this.conceptFactoryB.createConcept();var r=e.getElement();var a=t.getElement();if(t.isSubjectConcept()){return r}var s=[e.getVar()];var o=[t.getVar()];var l=n.create(r);var c=l.joinAny(this.joinType,s,a,o);var u=c.getJoinBuilder();var d=u.getElements();var p=new i(d);return p}});module.exports=o},{"../../ext/Class":2,"../element/ElementGroup":232,"../join/JoinBuilder":272,"../join/JoinType":278,"./ElementFactory":238}],243:[function(e,module,t){var r=e("../../ext/Class");var a=e("../ExprHelpers");var n=r.create({initialize:function(e){this.expr=e},copySubstitute:function(e){return new n(this.expr.copySubstitute(e))},getVarsMentioned:function(){var e=this.expr.getVarsMentioned();return e},getArgs:function(){return[this.expr]},copy:function(e){var t=a.newUnaryExpr(n,e);return t},toString:function(){return"bound("+this.expr+")"}});module.exports=n},{"../../ext/Class":2,"../ExprHelpers":209}],244:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({initialize:function(e,t){this.expr=e;this.node=t},copySubstitute:function(e){return new a(this.expr.copySubstitute(e),this.node.copySubstitute(e))}});module.exports=a},{"../../ext/Class":2}],245:[function(e,module,t){var r=e("../../ext/Class");var a=e("./ExprFunction2");var n=r.create(a,{initialize:function($super,e,t){$super("=",e,t)},copySubstitute:function(e){return new n(this.left.copySubstitute(e),this.right.copySubstitute(e))},$copy:function(e,t){return new n(e,t)},toString:function(){return"("+this.left+" = "+this.right+")"},eval:function(){}});module.exports=n},{"../../ext/Class":2,"./ExprFunction2":264}],246:[function(e,module,t){var r=e("../../ext/Class");var a=e("./ExprFunctionN");var n=r.create(a,{initialize:function($super,e,t){$super(e,t)},copy:function(e){var t=new n(this.name,e);return t}});module.exports=n},{"../../ext/Class":2,"./ExprFunctionN":266}],247:[function(e,module,t){var r=e("../../ext/Class");var a=e("./ExprFunction2");var n=e("../ExprHelpers");var i=r.create(a,{initialize:function($super,e,t){$super(">",e,t)},copySubstitute:function(e){return new i(this.left.copySubstitute(e),this.right.copySubstitute(e))},copy:function(e){return n.newBinaryExpr(i,e)},toString:function(){return"("+this.left+" > "+this.right+")"}});module.exports=i},{"../../ext/Class":2,"../ExprHelpers":209,"./ExprFunction2":264}],248:[function(e,module,t){var r=e("../../ext/Class");var a=e("../ExprHelpers");var n=r.create({initialize:function(e){this.expr=e},copySubstitute:function(e){return new n(this.expr.copySubstitute(e))},getArgs:function(){return[this.expr]},copy:function(e){var t=a.newUnaryExpr(n,e);return t},toString:function(){return"lang("+this.expr+")"},getVarsMentioned:function(){return this.expr.getVarsMentioned()}});module.exports=n},{"../../ext/Class":2,"../ExprHelpers":209}],249:[function(e,module,t){var r=e("../../ext/Class");var a=e("../ExprHelpers");var n=e("../PatternUtils");var i=r.create({initialize:function(e,t){this.left=e;this.right=t},copySubstitute:function(e){return new i(this.left.copySubstitute(e),this.right.copySubstitute(e))},getArgs:function(){return[this.left,this.right]},copy:function(e){return a.newBinaryExpr(i,e)},toString:function(){return"langMatches("+this.left+", "+this.right+")"},getVarsMentioned:function(){var e=n.getVarsMentioned(this.getArgs());return e}});module.exports=i},{"../../ext/Class":2,"../ExprHelpers":209,"../PatternUtils":216}],250:[function(e,module,t){var r=e("../../ext/Class");var a=e("./ExprFunction2");var n=e("../ExprHelpers");var i=r.create(a,{initialize:function($super,e,t){$super("<",e,t)},copySubstitute:function(e){return new i(this.left.copySubstitute(e),this.right.copySubstitute(e))},copy:function(e){return n.newBinaryExpr(i,e)},toString:function(){return"("+this.left+" < "+this.right+")"}});module.exports=i},{"../../ext/Class":2,"../ExprHelpers":209,"./ExprFunction2":264}],251:[function(e,module,t){var r=e("../../ext/Class");var a=e("../ExprHelpers");var n=r.create({initialize:function(e,t){this.expr=e;this.pattern=t},copySubstitute:function(e){return new n(this.expr.copySubstitute(e),this.pattern)},getVarsMentioned:function(){return this.expr.getVarsMentioned()},getArgs:function(){return[this.expr]},copy:function(e){var t=a.newUnaryExpr(n,e);return t},toString:function(){var e=this.pattern.replace("'","\\'");return"("+this.expr+" Like '"+e+"')"}});module.exports=n},{"../../ext/Class":2,"../ExprHelpers":209}],252:[function(e,module,t){var r=e("../../ext/Class");var a=e("../ExprHelpers");var n=e("./ExprFunction2");var i=r.create(n,{initialize:function($super,e,t){$super("&&",e,t)},copySubstitute:function(e){return new i(this.left.copySubstitute(e),this.right.copySubstitute(e))},copy:function(e){return a.newBinaryExpr(i,e)},toString:function(){return"("+this.left+" && "+this.right+")"}});module.exports=i},{"../../ext/Class":2,"../ExprHelpers":209,"./ExprFunction2":264}],253:[function(e,module,t){var r=e("../../ext/Class");var a=e("../ExprHelpers");var n=e("./ExprFunction1");var i=r.create(n,{initialize:function(e){this.expr=e},copySubstitute:function(e){return new i(this.expr.copySubstitute(e))},getArgs:function(){return[this.expr]},copy:function(e){var t=a.newUnaryExpr(i,e);return t},toString:function(){return"(!"+this.expr+")"}});module.exports=i},{"../../ext/Class":2,"../ExprHelpers":209,"./ExprFunction1":263}],254:[function(e,module,t){var r=e("../../ext/Class");var a=e("./ExprFunction2");var n=e("../ExprHelpers");var i=r.create(a,{initialize:function($super,e,t){$super("||",e,t)},copySubstitute:function(e){var t=this.left.copySubstitute(e);var r=this.right.copySubstitute(e);var a=new i(t,r);return a},getArgs:function(){return[this.left,this.right]},copy:function(e){return n.newBinaryExpr(i,e)},toString:function(){return"("+this.left+" || "+this.right+")"}});module.exports=i},{"../../ext/Class":2,"../ExprHelpers":209,"./ExprFunction2":264}],255:[function(e,module,t){var r=e("../../ext/Class");var a=e("./ExprFunction0");var n=r.create(a,{initialize:function($super,e){$super("jassa.sparql.E_NotExists");this.element=e},getVarsMentioned:function(){return this.element.getVarsMentioned()},$copy:function(){return new n(this.element)},toString:function(){return"Not Exists ("+this.element+") "}});module.exports=n},{"../../ext/Class":2,"./ExprFunction0":262}],256:[function(e,module,t){var r=e("../../ext/Class");var a=e("./Expr");var n=function(e,t){var r=t(e);if(!r){r=e}return r};var i=r.create(a,{initialize:function(e,t){this.lhsExpr=e;if(!Array.isArray(t)){throw new Error("nodes must be an array")}this.nodes=t},getVarsMentioned:function(){var e=this.lhsExpr.getVarsMentioned();return e},copySubstitute:function(e){var t=this.nodes.map(function(t){return n(t,e)});return new i(this.lhsExpr.copySubstitute(e),t)},toString:function(){if(!this.nodes||this.nodes.length===0){return"FALSE"}else{return"("+this.lhsExpr+" in ("+this.nodes.join(", ")+"))"}}});module.exports=i},{"../../ext/Class":2,"./Expr":259}],257:[function(e,module,t){var r=e("../../ext/Class");var a=e("./Expr");var n=r.create(a,{initialize:function(e,t,r){this.expr=e;this.pattern=t;this.flags=r},copySubstitute:function(e){return new n(this.expr.copySubstitute(e),this.pattern,this.flags)},getVarsMentioned:function(){return this.expr.getVarsMentioned()},getArgs:function(){return[this.expr]},copy:function(e){if(e.length!==1){throw new Error("Invalid argument")}var t=e[0];var r=new n(t,this.pattern,this.flags);return r},toString:function(){var e=this.pattern.replace('"','\\"');var t=this.flags?', "'+this.flags.replace('"','\\"')+'"':"";return"regex("+this.expr+', "'+e+'"'+t+")"}});module.exports=n},{"../../ext/Class":2,"./Expr":259}],258:[function(e,module,t){var r=e("../../ext/Class");var a=e("./ExprFunction1");var n=r.create(a,{initialize:function($super,e){$super("str",e)},getVarsMentioned:function(){return this.subExpr.getVarsMentioned()},copy:function(e){return new n(e[0])},toString:function(){return"str("+this.subExpr+")"}});module.exports=n},{"../../ext/Class":2,"./ExprFunction1":263}],259:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({isFunction:function(){return false},isVar:function(){return false},isConstant:function(){return false},getFunction:function(){throw new Error("Override me")},getExprVar:function(){throw new Error("Override me")},getConstant:function(){throw new Error("Override me")},copySubstitute:function(){throw new Error("Override me")},copy:function(){throw new Error("Override me")}});module.exports=a},{"../../ext/Class":2}],260:[function(e,module,t){var r=e("../../ext/Class");var a=e("../../rdf/NodeUtils");var n=e("../ExprHelpers");var i=r.create({initialize:function(e,t){this.v=e;this.agg=t},copySubstitute:function(e){var t=a.getSubstitute(this.v,e);var r=this.agg.copySubstitute(e);var n=new i(t,r);return n},getAggregator:function(){return this.agg},getArgs:function(){return[]},copy:function(e){var t=new i(this.v,this.agg);return t},toString:function(){return this.agg.toString()},getVarsMentioned:function(){var e=this.agg.getVarsMentioned();return e}});module.exports=i},{"../../ext/Class":2,"../../rdf/NodeUtils":93,"../ExprHelpers":209}],261:[function(e,module,t){var r=e("../../ext/Class");var a=e("./Expr");var n=r.create(a,{getName:function(){throw new Error("Implement me")},isFunction:function(){return true},getFunction:function(){return this}});module.exports=n},{"../../ext/Class":2,"./Expr":259}],262:[function(e,module,t){var r=e("../../ext/Class");var a=e("./ExprFunctionBase");var n=r.create(a,{initialize:function($super,e){$super(e)},getArgs:function(){return[]},copy:function(e){if(e&&e.length>0){throw new Error("Invalid argument")}var t=this.$copy(e);return t}});module.exports=n},{"../../ext/Class":2,"./ExprFunctionBase":265}],263:[function(e,module,t){var r=e("../../ext/Class");var a=e("./ExprFunctionBase");var n=r.create(a,{initialize:function($super,e,t){$super(e);this.subExpr=t},getArgs:function(){return[this.subExpr]},copy:function(e){if(e.length!==1){throw new Error("Invalid argument")}var t=this.$copy(e);return t},getSubExpr:function(){return this.subExpr}});module.exports=n},{"../../ext/Class":2,"./ExprFunctionBase":265}],264:[function(e,module,t){var r=e("../../ext/Class");var a=e("./ExprFunctionBase");var n=r.create(a,{initialize:function($super,e,t,r){$super(e);this.left=t;this.right=r},getArgs:function(){return[this.left,this.right]},copy:function(e){if(e.length!==2){throw new Error("Invalid argument")}var t=this.$copy(e[0],e[1]);return t},getLeft:function(){return this.left},getRight:function(){return this.right}});module.exports=n},{"../../ext/Class":2,"./ExprFunctionBase":265}],265:[function(e,module,t){var r=e("../../ext/Class");var a=e("../PatternUtils");var n=e("./ExprFunction");var i=r.create(n,{initialize:function(e){this.name=e},copySubstitute:function(e){var t=this.getArgs();var r=t.map(function(t){var r=t.copySubstitute(e);return r});var a=this.copy(r);return a},getVarsMentioned:function(){var e=a.getVarsMentioned(this.getArgs());return e},toString:function(){var e=this.name+"("+this.getArgs().join(", ")+")";return e}});module.exports=i},{"../../ext/Class":2,"../PatternUtils":216,"./ExprFunction":261}],266:[function(e,module,t){var r=e("../../ext/Class");var a=e("./ExprFunctionBase");var n=r.create(a,{initialize:function($super,e,t){$super(e,t);this.args=t},getArgs:function(){return this.args}});module.exports=n},{"../../ext/Class":2,"./ExprFunctionBase":265}],267:[function(e,module,t){var r=e("../../ext/Class");var a=e("../SparqlString");var n=e("./Expr");var i=r.create(n,{classLabel:"jassa.sparql.ExprString",initialize:function(e){this.sparqlString=e},copySubstitute:function(e){var t=this.sparqlString.copySubstitute(e);return new i(t)},getVarsMentioned:function(){return this.sparqlString.getVarsMentioned()},getArgs:function(){return[]},copy:function(e){if(e.length!==0){throw new Error("Invalid argument")}return this},toString:function(){return"(!"+this.expr+")"},create:function(e,t){var r=new i(a.create(e,t));return r}});module.exports=i},{"../../ext/Class":2,"../SparqlString":223,"./Expr":259}],268:[function(e,module,t){var r=e("../../ext/Class");var a=e("./Expr");var n=e("./../NodeValueUtils");var i=r.create(a,{classLabel:"ExprVar",initialize:function(e){this.v=e},eval:function(e){var t=e.get(this.v);var r=n.makeNode(t);return r},copySubstitute:function(e){var t=e(this.v);var r;if(t==null){r=this}else if(t.isVariable()){r=new i(t)}else{r=n.makeNode(t)}return r},getArgs:function(){return[]},copy:function(e){if(e&&e.length>0){throw new Error("Invalid argument")}var t=new i(this.v);return t},isVar:function(){return true},getExprVar:function(){return this},asVar:function(){return this.v},getVarsMentioned:function(){return[this.v]},toString:function(){return this.v.toString()}});module.exports=i},{"../../ext/Class":2,"./../NodeValueUtils":215,"./Expr":259}],269:[function(e,module,t){var r=e("../../ext/Class");var a=e("./Expr");var n=e("../../vocab/xsd");var i=e("../../rdf/NodeFactory");var s=r.create(a,{initialize:function(e){this.node=e},isConstant:function(){return true},getConstant:function(){return this},getArgs:function(){return[]},getVarsMentioned:function(){return[]},asNode:function(){throw new Error("makeNode is not overridden")},copySubstitute:function(){return this},toString:function(){var e=this.node;var t;if(e.isLiteral()){if(e.getLiteralDatatypeUri()===n.xstring.getUri()){var r=e.getLiteralLexicalForm();t="'"+r+"'"}else if(e.dataType===n.xdouble.value){return parseFloat(this.node.value)}}else{t=e.toString()}return t},eval:function(e){return this}});module.exports=s},{"../../ext/Class":2,"../../rdf/NodeFactory":92,"../../vocab/xsd":356,"./Expr":259}],270:[function(e,module,t){var r=e("../../ext/Class");var a=e("../../vocab/xsd");var n=e("./NodeValue");var i=r.create(n,{initialize:function(e){this.node=e},asNode:function(){return this.node},toString:function(){var e=this.node;var t=null;if(e.isLiteral()){if(e.getLiteralDatatypeUri()===a.xstring.getUri()){t='"'+e.getLiteralLexicalForm()+'"'}}if(t==null){t=e.toString()}return t}});module.exports=i},{"../../ext/Class":2,"../../vocab/xsd":356,"./NodeValue":269}],271:[function(e,module,t){"use strict";var r={BestLabelConfig:e("./BestLabelConfig"),Binding:e("./Binding"),BindingUtils:e("./BindingUtils"),CannedConceptUtils:e("./CannedConceptUtils"),Concept:e("./Concept"),ConceptUtils:e("./ConceptUtils"),DiffUtils:e("./DiffUtils"),ElementHelpers:e("./ElementHelpers"),ElementUtils:e("./ElementUtils"),ExprEvaluator:e("./ExprEvaluator"),ExprEvaluatorImpl:e("./ExprEvaluatorImpl"),ExprHelpers:e("./ExprHelpers"),ExprUtils:e("./ExprUtils"),GenSym:e("./GenSym"),Generator:e("./Generator"),GeneratorBlacklist:e("./GeneratorBlacklist"),LabelUtils:e("./LabelUtils"),NodeValueUtils:e("./NodeValueUtils"),PatternUtils:e("./PatternUtils"),Query:e("./Query"),QueryType:e("./QueryType"),QueryUtils:e("./QueryUtils"),Relation:e("./Relation"),RelationUtils:e("./RelationUtils"),SortCondition:e("./SortCondition"),SparqlString:e("./SparqlString"),VarExprList:e("./VarExprList"),VarGen:e("./VarGen"),VarUtils:e("./VarUtils"),AggCount:e("./agg/AggCount"),AggCountVarDistinct:e("./agg/AggCountVarDistinct"),Element:e("./element/Element"),ElementBind:e("./element/ElementBind"),ElementFilter:e("./element/ElementFilter"),ElementGroup:e("./element/ElementGroup"),ElementOptional:e("./element/ElementOptional"),ElementString:e("./element/ElementString"),ElementSubQuery:e("./element/ElementSubQuery"),ElementTriplesBlock:e("./element/ElementTriplesBlock"),ElementUnion:e("./element/ElementUnion"),ElementFactory:e("./element_factory/ElementFactory"),ElementFactoryCombine:e("./element_factory/ElementFactoryCombine"),ElementFactoryConst:e("./element_factory/ElementFactoryConst"),ElementFactoryJoin:e("./element_factory/ElementFactoryJoin"),ElementFactoryJoinConcept:e("./element_factory/ElementFactoryJoinConcept"),E_Bound:e("./expr/E_Bound"),E_Cast:e("./expr/E_Cast"),E_Equals:e("./expr/E_Equals"),E_Function:e("./expr/E_Function"),E_GreaterThan:e("./expr/E_GreaterThan"),E_Lang:e("./expr/E_Lang"),E_LangMatches:e("./expr/E_LangMatches"),E_LessThan:e("./expr/E_LessThan"),E_Like:e("./expr/E_Like"),E_LogicalAnd:e("./expr/E_LogicalAnd"),E_LogicalNot:e("./expr/E_LogicalNot"),E_LogicalOr:e("./expr/E_LogicalOr"),E_NotExists:e("./expr/E_NotExists"),E_OneOf:e("./expr/E_OneOf"),E_Regex:e("./expr/E_Regex"),E_Str:e("./expr/E_Str"),Expr:e("./expr/Expr"),ExprAggregator:e("./expr/ExprAggregator"),ExprFunction:e("./expr/ExprFunction"),ExprFunction0:e("./expr/ExprFunction0"),ExprFunction1:e("./expr/ExprFunction1"),ExprFunction2:e("./expr/ExprFunction2"),ExprFunctionBase:e("./expr/ExprFunctionBase"),ExprFunctionN:e("./expr/ExprFunctionN"),ExprString:e("./expr/ExprString"),ExprVar:e("./expr/ExprVar"),NodeValue:e("./expr/NodeValue"),NodeValueNode:e("./expr/NodeValueNode"),JoinBuilder:e("./join/JoinBuilder"),JoinBuilderUtils:e("./join/JoinBuilderUtils"),JoinInfo:e("./join/JoinInfo"),JoinNode:e("./join/JoinNode"),JoinNodeInfo:e("./join/JoinNodeInfo"),JoinTargetState:e("./join/JoinTargetState"),JoinType:e("./join/JoinType"),KeywordSearchUtils:e("./search/KeywordSearchUtils")};Object.freeze(r);module.exports=r},{"./BestLabelConfig":198,"./Binding":199,"./BindingUtils":200,"./CannedConceptUtils":201,"./Concept":202,"./ConceptUtils":203,"./DiffUtils":204,"./ElementHelpers":205,"./ElementUtils":206,"./ExprEvaluator":207,"./ExprEvaluatorImpl":208,"./ExprHelpers":209,"./ExprUtils":210,"./GenSym":211,"./Generator":212,"./GeneratorBlacklist":213,"./LabelUtils":214,"./NodeValueUtils":215,"./PatternUtils":216,"./Query":217,"./QueryType":218,"./QueryUtils":219,"./Relation":220,"./RelationUtils":221,"./SortCondition":222,"./SparqlString":223,"./VarExprList":224,"./VarGen":225,"./VarUtils":226,"./agg/AggCount":227,"./agg/AggCountVarDistinct":228,"./element/Element":229,"./element/ElementBind":230,"./element/ElementFilter":231,"./element/ElementGroup":232,"./element/ElementOptional":233,"./element/ElementString":234,"./element/ElementSubQuery":235,"./element/ElementTriplesBlock":236,"./element/ElementUnion":237,"./element_factory/ElementFactory":238,"./element_factory/ElementFactoryCombine":239,"./element_factory/ElementFactoryConst":240,"./element_factory/ElementFactoryJoin":241,"./element_factory/ElementFactoryJoinConcept":242,"./expr/E_Bound":243,"./expr/E_Cast":244,"./expr/E_Equals":245,"./expr/E_Function":246,"./expr/E_GreaterThan":247,"./expr/E_Lang":248,"./expr/E_LangMatches":249,"./expr/E_LessThan":250,"./expr/E_Like":251,"./expr/E_LogicalAnd":252,"./expr/E_LogicalNot":253,"./expr/E_LogicalOr":254,"./expr/E_NotExists":255,"./expr/E_OneOf":256,"./expr/E_Regex":257,"./expr/E_Str":258,"./expr/Expr":259,"./expr/ExprAggregator":260,"./expr/ExprFunction":261,"./expr/ExprFunction0":262,"./expr/ExprFunction1":263,"./expr/ExprFunction2":264,"./expr/ExprFunctionBase":265,"./expr/ExprFunctionN":266,"./expr/ExprString":267,"./expr/ExprVar":268,"./expr/NodeValue":269,"./expr/NodeValueNode":270,"./join/JoinBuilder":272,"./join/JoinBuilderUtils":273,"./join/JoinInfo":274,"./join/JoinNode":275,"./join/JoinNodeInfo":276,"./join/JoinTargetState":277,"./join/JoinType":278,"./search/KeywordSearchUtils":279}],272:[function(e,module,t){var r=e("../../ext/Class");var a=e("../../util/collection/HashBidiMap");var n=e("../GenSym");var i=e("../GeneratorBlacklist");var s=e("../ElementUtils");var o=e("../element/ElementGroup");var l=e("../element/ElementOptional");var c=e("../VarUtils");var u=e("./JoinNode");var d=e("./JoinTargetState");var p=e("./JoinInfo");var h=e("./JoinType");var v=r.create({initialize:function(e,t,r,s){if(e==null){console.log("[Error] Root element must not be null");throw new Error("Bailing out")}this.usedVarNames=[];this.usedVars=[];this.aliasGenerator=new n("a");this.varNameGenerator=new i(new n("v"),this.usedVarNames);this.aliasToState={};this.rootAlias=r?r:this.aliasGenerator.next();if(s==null){s=[]}var o=this.createTargetState(this.rootAlias,new a,s,e,t,s);this.aliasToState[this.rootAlias]=o;this.rootNode=o.getJoinNode()},getRootNode:function(){return this.rootNode},getJoinNode:function(e){var t=this.aliasToState[e];var r=t?t.getJoinNode():null;return r},getState:function(e){return this.aliasToState[e]},getElement:function(e){var t=this.aliasToState[e];var r=t?t.getElement():null;return r},addVars:function(e){var t=this;e.forEach(function(e){var r=e.getName();var a=t.usedVarNames.indexOf(r)!==-1;if(!a){t.usedVarNames.push(r);t.usedVars.push(e)}})},createTargetState:function(e,t,r,a,n,i){var o=r.map(function(e){var r=t.get(e);return r});var l=s.createJoinVarMap(this.usedVars,n,o,i,this.varNameGenerator);var c=null;if(a!=null){c=s.createRenamedElement(a,l)}var p=l.getInverse().keys();this.addVars(p);var h=new u(this,e,i);var v=new d(l,h,c,p);return v},addJoin:function(e,t,r,a,n,i){var s=this.aliasToState[t];var o=s.getVarMap();if(!i){i=this.aliasGenerator.next()}var l=a.getVarsMentioned();var c=this.createTargetState(i,o,r,a,l,n);var u=new p(i,e);s.getJoinInfos().push(u);this.aliasToState[i]=c;var d=c.getJoinNode();return d},getElementsRec:function(e){var t=[];var r=e.getElement();if(r!=null){t.push(r)}var a=e.getJoinNodeInfos();var n=this;a.forEach(function(e){var r=e.getJoinNode();var a=n.getElementsRec(r);var i=new o(a);var s=e.getJoinType();switch(s){case h.LEFT_JOIN:i=new l(i);break;case h.INNER_JOIN:break;default:throw new Error("[ERROR] Unsupported join type: "+s)}t.push(i)});return t},getElements:function(){var e=this.getRootNode();var t=this.getElementsRec(e);return t},getAliasToVarMap:function(){var e={};this.aliasToState.forEach(function(t,r){e[r]=t.varMap});return e},create:function(e,t,r){var a=e.getVarsMentioned();var n=new v(e,a,t,r);var i=n.getRootNode();return i},createWithEmptyRoot:function(e,t){var r=c.varNamesToNodes(e);var a=new v(null,r,t);
var n=a.getRootNode();return n}});module.exports=v},{"../../ext/Class":2,"../../util/collection/HashBidiMap":341,"../ElementUtils":206,"../GenSym":211,"../GeneratorBlacklist":213,"../VarUtils":226,"../element/ElementGroup":232,"../element/ElementOptional":233,"./JoinInfo":274,"./JoinNode":275,"./JoinTargetState":277,"./JoinType":278}],273:[function(e,module,t){var r={getChildren:function(e){return e.getJoinNodes()}};module.exports=r},{}],274:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({initialize:function(e,t){this.alias=e;this.joinType=t},getAlias:function(){return this.alias},getJoinType:function(){return this.joinType},toString:function(){return this.joinType+" "+this.alias}});module.exports=a},{"../../ext/Class":2}],275:[function(e,module,t){var r=e("../../ext/Class");var a=e("./JoinNodeInfo");var n=e("./JoinType");var i=r.create({initialize:function(e,t,r){this.joinBuilder=e;this.alias=t;this.targetJoinVars=r},getJoinBuilder:function(){return this.joinBuilder},getJoinVars:function(){return this.targetJoinVars},getElement:function(){return this.joinBuilder.getElement(this.alias)},getVarMap:function(){return this.joinBuilder.getVarMap(this.alias)},getJoinNodeInfos:function(){var e=this.joinBuilder.getState(this.alias);var t=this;var r=e.getJoinInfos().map(function(e){var r=e.getAlias();var n=t.joinBuilder.getJoinNode(r);var i=new a(n,e.getJoinType());return i});return r},joinAny:function(e,t,r,a,n){var i=this.joinBuilder.addJoin(e,this.alias,t,r,a,n);return i},join:function(e,t,r,a){var i=this.joinAny(n.INNER_JOIN,e,t,r,a);return i},leftJoin:function(e,t,r,a){var i=this.joinAny(n.LEFT_JOIN,e,t,r,a);return i},joinTree:function(){},leftJoinTree:function(){},joinTreeAny:function(){}});module.exports=i},{"../../ext/Class":2,"./JoinNodeInfo":276,"./JoinType":278}],276:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({initialize:function(e,t){this.joinNode=e;this.joinType=t},getJoinNode:function(){return this.joinNode},getJoinType:function(){return this.joinType},toString:function(){return this.joinType+" "+this.joinNode}});module.exports=a},{"../../ext/Class":2}],277:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({initialize:function(e,t,r,a){this.varMap=e;this.joinNode=t;this.element=r;this.elementVars=a;this.joinInfos=[]},getVarMap:function(){return this.varMap},getJoinNode:function(){return this.joinNode},getElement:function(){return this.element},getElementVars:function(){return this.elementVars},getJoinInfos:function(){return this.joinInfos}});module.exports=a},{"../../ext/Class":2}],278:[function(e,module,t){var r={INNER_JOIN:"inner_join",LEFT_JOIN:"left_join"};module.exports=r},{}],279:[function(e,module,t){var r=e("../expr/ExprVar");var a=e("../expr/E_LangMatches");var n=e("../expr/E_LogicalOr");var i=e("../expr/E_Lang");var s=e("../expr/E_Bound");var o=e("../expr/E_Regex");var l=e("../expr/E_Str");var c=e("../expr/E_Function");var u=e("../Concept");var d=e("../element/ElementGroup");var p=e("../element/ElementOptional");var h=e("../element/ElementFilter");var v=e("../NodeValueUtils");var f=e("../LabelUtils");var g={createConceptRegex:function(e,t,r){var a=r?this.createConceptRegexIncludeSubject(e,t):this.createConceptRegexLabelOnly(e,t);return a},createConceptRegexLabelOnly:function(e,t){var a;if(t){var n=new d([e.getElement(),new h(new o(new l(new r(e.getTargetVar())),t,"i"))]);a=new u(n,e.getSourceVar())}else{a=null}return a},createConceptRegexIncludeSubject:function(e,t){var a;if(t){var i=e.getElement();var c=e.getSourceVar();var v=e.getTargetVar();var f=new r(c);var g=new r(v);var m=new o(new l(g),t,"i");var x=new n(new o(new l(f),t,"i"),new s(g));var _=new d([new p(new d([i,new h(m)])),new h(x)]);a=new u(_,c)}else{a=null}return a},createConceptBifContains:function(e,t){var a;if(t){var n=e.getElement();var i=e.getTargetVar();var s=new r(i);var o=v.makeString(t);var l=new d([e.getElement(),new h(new c("<bif:contains>",[s,o]))]);var p=e.getSourceVar();a=new u(l,p)}else{a=null}return a}};module.exports=g},{"../Concept":202,"../LabelUtils":214,"../NodeValueUtils":215,"../element/ElementFilter":231,"../element/ElementGroup":232,"../element/ElementOptional":233,"../expr/E_Bound":243,"../expr/E_Function":246,"../expr/E_Lang":248,"../expr/E_LangMatches":249,"../expr/E_LogicalOr":254,"../expr/E_Regex":257,"../expr/E_Str":258,"../expr/ExprVar":268}],280:[function(e,module,t){var r=e("./acc/AccRef");var a=e("./acc/AccTransform");var n={unwrapAccTransform:function(e){var t=e;while(t instanceof a){t=t.getSubAcc()}return t},getRefs:function(e,t){t=t||[];if(Array.isArray(e)){e.forEach(function(e){n.getRefs(e,t)})}else if(e instanceof r){t.push(e)}else{var a=e.getSubAccs();n.getRefs(a,t)}return t}};module.exports=n},{"./acc/AccRef":303,"./acc/AccTransform":304}],281:[function(e,module,t){var r=e("./agg/AggRef");var a=e("./agg/AggTransform");var n={unwrapAggTransform:function(e){var t=e;while(t instanceof a){t=t.getSubAgg()}return t},getRefs:function(e,t){t=t||[];if(e instanceof r){t.push(e)}else{var a=e.getSubAggs();a.forEach(function(e){n.getRefs(e,t)})}return t}};module.exports=n},{"./agg/AggRef":315,"./agg/AggTransform":316}],282:[function(e,module,t){var r=e("../ext/Class");var a=e("../util/ObjectUtils");var n=r.create({classLabel:"jassa.sponate.AttrPath",initialize:function(e){this.steps=e?e:[]},getSteps:function(){return this.steps},toString:function(){return this.steps.join(".")},slice:function(e,t){var r=this.steps.slice(e,t);return r},first:function(){return this.steps[0]},at:function(e){return this.steps[e]},isEmpty:function(){return this.steps.length===0},size:function(){return this.steps.length},concat:function(e){var t=this.steps.concat(e.getSteps());var r=new n(t);return r},find:function(e){var t=e;var r=this.steps;for(var n=0;n<r.length;++n){var i=r[n];if(!a.isObject(t)){throw new Error("[ERROR] Cannot access attribute of non-object",this.steps,e,t)}t=t[i]}return t}});n.parse=function(e){var t=e.split(".");return new n(t)};module.exports=n},{"../ext/Class":2,"../util/ObjectUtils":331}],283:[function(e,module,t){var r=e("../ext/Class");var a=e("./SponateUtils");var n=e("./MappedConceptSource");var i=e("./MappedConcept");var s=e("./AggUtils");var o=e("../util/ObjectUtils");var l=e("./RefSpec");var c=e("./binding_mapper/BindingMapperExpr");var u=e("../sparql/expr/ExprVar");var d=e("./agg/AggMap");var p=r.create({initialize:function(e){this.prefixMapping=e;this.nameToSource={};this.nameToMappedConcept={}},getSource:function(e){return this.nameToSource[e]},processRefs:function(e,t){var r=t.getMappedConcept();var a=t.getSparqlService();var p=r.getAgg();var h=s.getRefs(p);var v=this;h.forEach(function(t){var p=t.getRefSpec();var h=p.getTarget();if(h instanceof i){var f=h.getAgg();var g=f.getSubAgg();var m=g.getAttrToAgg();var x=s.unwrapAggTransform(m.id);var _=x.getBindingMapper();f=new d(_,g);var b=new i(h.getConcept(),f);var y=0;var S;while(v.getSource(S=e+"_"+y)){++y}t.setRefSpec(new l(S,p.getAttr()));var C=t.getBindingMapper();if(!C){var E=r.getConcept();var w=E.getVar();C=new c(new u(w));t.setBindingMapper(C)}var k=new n(b,a);v.nameToSource[S]=k}else if(!o.isString(h)){throw new Error("Unknown target type: ",h)}})},addTemplate:function(e){var t=e.name;if(!t){throw new Error("Sponate spec must have a name")}var r=a.parseSpec(e,this.prefixMapping);this.nameToMappedConcept[t]=r},add:function(e){var t=e.name;if(!t){throw new Error("Sponate spec must have a name")}var r=e.service;if(!r){throw new Error("No service provided for ",e)}var s;if(o.isString(e.template)){var l=e.template;var c=this.nameToMappedConcept[l];if(!c){throw new Error("No template with name "+l+" registered.")}s=new i(c.getConcept(),c.getAgg().clone())}else{s=a.parseSpec(e,this.prefixMapping)}var u=new n(s,r);this.processRefs(t,u);this.nameToSource[t]=u}});module.exports=p},{"../ext/Class":2,"../sparql/expr/ExprVar":268,"../util/ObjectUtils":331,"./AggUtils":281,"./MappedConcept":287,"./MappedConceptSource":288,"./RefSpec":292,"./SponateUtils":294,"./agg/AggMap":312,"./binding_mapper/BindingMapperExpr":319}],284:[function(e,module,t){var r=e("../ext/Class");var a=e("./ListServiceUtils");var n=e("./AccUtils");var i=e("../util/collection/HashMap");var s=e("../util/collection/HashSet");var o=e("./LookupServiceUtils");var a=e("./ListServiceUtils");var l=e("../service/list_service/ListServiceTransformItems");var c=e("../util/ObjectUtils");var u=e("lodash.foreach");var d=e("../util/shared");var p=d.Promise;var h=r.create({initialize:function(e,t,r){this.obj=e;this.attr=t;this.meta=r},setValue:function(e){this.obj[this.attr]=e},getValue:function(){return this.obj[this.attr]},getMeta:function(){return this.meta},toString:function(){return JSON.stringify(this)}});var v={indexAccMap:function(e,t,r){var a=e[t];if(!a){a=new i;e[t]=a}a.putAll(r)},mergeRefs:function(e,t){t.forEach(function(t){var r=t.getRefSpec();var a=r.getTarget();var n=t.getRefValue();var i;if(!(a in e)){i=new s;e[a]=i}else{i=e[a]}i.add(n)})},filterRefs:function(e,t){var r=[];t.forEach(function(t){var a=t.getRefSpec();var n=a.getTarget();var i=t.getRefValue();var s=e[n];var o=s&&s.containsKey(i);if(!o){r.push(t)}});return r},buildObjs:function(e){var t={};u(e,function(e,r){var a=new i;t[r]=a;e.entries().forEach(function(e){var t=e.key;var r=e.val;var n=r.getValue();a.put(t,n)})});return t},buildLazySlots:function(e,t,r){r=r||[];u(e,function(e,a){e.values().forEach(function(e){var a=v.buildSlots(e,t);a=a.reverse();r.push.apply(r,a)})});return r},buildSlots:function(e,t,r){r=r||[];if(Array.isArray(e)){e.forEach(function(a,n){if(a&&a[t]){var i=new h(e,n,a[t]);r.push(i)}else{v.buildSlots(a,t,r)}})}else if(c.isObject(e)){u(e,function(a,n){if(a&&a[t]){var i=new h(e,n,a[t]);r.push(i)}else{v.buildSlots(a,t,r)}})}return r},createLookupService:function(e,t){var r=e.getSource(t);if(!r){throw new Error("No source mapping with name "+t+" found")}var a=r.getSparqlService();var n=r.getMappedConcept();var i=o.createLookupServiceMappedConceptAcc(a,n);return i},createListService:function(e,t,r){var n=e.getSource(t);if(!n){throw new Error("No source mapping with name "+t+" found")}var i=n.getSparqlService();var s=n.getMappedConcept();if(s.getConcept().getVar().getName()==="rowId"){throw new Error("rowId cannot be used as the root ID of a MappedConcept")}var o=a.createListServiceAcc(i,s,r);var c=this;var u=new l(o,function(r){var a=p.resolve(c.collectState(e,t,r)).spread(function(e,r,a){var n=c.postProcess(r,t,e);return n});return a});return u},collectState:function(e,t,r){var a={};var s=r.map(function(e){return e.key});var o=new i;var l={};r.forEach(function(e){var t=e.val;var r=t.getState();o.putAll(r);var a=n.getRefs(t);v.mergeRefs(l,a)});a[t]=o;var c=this.resolveRefs(e,l,a);return[s,a,c]},postProcess:function(e,t,r){var a=[];u(e,function(e){var t=e.values();var r=n.getRefs(t);a.push.apply(a,r)});a.forEach(function(e){var t=e.getRefSpec();var r=t.getTarget();var a=e.getRefValue();e.setBaseValue({_ref:{targetName:r,refValue:a,attr:t.getAttr()}})});var i=v.buildObjs(e);var s=v.buildSlots(i,"_ref");var o=v.buildLazySlots(i,"_lazy");s.forEach(function(e){var t=e.getMeta();var r=i[t.targetName];var a=r.get(t.refValue);var n=t.attr;a=a!=null&&n!=null?a[n]:a;e.setValue(a)});o.forEach(function(e){var t=e.getMeta();var r=t.fn;var a=t.value;var n=r(a);e.setValue(n)});var l=r.map(function(e){var r=i[t];var a=r.get(e);var n={key:e,val:a};return n});return l},exec:function(e,t){var r=t.getSourceName();var a=this.createListService(e,r,t.isLeftJoin());var n=t.getLimit();var i=t.getOffset();var s=t.getFilterConcept();var o=a.fetchItems(s,n,i);return o},resolveRefs:p.method(function(e,t,r){var a=this;var i=Object.keys(t);var s=i.map(function(i){var s=t[i];var o=a.createLookupService(e,i);var l=s.entries();var c=o.lookup(l).then(function(t){var s=t.values();v.indexAccMap(r,i,t);var o=n.getRefs(s);var l=v.filterRefs(r,o);var c={};v.mergeRefs(c,l);return a.resolveRefs(e,c,r)});return c});return p.all(s)})};module.exports=v},{"../ext/Class":2,"../service/list_service/ListServiceTransformItems":149,"../util/ObjectUtils":331,"../util/collection/HashMap":342,"../util/collection/HashSet":343,"../util/shared":350,"./AccUtils":280,"./ListServiceUtils":285,"./LookupServiceUtils":286,"lodash.foreach":432}],285:[function(e,module,t){var r=e("../sparql/Concept");var a=e("../sparql/ConceptUtils");var n=e("./ServiceUtils");var i=e("../service/list_service/ListServiceSparqlQuery");var s=e("../service/list_service/ListServiceTransformItem");var o=e("../rdf/NodeFactory");var l=e("../sparql/BindingUtils");var c={createListServiceAcc:function(e,t,r){r=!!r;var n=t.getConcept();var c=a.createQueryList(n);var u=t.getAgg();var d=o.createVar("rowId");c.setQueryResultStar(true);var p=new i(e,c,n.getVar(),r);var h=new s(p,function(e){var t=e.key;var r=e.val.getBindings();r=l.cloneBindings(r);l.addRowIds(r,d);var a=u.createAcc();r.forEach(function(e){a.accumulate(e)});var n={key:t,val:a};return n});return h},createListServiceMappedConcept:function(e,t,r){var a=this.createListServiceAcc(e,t,r);var n=new s(a,function(e){var t=e.map(function(e){var t=e.val.getValue();return t});return t});return n}};module.exports=c},{"../rdf/NodeFactory":92,"../service/list_service/ListServiceSparqlQuery":145,"../service/list_service/ListServiceTransformItem":148,"../sparql/BindingUtils":200,"../sparql/Concept":202,"../sparql/ConceptUtils":203,"./ServiceUtils":293}],286:[function(e,module,t){var r=e("../sparql/ConceptUtils");var a=e("../service/lookup_service/LookupServiceSparqlQuery");var n=e("../service/lookup_service/LookupServiceTransform");var i=e("./AccUtils");var s={createTransformAccResultSetPart:function(e){var t=function(t){var r=e.createAcc();var a=t.getBindings();a.forEach(function(e){r.accumulate(e)});return r};return t},createLookupServiceMappedConcept:function(e,t){var r=this.createLookupServiceMappedConceptAcc(e,t);var a=new n(r,function(e){var t=e.getValue();return t});return a},createLookupServiceMappedConceptAcc:function(e,t){var i=t.getConcept();var s=r.createQueryList(i);var o=i.getVar();s.setQueryResultStar(true);var l=t.getAgg();var c=l.getSubAgg();var u=new a(e,s,o);var d=this.createTransformAccResultSetPart(c);var p=new n(u,d);return p}};module.exports=s},{"../service/lookup_service/LookupServiceSparqlQuery":161,"../service/lookup_service/LookupServiceTransform":163,"../sparql/ConceptUtils":203,"./AccUtils":280}],287:[function(e,module,t){var r=e("../ext/Class");var a=r.create({initialize:function(e,t){this.concept=e;this.agg=t},getConcept:function(){return this.concept},getAgg:function(){return this.agg}});module.exports=a},{"../ext/Class":2}],288:[function(e,module,t){var r=e("../ext/Class");var a=r.create({initialize:function(e,t){this.mappedConcept=e;this.sparqlService=t},getMappedConcept:function(){return this.mappedConcept},getSparqlService:function(){return this.sparqlService}});module.exports=a},{"../ext/Class":2}],289:[function(e,module,t){var r=e("../rdf/NodeUtils");var a=e("../sparql/LabelUtils");var n=e("../sparql/VarUtils");var i=e("../sparql/expr/ExprVar");var s=e("./agg/AggArray");var o=e("./agg/AggLiteral");var l=e("./agg/AggMap");var c=e("./agg/AggObject");var u=e("./agg/AggBestLabel");var d=e("./agg/AggTransform");var p=e("./binding_mapper/BindingMapperExpr");var h=e("./binding_mapper/BindingMapperTransform");var v=e("../sparql/Concept");var f=e("./MappedConcept");var r=e("../rdf/NodeUtils");var g={createMappedConceptBestLabel:function(e){var t=a.createRelationPrefLabels(e);var n=t.getSourceVar();var h=t.getTargetVar();var g=new c({id:new d(new o(new p(new i(n))),r.getValue),displayLabel:new d(new u(e),r.getValue),hiddenLabels:new s(new d(new o(new p(new i(h))),r.getValue))});g=new l(new p(new i(n)),g);var m=new v(t.getElement(),t.getSourceVar());var x=new f(m,g);return x}};module.exports=g},{"../rdf/NodeUtils":93,"../sparql/Concept":202,"../sparql/LabelUtils":214,"../sparql/VarUtils":226,"../sparql/expr/ExprVar":268,"./MappedConcept":287,"./agg/AggArray":307,"./agg/AggBestLabel":309,"./agg/AggLiteral":311,"./agg/AggMap":312,"./agg/AggObject":313,"./agg/AggTransform":316,"./binding_mapper/BindingMapperExpr":319,"./binding_mapper/BindingMapperTransform":321}],290:[function(e,module,t){var r=e("../ext/Class");var a=r.create({initialize:function(e,t,r){this.mapName=e;this.tableRef=t},getMapName:function(){return this.mapName},getTableRef:function(){return this.tableRef},getAttrPath:function(){return this.attrPath},toString:function(){var e=this.patternRef+"/"+this.tableRef+"@"+this.attrPath;return e}});module.exports=a},{"../ext/Class":2}],291:[function(e,module,t){var r=e("../ext/Class");var a=r.create({initialize:function(e,t,r,a,n,i,s){this.sourceName=e;this.criteria=t;this.limit=r;this.offset=a;this.filterConcept=n;this._isLeftJoin=i;this.nodes=s},shallowClone:function(){var e=new a(this.sourceName,this.criteria,this.limit,this.offset,this.filterConcept,this._isLeftJoin,this.nodes);return e},getSourceName:function(){return this.sourceName},setSourceName:function(e){this.sourceName=e},getCriteria:function(){return this.criteria},setCriteria:function(e){this.criteria=e},getLimit:function(){return this.limit},setLimit:function(e){this.limit=e},getOffset:function(){return this.offset},setOffset:function(e){this.offset=e},getFilterConcept:function(){return this.filterConcept},setFilterConcept:function(e){this.filterConcept=e},isLeftJoin:function(){return this._isLeftJoin},setLeftJoin:function(e){this._isLeftJoin=e},getNodes:function(){return this.nodes},setNodes:function(e){this.nodes=e}});module.exports=a},{"../ext/Class":2}],292:[function(e,module,t){var r=e("../ext/Class");var a=r.create({initialize:function(e,t){this.target=e;this.attr=t},getTarget:function(){return this.target},getAttr:function(){return this.attr}});module.exports=a},{"../ext/Class":2}],293:[function(e,module,t){var r={processResultSet:function(e,t){while(e.hasNext()){var r=e.next();t.accumulate(r)}var a=t.getValue();return a},processBindings:function(e,t){e.forEach(function(e){t.accumulate(e)});var r=t.getValue();return r},execAgg:function(e,t,r){var a=r.createAcc();var n=this.execAcc(e,t,a);return n},execAcc:function(e,t,a){var n=e.createQueryExecution(t);var i=n.execSelect().then(function(e){var t=r.processResultSet(e,a);return t});return i}};module.exports=r},{}],294:[function(e,module,t){var r=e("../util/ObjectUtils");var a=e("../util/PrefixUtils");var n=e("../sparql/element/Element");var i=e("../sparql/element/ElementString");var s=e("./TemplateParser");var o=e("./ListServiceUtils");var l=e("./agg/AggMap");var c=e("./MappedConcept");var u=e("../sparql/expr/ExprVar");var d=e("../sparql/Concept");var p=e("./AggUtils");var h={parseSpec:function(e,t,r){var a=e.template;var n=a instanceof c?a:this.parseSpecCore(e,t,r);return n},parseSpecCore:function(e,t,o){o=o||new s;var h=e.template;var v=e.from;var f;if(r.isString(v)){var g=v;if(t!=null){var m=t.getNsPrefixMap();g=a.expandPrefixes(m,g)}f=new i.create(g)}else if(v instanceof n){f=v}else if(r.isFunction(v)){throw new Error("ElementFactories / functions in the FROM part not supported anymore")}else{throw new Error("Unknown argument type for FROM attribute",v)}var x=o.parseAgg(h);var _=p.unwrapAggTransform(x);var b;if(_ instanceof l){var y=_.getKeyBindingMapper();b=y.getExpr()}else{throw new Error("Could not obtain ID attribute from aggregator")}var S;if(b instanceof u){S=b.asVar()}else{throw new Error("Variable required for ID attribute, got an expression instead: "+b)}var C=new d(f,S);var E=new c(C,_);return E}};module.exports=h},{"../sparql/Concept":202,"../sparql/element/Element":229,"../sparql/element/ElementString":234,"../sparql/expr/ExprVar":268,"../util/ObjectUtils":331,"../util/PrefixUtils":332,"./AggUtils":281,"./ListServiceUtils":285,"./MappedConcept":287,"./TemplateParser":295,"./agg/AggMap":312}],295:[function(e,module,t){var r=e("lodash.uniq");var a=e("../ext/Class");var n=e("../util/ObjectUtils");var i=e("../rdf/NodeUtils");var s=e("../rdf/node/Node");var o=e("../rdf/node/Var");var l=e("../rdf/NodeFactory");var c=e("../sparql/expr/Expr");var u=e("../sparql/expr/ExprVar");var d=e("../sparql/expr/NodeValue");var p=e("../sparql/NodeValueUtils");var h=e("./agg/AggLiteral");var v=e("./agg/AggObjectCustom");var f=e("./agg/AggMap");var g=e("./agg/AggMap");var m=e("./agg/AggRef");var x=e("./agg/AggArray");var _=e("./agg/AggArrayStatic");var b=e("./agg/AggTransform");var y=e("./agg/AggTransformLazy");var S=e("./AggUtils");var C=e("./RefSpec");var E=e("./binding_mapper/BindingMapperExpr");var w=a.create({initialize:function(){this.attrs={id:"id",ref:"$ref"}},parseArray:function(e){var t=this;var r=e[e.length-1];var a=n.isFunction(r);var i;if(a){i=this.parseArrayTransform(e)}else{var s=e.some(function(e){var t=e.id||e.$ref||n.isString(e);return t});i=!s?this.parseArrayStatic(e):this.parseArrayDynamic(e)}return i},parseArrayTransform:function(e){var t=e.length-1;var r=e[t];var a=this;var n=e.slice(0,t);var i=n.map(function(e){var t=a.parseAgg(e);return t});var s=new _(i);var o=new y(s,function(e){var t=r.apply(null,e);return t});return o},parseArrayStatic:function(e){var t=this;var r=e.map(function(e){var r=t.parseAgg(e);return r});var a=new _(r);return a},parseArrayDynamic:function(e){if(e.length!==1){throw new Error("[ERROR] Arrays must have exactly one element that is either a string or an object",e)}var t=e[0];var r;if(n.isString(t)){r=this.parseArrayLiteral(t)}else if(Array.isArray(t)){if(t.length===1){var a=t[0];r=this.parseArrayConfig(a);var i=Object.keys(a);var s=i.length===2&&i.indexOf("id")>=0&&i.indexOf("$value")>=0;r=new b(r,function(e){var t={};e.forEach(function(e){t[e.id]=s?e.$value:e});return t})}else{throw new Error("Not implemented")}}else if(n.isObject(t)){r=this.parseArrayConfig(t)}else{throw new Error("Bailing out")}return r},parseArrayConfig:function(e){var t=this.attrs.id;var r=this.attrs.ref;var a=e[t]!=null;var n=e[r]!=null;if(a&&n){throw new Error("[ERROR] id and ref are mutually exclusive")}var i;if(a){var s=this.parseObject(e);var o=s.getAttrToAgg();var l=o[t];l=S.unwrapAggTransform(l);var c=l.getBindingMapper();i=new f(c,s);i=new b(i,function(e){return e.values()})}else if(n){i=this.parseArrayRef(e)}else{throw new Error("[ERROR] Not implemented")}return i},parseArrayRef:function(e){var t=e[this.attrs.ref];var r=this.parseRef(t);var a=r.getBindingMapper();var n=new f(a,r);n=new b(n,function(e){return e.values()});return n},parseArrayLiteral:function(e){var t=this.parseLiteral(e);var a=new b(new x(t),function(e){return r(e,function(e){return""+e})});return a},parseLiteral:function(e){var t=e.split("|").map(function(e){return e.trim()});var r=t[0];var a=this.parseExprString(r);var n=new h(new E(a));var s=t[1];if(s!=="node"){n=new b(n,i.getValue)}return n},parseObject:function(e){var t=e[this.attrs.ref];var r=t!=null?this.parseRef(t):this.parseObjectData(e);return r},parseRef:function(e){var t=e.target;if(!t){throw new Error("Missing target attribute in ref: ",e)}var r=new C(t,e.attr);var a=e.on;var n=null;if(a){var i=this.parseExprString(a);n=new E(i)}var s=new m(n,r);return s},parseObjectData:function(e){var t={};var r=this;var a=Object.keys(e);a.forEach(function(a){var n=e[a];var i=r.parseAgg(n);if(i==null){throw new Error("Failed to create aggregator for attribute ["+a+"] in "+JSON.stringify(e))}t[a]=i});var n=new v(t,this);return n},parseAgg:function(e){var t;if(n.isString(e)){t=this.parseLiteral(e)}else if(Array.isArray(e)){t=this.parseArray(e)}else if(n.isFunction(e)){throw new Error("Implement this case: "+JSON.stringify(e))}else if(e instanceof s&&e.isVariable()){var r=new u(e);t=new h(new E(r))}else if(e instanceof c){t=new h(new E(e))}else if(n.isObject(e)){var a=e.createAgg;if(a){t=new g(e)}else{t=this.parseObject(e)}}else{console.log("[ERROR] Unknown item type: ",e);throw new Error("Unkown item type")}return t},parseExpr:function(e){var t;if(n.isString(e)){t=this.parseExprString(e)}else if(e instanceof s&&e.isVariable()){t=new u(e)}else{throw new Error("Could not parse expression: ",e)}return t},parseExprString:function(e){var t;var r=e.charAt(0);if(r==="?"){var a=e.substr(1);var n=l.createVar(a);t=new u(n)}else if(r==='"'||r==="'"){t=e.substring(1,e.length-1);t=p.makeString(t)}else{t=p.makeString(e)}return t}});module.exports=w},{"../ext/Class":2,"../rdf/NodeFactory":92,"../rdf/NodeUtils":93,"../rdf/node/Node":104,"../rdf/node/Var":111,"../sparql/NodeValueUtils":215,"../sparql/expr/Expr":259,"../sparql/expr/ExprVar":268,"../sparql/expr/NodeValue":269,"../util/ObjectUtils":331,"./AggUtils":281,"./RefSpec":292,"./agg/AggArray":307,"./agg/AggArrayStatic":308,"./agg/AggLiteral":311,"./agg/AggMap":312,"./agg/AggObjectCustom":314,"./agg/AggRef":315,"./agg/AggTransform":316,"./agg/AggTransformLazy":317,"./binding_mapper/BindingMapperExpr":319,"lodash.uniq":582}],296:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({classLabel:"jassa.sponate.acc",accumulate:function(e){throw new Error("override me")},getValue:function(){throw new Error("override me")},getSubAccs:function(){throw new Error("override me")}});module.exports=a},{"../../ext/Class":2}],297:[function(e,module,t){var r=e("../../ext/Class");var a=e("../binding_mapper/BindingMapperIndex");var n=e("./Acc");var i=r.create(n,{classLabel:"jassa.sponate.AccFn",initialize:function(e,t){var r=this;this.i=0;this.subAgg=e;this.indexBindingMapper=t||new a;this.subAccs=[]},accumulate:function(e){var t=this.indexBindingMapper.map(e,this.i++);if(t!=null){var r=this.subAccs[t];if(!r){r=this.subAgg.createAcc();this.subAccs[t]=r}r.accumulate(e)}},getValue:function(){var e=[];this.subAccs.forEach(function(t,r){var a=t.getValue();if(a!=null){e[r]=a}});return e},getSubAccs:function(){var e=[];this.subAccs.forEach(function(t){if(t){e.push(t)}});return e}});module.exports=i},{"../../ext/Class":2,"../binding_mapper/BindingMapperIndex":320,"./Acc":296}],298:[function(e,module,t){var r=e("../../ext/Class");var a=e("./Acc");var n=r.create(a,{classLabel:"jassa.sponate.AccArrayStatic",initialize:function(e){this.subAccs=e},accumulate:function(e){this.subAccs.forEach(function(t){t.accumulate(e)})},getValue:function(){var e=this.subAccs.map(function(e){var t=e.getValue();return t});return e},getSubAccs:function(){return this.subAccs}});module.exports=n},{"../../ext/Class":2,"./Acc":296}],299:[function(e,module,t){var r=e("../../ext/Class");var a=e("../../rdf/NodeUtils");var n=e("./Acc");var i=function(e,t){var r=[];var a=Math.max(e.length,t.length);for(var n=0;n<a;++n){var i=[e[n],t[n]];r.push(i)}return r};var s=function(e,t,r){var a=false;var n=Math.max(e.length,t.length);for(var i=0;i<n;++i){var s=e[i];var o=t[i];if(r(s,o)){if(r(o,s)){continue}a=true;break}else{if(!r(o,s)){continue}a=false;break}}return a};var o=function(e,t){return e<t};var l=function(e,t){var r=-1;for(var a=0;a<e.length;++a){var n=e[a];if(n.equals(t)){r=a;break}}return r};var c=r.create(n,{initialize:function(e){this.bestLiteralConfig=e;this.bestMatchNode=null;this.bestMatchScore=[1e3,1e3]},getSubAccs:function(){return[]},accumulate:function(e){var t=this.bestLiteralConfig;var r=e.get(t.getSubjectVar());var n=e.get(t.getPredicateVar());var i=e.get(t.getObjectVar());if(this.bestMatchNode==null){this.bestMatchNode=r}var c=a.getLang(i);var u=l(t.getPredicates(),n);var d=t.getLangs().indexOf(c);var p=[u,d];var h=p.every(function(e){return e>=0});if(h){var v=s(p,this.bestMatchScore,o);if(v===true){this.bestMatchScore=p;this.bestMatchNode=i}}},getValue:function(){return this.bestMatchNode}});module.exports=c},{"../../ext/Class":2,"../../rdf/NodeUtils":93,"./Acc":296}],300:[function(e,module,t){var r=e("../../ext/Class");var a=e("../../util/ObjectUtils");var n=e("./Acc");var i=r.create(n,{classLabel:"jassa.sponate.AccLiteral",initialize:function(e){this.bindingMapper=e;this.value=null},accumulate:function(e){var t=this.bindingMapper.map(e,0);if(false){if(this.value!=null&&!a.isEqual(this.value,t)){console.log("[WARN] Reassigned value: Original",this.value," New: ",t)}}this.value=t},getValue:function(){return this.value},getSubAccs:function(){return[]}});module.exports=i},{"../../ext/Class":2,"../../util/ObjectUtils":331,"./Acc":296}],301:[function(e,module,t){var r=e("../../ext/Class");var a=e("../../util/collection/HashMap");var n=e("./Acc");var i=r.create(n,{classLabel:"jassa.sponate.AccMap",initialize:function(e,t){this.keyBindingMapper=e;this.subAgg=t;this.state=new a},getState:function(){return this.state},accumulate:function(e){var t=this.keyBindingMapper.map(e,0);if(t!=null){var r=this.state.get(t);if(!r){r=this.subAgg.createAcc();this.state.put(t,r)}r.accumulate(e)}},getValue:function(){var e=new a;var t=this.state.entries();t.forEach(function(t){var r=t.key;var a=t.val;var n=a.getValue();e.put(r,n)});return e},getSubAccs:function(){var e=this.state.entries();var t=e.map(function(e){return e.val});return t}});module.exports=i},{"../../ext/Class":2,"../../util/collection/HashMap":342,"./Acc":296}],302:[function(e,module,t){var r=e("lodash.foreach");var a=e("../../ext/Class");var n=e("./Acc");var i=a.create(n,{classLabel:"jassa.sponate.AccObject",initialize:function(e){this.attrToAcc=e},accumulate:function(e){r(this.attrToAcc,function(t){t.accumulate(e)})},getValue:function(){var e={};r(this.attrToAcc,function(t,r){var a=t.getValue();e[r]=a});return e},getSubAccs:function(){var e=[];r(this.attrToAcc,function(t){e.push(t)});return e}});module.exports=i},{"../../ext/Class":2,"./Acc":296,"lodash.foreach":432}],303:[function(e,module,t){var r=e("../../ext/Class");var a=e("./Acc");var n=r.create(a,{classLabel:"jassa.sponate.AccRef",initialize:function(e,t){this.bindingMapper=e;this.refSpec=t;this.refValue=null;this.baseValue=null},getSubAccs:function(){return[]},getRefSpec:function(){return this.refSpec},getRefValue:function(){return this.refValue},accumulate:function(e){var t=this.bindingMapper.map(e,0);this.refValue=t},getBaseValue:function(){return this.baseValue},setBaseValue:function(e){this.baseValue=e},getValue:function(){return this.baseValue}});module.exports=n},{"../../ext/Class":2,"./Acc":296}],304:[function(e,module,t){var r=e("../../ext/Class");var a=e("./Acc");var n=r.create(a,{classLabel:"jassa.sponate.AccTransform",initialize:function(e,t){this.subAcc=e;this.fn=t},getSubAcc:function(){return this.subAcc},accumulate:function(e){this.subAcc.accumulate(e)},getValue:function(){var e=this.subAcc.getValue();var t=this.fn(e);return t},getSubAccs:function(){return[this.subAcc]}});module.exports=n},{"../../ext/Class":2,"./Acc":296}],305:[function(e,module,t){var r=e("../../ext/Class");var a=e("./Acc");var n=r.create(a,{classLabel:"jassa.sponate.AccTransformLazy",initialize:function(e,t){this.subAcc=e;this.fn=t},getSubAcc:function(){return this.subAcc},accumulate:function(e){this.subAcc.accumulate(e)},getValue:function(){var e={_lazy:{value:this.subAcc.getValue(),fn:this.fn}};return e},getSubAccs:function(){return[this.subAcc]}});module.exports=n},{"../../ext/Class":2,"./Acc":296}],306:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({classLabel:"jassa.sponate.Agg",createAcc:function(){throw new Error("override me")},getSubAggs:function(){throw new Error("override me")},clone:function(){throw new Error("override me")}});module.exports=a},{"../../ext/Class":2}],307:[function(e,module,t){var r=e("../../ext/Class");var a=e("./Agg");var n=e("../acc/AccArray");var i=r.create(a,{classLabel:"jassa.sponate.AggArray",initialize:function(e,t){this.subAgg=e;this.indexBindingMapper=t},clone:function(){var e=new i(this.subAgg.clone(),this.indexBindingMapper);return e},createAcc:function(){var e=new n(this.subAgg,this.indexBindingMapper);return e},getSubAgg:function(){return this.subAgg},getIndexBindingMapper:function(){return this.indexBindingMapper},getSubAggs:function(){return[this.subAgg]},toString:function(){return this.expr.toString()}});module.exports=i},{"../../ext/Class":2,"../acc/AccArray":297,"./Agg":306}],308:[function(e,module,t){var r=e("../../ext/Class");var a=e("./Agg");
var n=e("../acc/AccArrayStatic");var i=r.create(a,{classLabel:"jassa.sponate.AggArrayStatic",initialize:function(e){this.subAggs=e},clone:function(){var e=this.subAggs.map(function(e){return e.clone()});var t=new i(e);return t},createAcc:function(){var e=this.subAggs.map(function(e){return e.createAcc()});var t=new n(e);return t},getSubAggs:function(){return this.subAggs},toString:function(){return"implement me"}});module.exports=i},{"../../ext/Class":2,"../acc/AccArrayStatic":298,"./Agg":306}],309:[function(e,module,t){var r=e("lodash.union");var a=e("../../ext/Class");var n=e("./Agg");var i=e("../acc/AccBestLabel");var s=a.create(n,{initialize:function(e){this.bestLiteralConfig=e},clone:function(){var e=new s(this.bestLiteralConfig);return e},createAcc:function(){var e=new i(this.bestLiteralConfig);return e},getSubAggs:function(){return[]},toString:function(){var e="bestLabel["+this.bestLiteralConfig+"]";return e}});module.exports=s},{"../../ext/Class":2,"../acc/AccBestLabel":299,"./Agg":306,"lodash.union":559}],310:[function(e,module,t){var r=e("../../ext/Class");var a=e("./Agg");var n=r.create(a,{classLabel:"jassa.sponate.AggCustomAgg",initialize:function(e){this.fnAcc=e},getSubAggs:function(){return[]}});module.exports=n},{"../../ext/Class":2,"./Agg":306}],311:[function(e,module,t){var r=e("../../ext/Class");var a=e("./Agg");var n=e("../acc/AccLiteral");var i=r.create(a,{classLabel:"jassa.sponate.AggLiteral",initialize:function(e){this.bindingMapper=e},clone:function(){var e=new i(this.bindingMapper);return e},getBindingMapper:function(){return this.bindingMapper},getSubAggs:function(){return[]},createAcc:function(){var e=new n(this.bindingMapper);return e}});module.exports=i},{"../../ext/Class":2,"../acc/AccLiteral":300,"./Agg":306}],312:[function(e,module,t){var r=e("../../ext/Class");var a=e("./Agg");var n=e("../acc/AccMap");var i=r.create(a,{classLabel:"jassa.sponate.AggMap",initialize:function(e,t){this.keyBindingMapper=e;this.subAgg=t},clone:function(){var e=new i(this.keyBindingMapper,this.subAgg.clone());return e},getKeyBindingMapper:function(){return this.keyBindingMapper},getSubAgg:function(){return this.subAgg},getSubAggs:function(){return[this.subAgg]},createAcc:function(){var e=new n(this.keyBindingMapper,this.subAgg);return e},toString:function(){var e="["+this.keyExpr+" -> "+this.subAgg+"]";return e}});module.exports=i},{"../../ext/Class":2,"../acc/AccMap":301,"./Agg":306}],313:[function(e,module,t){var r=e("lodash.foreach");var a=e("../../ext/Class");var n=e("./Agg");var i=e("../acc/AccObject");var s=a.create(n,{classLabel:"jassa.sponate.AggObject",initialize:function(e){this.attrToAgg=e},clone:function(){var e={};r(this.attrToAgg,function(t,r){e[r]=t.clone()});var t=new s(e);return t},getAttrToAgg:function(){return this.attrToAgg},createAcc:function(){var e={};r(this.attrToAgg,function(t,r){var a=t.createAcc();e[r]=a});var t=new i(e);return t},getSubAggs:function(){var e=[];r(this.attrToAgg,function(t){e.push(t)});return e},toString:function(){var e=[];r(this.attrToAgg,function(t,r){e.push('"'+r+'": '+t)});var t="{"+e.join(",")+"}";return t}});module.exports=s},{"../../ext/Class":2,"../acc/AccObject":302,"./Agg":306,"lodash.foreach":432}],314:[function(e,module,t){var r=e("../../ext/Class");var a=e("./AggObject");var n=r.create(a,{initialize:function($super,e,t){$super(e);this.templateParser=t},add:function(e,t){var r=this.templateParser.parseAgg(t);this.attrToAgg[e]=r;return r},del:function(e){delete this.attrToAgg[e]}});module.exports=n},{"../../ext/Class":2,"./AggObject":313}],315:[function(e,module,t){var r=e("../../ext/Class");var a=e("../../rdf/NodeFactory");var n=e("../acc/AccRef");var i=e("./Agg");var s=r.create(i,{classLabel:"jassa.sponate.AggRef",initialize:function(e,t){this.bindingMapper=e;this.refSpec=t},clone:function(){var e=new s(this.bindingMapper,this.refSpec);return e},getBindingMapper:function(){return this.bindingMapper},setBindingMapper:function(e){this.bindingMapper=e},getRefSpec:function(){return this.refSpec},setRefSpec:function(e){this.refSpec=e},getSubAggs:function(){return[]},createAcc:function(){var e=new n(this.bindingMapper,this.refSpec);return e},toString:function(){return JSON.stringify(this)}});module.exports=s},{"../../ext/Class":2,"../../rdf/NodeFactory":92,"../acc/AccRef":303,"./Agg":306}],316:[function(e,module,t){var r=e("../../ext/Class");var a=e("../../rdf/NodeFactory");var n=e("../acc/AccTransform");var i=e("./Agg");var s=r.create(i,{classLabel:"jassa.sponate.AggTransform",initialize:function(e,t){this.subAgg=e;this.fn=t},clone:function(){var e=new s(this.subAgg.clone(),this.fn);return e},getSubAgg:function(){return this.subAgg},getSubAggs:function(){return[this.subAgg]},createAcc:function(){var e=this.subAgg.createAcc();var t=new n(e,this.fn);return t},toString:function(){return JSON.stringify(this)}});module.exports=s},{"../../ext/Class":2,"../../rdf/NodeFactory":92,"../acc/AccTransform":304,"./Agg":306}],317:[function(e,module,t){var r=e("../../ext/Class");var a=e("../../rdf/NodeFactory");var n=e("../acc/AccTransformLazy");var i=e("./Agg");var s=r.create(i,{classLabel:"jassa.sponate.AggTransformLazy",initialize:function(e,t){this.subAgg=e;this.fn=t},clone:function(){var e=new s(this.subAgg.clone(),this.fn);return e},getSubAgg:function(){return this.subAgg},getSubAggs:function(){return[this.subAgg]},createAcc:function(){var e=this.subAgg.createAcc();var t=new n(e,this.fn);return t},toString:function(){return JSON.stringify(this)}});module.exports=s},{"../../ext/Class":2,"../../rdf/NodeFactory":92,"../acc/AccTransformLazy":305,"./Agg":306}],318:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({map:function(e,t){throw new Error("Not overridden")}});module.exports=a},{"../../ext/Class":2}],319:[function(e,module,t){var r=e("../../ext/Class");var a=e("./BindingMapper");var n=r.create(a,{initialize:function(e){this.expr=e},getExpr:function(){return this.expr},map:function(e,t){var r=this.expr.eval(e);var a=r.asNode();return a}});module.exports=n},{"../../ext/Class":2,"./BindingMapper":318}],320:[function(e,module,t){var r=e("../../ext/Class");var a=e("./BindingMapper");var n=r.create(a,{map:function(e,t){return t}});module.exports=n},{"../../ext/Class":2,"./BindingMapper":318}],321:[function(e,module,t){var r=e("../../ext/Class");var a=e("./BindingMapper");var n=r.create(a,{initialize:function(e,t){this.subBindingMapper=e;this.fn=t},map:function(e,t){var r=this.subBindingMapper.map(e,t);var a=this.fn(r);return a}});module.exports=n},{"../../ext/Class":2,"./BindingMapper":318}],322:[function(e,module,t){var r=e("../../ext/Class");var a=e("./QueryFlow");var n=r.create({initialize:function(e,t){this.storeFacade=e;this.mappingName=t},getSource:function(){var e=this.storeFacade.getContext().getSource(this.mappingName);return e},getListService:function(){var e=this.storeFacade.getListService(this.mappingName);return e},find:function(e){if(e){throw new Error("Criteria queries are currently not supported anymore - Sorry :/")}var t=new a(this.storeFacade,this.mappingName,e);return t}});module.exports=n},{"../../ext/Class":2,"./QueryFlow":323}],323:[function(e,module,t){var r=e("../../ext/Class");var a=e("../Query");var n=e("../Engine");var i=r.create({initialize:function(e,t,r){this.storeFacade=e;this.query=new a;this.query.setSourceName(t);this.query.setCriteria(r)},concept:function(e,t){this.query.setFilterConcept(e);this.query.setLeftJoin(t);return this},nodes:function(e){this.query.setNodes(e);return this},skip:function(e){this.query.setOffset(e);return this},limit:function(e){this.query.setLimit(e);return this},offset:function(e){this.query.setOffset(e);return this},list:function(){var e=this.storeFacade.getContext();var t=n.exec(e,this.query);return t},count:function(){}});module.exports=i},{"../../ext/Class":2,"../Engine":284,"../Query":291}],324:[function(e,module,t){var r=e("../../ext/Class");var a=e("../../rdf/PrefixMappingImpl");var n=e("../../util/ObjectUtils");var i=e("../Context");var s=e("../Engine");var o=e("./CollectionFacade");var n=e("../../util/ObjectUtils");var l=r.create({initialize:function(e,t){this.defaultSparqlService=e;t=t?t instanceof a?t:new a(t):new a;this.context=new i(t)},getEngine:function(){return this.engine},getContext:function(){return this.context},addTemplate:function(e){this.context.addTemplate(e)},addMap:function(e){if(!e.service){n.extend({},e);e.service=this.defaultSparqlService}this.context.add(e);var t=e.name;this[t]=new o(this,t)},getListService:function(e,t){var r=s.createListService(this.context,e,t);return r}});module.exports=l},{"../../ext/Class":2,"../../rdf/PrefixMappingImpl":94,"../../util/ObjectUtils":331,"../Context":283,"../Engine":284,"./CollectionFacade":322}],325:[function(e,module,t){"use strict";var r={AccUtils:e("./AccUtils"),AggUtils:e("./AggUtils"),AttrPath:e("./AttrPath"),Context:e("./Context"),Engine:e("./Engine"),ListServiceUtils:e("./ListServiceUtils"),LookupServiceUtils:e("./LookupServiceUtils"),MappedConcept:e("./MappedConcept"),MappedConceptSource:e("./MappedConceptSource"),MappedConceptUtils:e("./MappedConceptUtils"),MappingRef:e("./MappingRef"),Query:e("./Query"),RefSpec:e("./RefSpec"),ServiceUtils:e("./ServiceUtils"),SponateUtils:e("./SponateUtils"),TemplateParser:e("./TemplateParser"),Acc:e("./acc/Acc"),AccArray:e("./acc/AccArray"),AccArrayStatic:e("./acc/AccArrayStatic"),AccBestLabel:e("./acc/AccBestLabel"),AccLiteral:e("./acc/AccLiteral"),AccMap:e("./acc/AccMap"),AccObject:e("./acc/AccObject"),AccRef:e("./acc/AccRef"),AccTransform:e("./acc/AccTransform"),AccTransformLazy:e("./acc/AccTransformLazy"),Agg:e("./agg/Agg"),AggArray:e("./agg/AggArray"),AggArrayStatic:e("./agg/AggArrayStatic"),AggBestLabel:e("./agg/AggBestLabel"),AggCustomAcc:e("./agg/AggCustomAcc"),AggLiteral:e("./agg/AggLiteral"),AggMap:e("./agg/AggMap"),AggObject:e("./agg/AggObject"),AggObjectCustom:e("./agg/AggObjectCustom"),AggRef:e("./agg/AggRef"),AggTransform:e("./agg/AggTransform"),AggTransformLazy:e("./agg/AggTransformLazy"),BindingMapper:e("./binding_mapper/BindingMapper"),BindingMapperExpr:e("./binding_mapper/BindingMapperExpr"),BindingMapperIndex:e("./binding_mapper/BindingMapperIndex"),BindingMapperTransform:e("./binding_mapper/BindingMapperTransform"),CollectionFacade:e("./facade/CollectionFacade"),QueryFlow:e("./facade/QueryFlow"),StoreFacade:e("./facade/StoreFacade")};Object.freeze(r);module.exports=r},{"./AccUtils":280,"./AggUtils":281,"./AttrPath":282,"./Context":283,"./Engine":284,"./ListServiceUtils":285,"./LookupServiceUtils":286,"./MappedConcept":287,"./MappedConceptSource":288,"./MappedConceptUtils":289,"./MappingRef":290,"./Query":291,"./RefSpec":292,"./ServiceUtils":293,"./SponateUtils":294,"./TemplateParser":295,"./acc/Acc":296,"./acc/AccArray":297,"./acc/AccArrayStatic":298,"./acc/AccBestLabel":299,"./acc/AccLiteral":300,"./acc/AccMap":301,"./acc/AccObject":302,"./acc/AccRef":303,"./acc/AccTransform":304,"./acc/AccTransformLazy":305,"./agg/Agg":306,"./agg/AggArray":307,"./agg/AggArrayStatic":308,"./agg/AggBestLabel":309,"./agg/AggCustomAcc":310,"./agg/AggLiteral":311,"./agg/AggMap":312,"./agg/AggObject":313,"./agg/AggObjectCustom":314,"./agg/AggRef":315,"./agg/AggTransform":316,"./agg/AggTransformLazy":317,"./binding_mapper/BindingMapper":318,"./binding_mapper/BindingMapperExpr":319,"./binding_mapper/BindingMapperIndex":320,"./binding_mapper/BindingMapperTransform":321,"./facade/CollectionFacade":322,"./facade/QueryFlow":323,"./facade/StoreFacade":324}],326:[function(e,module,t){var r=e("./ObjectUtils");var a={addAll:function(e,t){return e.push.apply(e,t)},chunk:function(e,t){var r=[];for(var a=0;a<e.length;a+=t){var n=e.slice(a,a+t);r.push(n)}return r},clear:function(e){while(e.length>0){e.pop()}},replace:function(e,t){this.clear(e);if(t){e.push.apply(e,t)}},filter:function(e,t){var r=e.filter(t);this.replace(e,r);return e},indexOf:function(e,t,a){a=a||r.isEqual;var n=-1;for(var i=0;i<e.length;++i){var s=e[i];if(a(t,s)){n=i;break}}return n},indexesOf:function(e,t,a){a=a||r.isEqual;var n=[];e.forEach(function(e,r){var i=a(t,e);if(i){n.push(r)}});return n},grep:function(e,t){var r=[];e.forEach(function(e,a){var n=t(e,a);if(n){r.push(a)}});return r},copyWithoutIndexes:function(e,t){var r={};t.forEach(function(e){r[e]=true});var a=[];for(var n=0;n<e.length;++n){var i=r[n];if(!i){a.push(e[n])}}return a},removeIndexes:function(e,t){var r=this.copyWithoutIndexes(e,t);this.replace(e,r);return e},removeByGrep:function(e,t){var r=this.grep(e,t);this.removeIndexes(e,r)}};module.exports=a},{"./ObjectUtils":331}],327:[function(e,module,t){var r={indexPredicates:function(e,t,r,a){r=r||{};var n=e.id.toString();var i=r[n];if(!i){i=n}var s=t[i];if(!s){s={id:i,valueToMember:{},sources:[]};t[i]=s}var o=s.sources;if(o.indexOf(a)<0){o.push(a)}var l=s.valueToMember;e.values.forEach(function(t){var r=t.id.toString();var n=l[r];if(!n){n={predicate:e.id,value:t,sources:[]};l[r]=n}var i=n.sources;if(i.indexOf(a)<0){i.push(a)}})},clusterLink:function(e,t,a){a=a||{};e.source.predicates.forEach(function(e){r.indexPredicates(e,a,t,"source")});e.target.predicates.forEach(function(e){r.indexPredicates(e,a,t,"target")});return a}};module.exports=r},{}],328:[function(e,module,t){var r={toggleItem:function(e,t){var r;if(e.contains(t)){e.remove(t);r=false}else{e.add(t);r=true}return r}};module.exports=r},{}],329:[function(e,module,t){var r=e("../ext/JSONCanonical");var a=function(e){var t=typeof e;return t==="function"||t==="object"&&Boolean(e)};var n={stringifyCyclic:function(e,t){var n=[];var i=r.stringify(e,function(e,r){if(a(r)){if(n.indexOf(r)>=0){return}n.push(r);if(t){r=t(e,r)}}return r});return i}};module.exports=n},{"../ext/JSONCanonical":3}],330:[function(e,module,t){var r=e("./collection/HashMap");var a=e("./ObjectUtils");var n={indexBy:function(e,t,n){n=n||new r;var i;if(a.isString(t)){i=function(e){return e[t]}}else{i=t}e.forEach(function(e){var t=i(e);n.put(t,e)});return n}};module.exports=n},{"./ObjectUtils":331,"./collection/HashMap":342}],331:[function(e,module,t){var r=e("lodash.isequal");var a=e("./JsonUtils");var n={isObject:function(e){var t=typeof e;return t==="function"||t==="object"&&Boolean(e)},isFunction:function(e){return typeof e==="function"},isString:function(e){return Object.prototype.toString.call(e)==="[object String]"},extend:function(e,t){for(var r in t){if(hasOwnProperty.call(t,r)){e[r]=t[r]}}return e},isEqual:function(e,t){var a;if(e&&e.equals){a=e.equals(t)}else if(t&&t.equals){a=t.equals(e)}else{a=r(e,t)}return a},defaultHashCode:function(e){var t;if(e&&e.hashCode){t=e.hashCode()}else{t=e.toString()}return t},identity:function(e){return e},hashCode:function(e,t){var r=a.stringifyCyclic(e,function(e,r){var a=null;if(!t&&n.isObject(r)){var i=null;n.defaultHashFnNames.some(function(e){if(n.isFunction(r[e])){i=e;return true}});var s=r[i];if(i&&s&&n.isFunction(s)){a=s.apply(r)}else{a=r}}else{a=r}if(t){t=false}return a});return r}};n.defaultHashFnNames=["hashCode"];module.exports=n},{"./JsonUtils":329,"lodash.isequal":462}],332:[function(e,module,t){var r=e("./StringUtils");var a={prefixPattern:/((\w|-)+):(\w|-)+/g,extractPrefixes:function(e){var t=r.extractAllRegexMatches(this.prefixPattern,e,1);return t},expandPrefixes:function(e,t){var r=this.extractPrefixes(t);var a=t;r.forEach(function(t){var r=e[t];if(r){var n=new RegExp(t+":(\\w+)","g");a=a.replace(n,"<"+r+"$1>")}});return a}};module.exports=a},{"./StringUtils":336}],333:[function(e,module,t){var r={};module.exports=r},{}],334:[function(e,module,t){var r=e("../ext/Class");var a=e("./collection/HashMap");var n=e("./ObjectUtils");var i=r.create({initialize:function(){this._nextId=1;this.objToId=new a(function(e,t){return e===t},function(e){return n.hashCode(e)});this.idToState={}},nextId:function(){var e=(this._nextId++).toString();return e},getIdToState:function(){return this.idToState},getObjToId:function(){return this.objToId}});module.exports=i},{"../ext/Class":2,"./ObjectUtils":331,"./collection/HashMap":342}],335:[function(e,module,t){var r=e("../ext/Class");var a=e("./ObjectUtils");var n=e("./SerializationContext");var i=r.create({initialize:function(){this.classNameToClass={};this.classNameToFnSerialize={};this.classNameToFnDeserialize={};this.classNameToPrototype={}},registerOverride:function(e,t,r){this.classNameToFnSerialize[e]=t;this.classNameToFnDeserialize[e]=r},indexClasses:function(e){var t=this.findClasses(e);a.extend(this.classNameToClass,t);return t},findClasses:function(e){var t={};e.forEach(function(e){var r=e.classLabel||(e.prototype?e.prototype.classLabel:null);if(r){t[r]=e}});return t},getLabelForClass:function(e){var t=Object.getPrototypeOf(e);var r;this.classNameToClass.find(function(e,a){if(t===e.prototype){r=a;return true}});return r},getClassForLabel:function(e){var t;this.classNameToClass.find(function(r,a){if(a===e){t=r;return true}});return t},serialize:function(e,t){t=t||new n;var r=this.serializeRec(e,t);var a={root:r,idToState:t.getIdToState()};return a},serializeRec:function(e,t){var r;var n=t.getObjToId();var i=n.get(e);if(!i){i=t.nextId();n.put(e,i)}var s=t.getIdToState();var o=s[i];if(o){r={ref:i}}else if(a.isFunction(e)){r=undefined}else if(a.isObject(e)){r={};var l=this.getLabelForClass(e);var c=function(e){var t=Boolean(e)||Object.toString.call(e)==="[object Number]"||Object.toString.call(e)==="[object Date]"||Object.toString.call(e)==="[object String]"||Object.toString.call(e)==="[object RegExp]";return t};var u=function(e){var t=e.prototype;var r=a.isObject(e)&&!c(e);var n=r&&t==null;return n};var d=c(e)||u(e)||Array.isArray(e);if(l==null&&!d){throw new Error("Failed to serialize instance without class label")}var p;if(l){p=this.classNameToPrototype[l];if(!p){var h=this.getClassForLabel(l);if(h){try{p=new h;this.classNameToPrototype[l]=p}catch(v){console.log("[WARN] Failed to create a prototype instance of class "+l,v)}}}}if(!p){p={}}var f=this.serializeAttrs(e,t,p);var g={};if(l){g.classLabel=l}if(Object.keys(f).length>0){g.attrs=f.attrs;if(f.parent!=null){g.parent=f.parent}}if(Array.isArray(e)){g.length=e.length}s[i]=g;r={ref:i}}else{r={value:e}}return r},serializeAttrs:function(e,t,r){var n={};var i=n;var s=i.attrs={};var o=this;var l=Object.keys(e);l.forEach(function(n){var i=e[n];var l=o.serializeRec(i,t);var c=r[n];var u=a.isEqual(l,c)||l==null&&c==null;if(u){return}if(l){s[n]=l}});return n},deserialize:function(e){var t=e.root;var r=e.idToState;var a={};var n=this.deserializeRef(t,r,a);return n},deserializeRef:function(e,t,r){var a=e.ref;var n=e.value;var i;if(a!=null){var s=a in r;if(s){i=r[a]}else{i=this.deserializeState(a,t,r)}}else{i=n}return i},deserializeState:function(e,t,r){var n;var i=t[e];if(i==null||!a.isObject(i)){console.log("State must be an object, was: ",i);throw new Error("Deserialization error")}var s=i.attrs;var o=i.classLabel;var l=i.length;if(o){var c=this.getClassForLabel(o);if(!c){throw new Error("Unknown class label encountered in deserialization: "+o)}n=new c}else if(l!=null){n=[]}else{n={}}r[e]=n;var u=this;if(s!=null){var d=Object.keys(s);d.forEach(function(e){var a=s[e];var i=u.deserializeRef(a,t,r);n[e]=i})}if(l!=null){n.length=l}return n}});module.exports=new i},{"../ext/Class":2,"./ObjectUtils":331,"./SerializationContext":334}],336:[function(e,module,t){var r=e("lodash.uniq");var a={extractAllRegexMatches:function(e,t,a){var n;var i=[];while((n=e.exec(t))!=null){i.push(n[a])}i=r(i);return i}};module.exports=a},{"lodash.uniq":582}],337:[function(e,module,t){var r={visitDepthFirst:function(e,t,a){var n=a(e);if(n){var i=t(e);i.forEach(function(e){r.visitDepthFirst(e,t,a)})}},flattenTree:function(e,t,r){if(r==null){r=[]}if(e){r.push(e)}var a=e[t];var n=this;if(a){a.forEach(function(e){n.flattenTree(e,t,r)})}return r}};module.exports=r},{}],338:[function(e,module,t){var r={extractLabel:function(e){var t=e.lastIndexOf("#");var r=e.lastIndexOf("/");var a=Math.max(t,r);var n=a===e.length?e:e.substring(a+1);if(n===""){n=e}return n}};module.exports=r},{}],339:[function(e,module,t){var r=e("../../ext/Class");var a=e("../ObjectUtils");var n=r.create({initialize:function(e){this.items=[];this.fnEquals=e||a.isEqual},setItems:function(e){this.items=e},getArray:function(){return this.items},get:function(e){var t=this.items[e];return t},add:function(e){this.items.push(e)},indexesOf:function(e){var t=this.items;var r=this.fnEquals;var a=[];t.forEach(function(t,n){var i=r(e,t);if(i){a.push(n)}});return a},contains:function(e){var t=this.indexesOf(e);var r=t.length>0;return r},firstIndexOf:function(e){var t=this.indexesOf(e);var r=t.length>0?t[0]:-1;return r},lastIndexOf:function(e){var t=this.indexesOf(e);var r=t.length>0?t[t.length-1]:-1;return r},remove:function(e){var t=this.firstIndexOf(e);if(t>=0){this.removeByIndex(t)}},removeByIndex:function(e){this.items.splice(e,1)},size:function(){return this.items.length}});module.exports=n},{"../../ext/Class":2,"../ObjectUtils":331}],340:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({initialize:function(e,t){this.key=e;this.value=t},getKey:function(){return this.key},getValue:function(){return this.value},toString:function(){return this.key+"->"+this.value}});module.exports=a},{"../../ext/Class":2}],341:[function(e,module,t){var r=e("../../ext/Class");var a=e("./HashMap");var n=r.create({initialize:function(e,t,r){this.forward=new a(e,t);this.inverse=r?r:new n(e,t,this)},getInverse:function(){return this.inverse},put:function(e,t){this.remove(e);this.forward.put(e,t);this.inverse.forward.put(t,e)},remove:function(e){var t=this.get(e);if(t!==null){this.inverse.forward.remove(t)}this.forward.remove(e)},getMap:function(){return this.forward},get:function(e){var t=this.forward.get(e);return t},keyList:function(){var e=this.forward.keys();return e}});module.exports=n},{"../../ext/Class":2,"./HashMap":342}],342:[function(e,module,t){var r=e("lodash.foreach");var a=e("../../ext/Class");var n=e("./../ObjectUtils");var i=a.create({initialize:function(e,t){this.fnEquals=e?e:n.isEqual;this.fnHash=t?t:n.hashCode;this.hashToBucket={};var r=this;this.fnGet=function(e){var t=r.get(e);return t}},clear:function(){this.hashToBucket={}},putAll:function(e){var t=this;e.entries().forEach(function(e){t.put(e.key,e.val)});return this},put:function(e,t){var r=this.fnHash(e);var a=this.hashToBucket[r];if(a==null){a=[];this.hashToBucket[r]=a}var n=this._indexOfKey(a,e);if(n>=0){a[n].val=t;return}var i={key:e,val:t};a.push(i)},_indexOfKey:function(e,t){if(e!=null){for(var r=0;r<e.length;++r){var a=e[r];var n=a.key;if(this.fnEquals(n,t)){return r}}}return-1},get:function(e){var t=this.fnHash(e);var r=this.hashToBucket[t];var a=this._indexOfKey(r,e);var n=a>=0?r[a].val:null;return n},remove:function(e){var t=this.fnHash(e);var r=this.hashToBucket[t];var a=this._indexOfKey(r,e);var n=a>=0;if(n){r.splice(a,1)}return n},containsKey:function(e){var t=this.fnHash(e);var r=this.hashToBucket[t];var a=this._indexOfKey(r,e)>=0;return a},keys:function(){var e=[];r(this.hashToBucket,function(t){var r=[];t.forEach(function(e){if(e.key){r.push(e.key)}});e.push.apply(e,r)});return e},values:function(){var e=this.entries();var t=e.map(function(e){return e.val});return t},entries:function(){var e=[];r(this.hashToBucket,function(t){e.push.apply(e,t)});return e},toString:function(){var e=this.entries();var t=e.map(function(e){return e.key+": "+e.val});var r="{"+t.join(", ")+"}";return r},asFn:function(){return this.fnGet}});module.exports=i},{"../../ext/Class":2,"./../ObjectUtils":331,"lodash.foreach":432}],343:[function(e,module,t){var r=e("../../ext/Class");var a=e("./HashMap");var n=r.create({initialize:function(e,t){this.map=new a(e,t)},add:function(e){this.map.put(e,true)},contains:function(e){var t=this.map.containsKey(e);return t},remove:function(e){this.map.remove(e)},entries:function(){var e=this.map.entries().map(function(e){return e.key});return e},clear:function(){this.map.clear()},toString:function(){var e=this.entries();var t="{"+e.join(", ")+"}";return t}});module.exports=n},{"../../ext/Class":2,"./HashMap":342}],344:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({next:function(){throw new Error("Not overridden")},hasNext:function(){throw new Error("Not overridden")}});module.exports=a},{"../../ext/Class":2}],345:[function(e,module,t){var r=e("../../ext/Class");var a=e("./Iterator");var n=r.create(a,{initialize:function(){this.current=null;this.advance=true;this.finished=false},finish:function(){this.finished=true;this.close();return null},$prefetch:function(){this.current=this.prefetch()},hasNext:function(){if(this.advance){this.$prefetch();this.advance=false}return this.finished===false},next:function(){if(this.finished){throw new Error("No more elments")}if(this.advance){this.$prefetch()}this.advance=true;return this.current},prefetch:function(){throw new Error("Not overridden")}});module.exports=n},{"../../ext/Class":2,"./Iterator":344}],346:[function(e,module,t){var r=e("../../ext/Class");var a=e("./Iterator");var n=r.create(a,{initialize:function(e,t){this.array=e;this.offset=t?t:0},getArray:function(){return this.array},hasNext:function(){var e=this.offset<this.array.length;return e},next:function(){var e=this.hasNext();var t;if(e){t=this.array[this.offset];++this.offset}else{t=null}return t}});module.exports=n},{"../../ext/Class":2,"./Iterator":344}],347:[function(e,module,t){var r=e("../../ext/Class");var a=e("./HashMap");var n=r.create({initialize:function(e,t){this.map=new a(e,t);this.keys=[]},put:function(e,t){var r=this.map.get(e);if(r){throw new Error("Key "+e+" already inserted")}this.keys.push(e);this.map.put(e,t)},get:function(e){var t=this.map.get(e);return t},getByIndex:function(e){var t=this.keys[e];var r=this.map.get(t);return r},entries:function(){var e=this;var t=this.keys.map(function(t){var r=e.map.get(t);var a={key:t,val:r};return a});return t},remove:function(e){for(var t=0;t<this.keys.length;t++){var r=this.keys[t];if(r===e){this.keys.splice(t,1);break}}this.map.remove(e)},removeByIndex:function(e){var t=this.keys[e];this.remove(t)},keyList:function(){return this.keys},size:function(){return this.keys.length}});module.exports=n},{"../../ext/Class":2,"./HashMap":342}],348:[function(e,module,t){var r=e("../../ext/Class");var a=r.create({initialize:function(){this.entries={}},clone:function(){var e=new a;e.addMultiMap(this);return e},clear:function(){var e=Object.keys(this.entries);var t=this;e.forEach(function(e){delete t.entries[e]})},addMultiMap:function(e){for(var t in e.entries){var r=e.entries[t];for(var a=0;a<r.length;++a){var n=r[a];this.put(t,n)}}},get:function(e){return e in this.entries?this.entries[e]:[]},put:function(e,t){var r;if(e in this.entries){r=this.entries[e]}else{r=[];this.entries[e]=r}r.push(t)},removeKey:function(e){delete this.entries[e]}});module.exports=a},{"../../ext/Class":2}],349:[function(e,module,t){"use strict";var r={ArrayUtils:e("./ArrayUtils"),ClusterUtils:e("./ClusterUtils"),CollectionUtils:e("./CollectionUtils"),JsonUtils:e("./JsonUtils"),MapUtils:e("./MapUtils"),ObjectUtils:e("./ObjectUtils"),PrefixUtils:e("./PrefixUtils"),PromiseUtils:e("./PromiseUtils"),SerializationContext:e("./SerializationContext"),Serializer:e("./Serializer"),StringUtils:e("./StringUtils"),TreeUtils:e("./TreeUtils"),UriUtils:e("./UriUtils"),shared:e("./shared"),ArrayList:e("./collection/ArrayList"),Entry:e("./collection/Entry"),HashBidiMap:e("./collection/HashBidiMap"),HashMap:e("./collection/HashMap"),HashSet:e("./collection/HashSet"),Iterator:e("./collection/Iterator"),IteratorAbstract:e("./collection/IteratorAbstract"),IteratorArray:e("./collection/IteratorArray"),ListMap:e("./collection/ListMap"),MultiMapObjectArray:e("./collection/MultiMapObjectArray")};Object.freeze(r);module.exports=r},{"./ArrayUtils":326,"./ClusterUtils":327,"./CollectionUtils":328,"./JsonUtils":329,"./MapUtils":330,"./ObjectUtils":331,"./PrefixUtils":332,"./PromiseUtils":333,"./SerializationContext":334,"./Serializer":335,"./StringUtils":336,"./TreeUtils":337,"./UriUtils":338,"./collection/ArrayList":339,"./collection/Entry":340,"./collection/HashBidiMap":341,"./collection/HashMap":342,"./collection/HashSet":343,"./collection/Iterator":344,"./collection/IteratorAbstract":345,"./collection/IteratorArray":346,"./collection/ListMap":347,"./collection/MultiMapObjectArray":348,"./shared":350}],350:[function(e,module,t){var r={Promise:null,ajax:function(){throw new Error("not set!")}};module.exports=r},{}],351:[function(e,module,t){"use strict";var r={owl:e("./owl"),rdf:e("./rdf"),rdfs:e("./rdfs"),wgs84:e("./wgs84"),xsd:e("./xsd")};Object.freeze(r);module.exports=r},{"./owl":352,"./rdf":353,"./rdfs":354,"./wgs84":355,"./xsd":356}],352:[function(e,module,t){var r=e("../rdf/NodeFactory");var a="http://www.w3.org/2002/07/owl#";var n={Class:r.createUri(a+"Class"),DatatypeProperty:r.createUri(a+"DatatypeProperty"),ObjectProperty:r.createUri(a+"ObjectProperty"),AnnotationProperty:r.createUri(a+"AnnotationProperty")};module.exports=n},{"../rdf/NodeFactory":92}],353:[function(e,module,t){var r=e("../rdf/NodeFactory");var a="http://www.w3.org/1999/02/22-rdf-syntax-ns#";var n={type:r.createUri(a+"type"),Property:r.createUri(a+"Property")};module.exports=n},{"../rdf/NodeFactory":92}],354:[function(e,module,t){var r=e("../rdf/NodeFactory");var a="http://www.w3.org/2000/01/rdf-schema#";var n={label:r.createUri(a+"label"),comment:r.createUri(a+"comment"),subClassOf:r.createUri(a+"subClassOf")};module.exports=n},{"../rdf/NodeFactory":92}],355:[function(e,module,t){var r=e("../rdf/NodeFactory");var a="http://www.w3.org/2003/01/geo/wgs84_pos#";var n={lon:r.createUri(a+"long"),lat:r.createUri(a+"lat")};module.exports=n},{"../rdf/NodeFactory":92}],356:[function(e,module,t){var r="http://www.w3.org/2001/XMLSchema#";var a=e("../rdf/node/Node_Uri");var n={xboolean:new a(r+"boolean"),xint:new a(r+"int"),xinteger:new a(r+"integer"),xlong:new a(r+"long"),decimal:new a(r+"decimal"),xfloat:new a(r+"float"),xdouble:new a(r+"double"),xstring:new a(r+"string"),date:new a(r+"date"),dateTime:new a(r+"dateTime")};module.exports=n},{"../rdf/node/Node_Uri":109}],357:[function(e,module,t){var r=e("lodash.keys"),a=e("lodash._objecttypes");var n=function(e,t,n){var i,s=e,o=s;if(!s)return o;var l=arguments,c=0,u=typeof n=="number"?2:l.length;while(++c<u){s=l[c];if(s&&a[typeof s]){var d=-1,p=a[typeof s]&&r(s),h=p?p.length:0;while(++d<h){i=p[d];if(typeof o[i]=="undefined")o[i]=s[i]}}}return o};module.exports=n},{"lodash._objecttypes":358,"lodash.keys":359}],358:[function(e,module,t){var r={"boolean":false,"function":true,object:true,number:false,string:false,undefined:false};module.exports=r},{}],359:[function(e,module,t){var r=e("lodash._isnative"),a=e("lodash.isobject"),n=e("lodash._shimkeys");var i=r(i=Object.keys)&&i;var s=!i?n:function(e){if(!a(e)){return[]}return i(e)};module.exports=s},{"lodash._isnative":360,"lodash._shimkeys":361,"lodash.isobject":362}],360:[function(e,module,t){var r=Object.prototype;var a=r.toString;var n=RegExp("^"+String(a).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$");function i(e){return typeof e=="function"&&n.test(e)}module.exports=i},{}],361:[function(e,module,t){var r=e("lodash._objecttypes");var a=Object.prototype;var n=a.hasOwnProperty;var i=function(e){var t,a=e,i=[];if(!a)return i;if(!r[typeof e])return i;for(t in a){if(n.call(a,t)){i.push(t)}}return i};module.exports=i},{"lodash._objecttypes":358}],362:[function(e,module,t){var r=e("lodash._objecttypes");function a(e){return!!(e&&r[typeof e])}module.exports=a},{"lodash._objecttypes":358}],363:[function(e,module,t){var r=e("lodash._baseflatten"),a=e("lodash.map");function n(e,t,n,i){if(typeof t!="boolean"&&t!=null){i=n;n=typeof t!="function"&&i&&i[t]===e?null:t;t=false}if(n!=null){e=a(e,n,i)}return r(e,t)}module.exports=n},{"lodash._baseflatten":364,"lodash.map":368}],364:[function(e,module,t){var r=e("lodash.isarguments"),a=e("lodash.isarray");function n(e,t,i,s){var o=(s||0)-1,l=e?e.length:0,c=[];
while(++o<l){var u=e[o];if(u&&typeof u=="object"&&typeof u.length=="number"&&(a(u)||r(u))){if(!t){u=n(u,t,i)}var d=-1,p=u.length,h=c.length;c.length+=p;while(++d<p){c[h++]=u[d]}}else if(!i){c.push(u)}}return c}module.exports=n},{"lodash.isarguments":365,"lodash.isarray":366}],365:[function(e,module,t){var r="[object Arguments]";var a=Object.prototype;var n=a.toString;function i(e){return e&&typeof e=="object"&&typeof e.length=="number"&&n.call(e)==r||false}module.exports=i},{}],366:[function(e,module,t){var r=e("lodash._isnative");var a="[object Array]";var n=Object.prototype;var i=n.toString;var s=r(s=Array.isArray)&&s;var o=s||function(e){return e&&typeof e=="object"&&typeof e.length=="number"&&i.call(e)==a||false};module.exports=o},{"lodash._isnative":367}],367:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],368:[function(e,module,t){var r=e("lodash.createcallback"),a=e("lodash.forown");function n(e,t,n){var i=-1,s=e?e.length:0;t=r(t,n,3);if(typeof s=="number"){var o=Array(s);while(++i<s){o[i]=t(e[i],i,e)}}else{o=[];a(e,function(e,r,a){o[++i]=t(e,r,a)})}return o}module.exports=n},{"lodash.createcallback":369,"lodash.forown":405}],369:[function(e,module,t){var r=e("lodash._basecreatecallback"),a=e("lodash._baseisequal"),n=e("lodash.isobject"),i=e("lodash.keys"),s=e("lodash.property");function o(e,t,o){var l=typeof e;if(e==null||l=="function"){return r(e,t,o)}if(l!="object"){return s(e)}var c=i(e),u=c[0],d=e[u];if(c.length==1&&d===d&&!n(d)){return function(e){var t=e[u];return d===t&&(d!==0||1/d==1/t)}}return function(t){var r=c.length,n=false;while(r--){if(!(n=a(t[c[r]],e[c[r]],null,true))){break}}return n}}module.exports=o},{"lodash._basecreatecallback":370,"lodash._baseisequal":389,"lodash.isobject":398,"lodash.keys":400,"lodash.property":404}],370:[function(e,module,t){var r=e("lodash.bind"),a=e("lodash.identity"),n=e("lodash._setbinddata"),i=e("lodash.support");var s=/^\s*function[ \n\r\t]+\w/;var o=/\bthis\b/;var l=Function.prototype.toString;function c(e,t,c){if(typeof e!="function"){return a}if(typeof t=="undefined"||!("prototype"in e)){return e}var u=e.__bindData__;if(typeof u=="undefined"){if(i.funcNames){u=!e.name}u=u||!i.funcDecomp;if(!u){var d=l.call(e);if(!i.funcNames){u=!s.test(d)}if(!u){u=o.test(d);n(e,u)}}}if(u===false||u!==true&&u[1]&1){return e}switch(c){case 1:return function(r){return e.call(t,r)};case 2:return function(r,a){return e.call(t,r,a)};case 3:return function(r,a,n){return e.call(t,r,a,n)};case 4:return function(r,a,n,i){return e.call(t,r,a,n,i)}}return r(e,t)}module.exports=c},{"lodash._setbinddata":371,"lodash.bind":374,"lodash.identity":386,"lodash.support":387}],371:[function(e,module,t){var r=e("lodash._isnative"),a=e("lodash.noop");var n={configurable:false,enumerable:false,value:null,writable:false};var i=function(){try{var e={},t=r(t=Object.defineProperty)&&t,a=t(e,e,e)&&t}catch(n){}return a}();var s=!i?a:function(e,t){n.value=t;i(e,"__bindData__",n)};module.exports=s},{"lodash._isnative":372,"lodash.noop":373}],372:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],373:[function(e,module,t){function r(){}module.exports=r},{}],374:[function(e,module,t){var r=e("lodash._createwrapper"),a=e("lodash._slice");function n(e,t){return arguments.length>2?r(e,17,a(arguments,2),null,t):r(e,1,null,null,t)}module.exports=n},{"lodash._createwrapper":375,"lodash._slice":385}],375:[function(e,module,t){var r=e("lodash._basebind"),a=e("lodash._basecreatewrapper"),n=e("lodash.isfunction"),i=e("lodash._slice");var s=[];var o=s.push,l=s.unshift;function c(e,t,s,u,d,p){var h=t&1,v=t&2,f=t&4,g=t&8,m=t&16,x=t&32;if(!v&&!n(e)){throw new TypeError}if(m&&!s.length){t&=~16;m=s=false}if(x&&!u.length){t&=~32;x=u=false}var _=e&&e.__bindData__;if(_&&_!==true){_=i(_);if(_[2]){_[2]=i(_[2])}if(_[3]){_[3]=i(_[3])}if(h&&!(_[1]&1)){_[4]=d}if(!h&&_[1]&1){t|=8}if(f&&!(_[1]&4)){_[5]=p}if(m){o.apply(_[2]||(_[2]=[]),s)}if(x){l.apply(_[3]||(_[3]=[]),u)}_[1]|=t;return c.apply(null,_)}var b=t==1||t===17?r:a;return b([e,t,s,u,d,p])}module.exports=c},{"lodash._basebind":376,"lodash._basecreatewrapper":380,"lodash._slice":385,"lodash.isfunction":384}],376:[function(e,module,t){var r=e("lodash._basecreate"),a=e("lodash.isobject"),n=e("lodash._setbinddata"),i=e("lodash._slice");var s=[];var o=s.push;function l(e){var t=e[0],s=e[2],l=e[4];function c(){if(s){var e=i(s);o.apply(e,arguments)}if(this instanceof c){var n=r(t.prototype),u=t.apply(n,e||arguments);return a(u)?u:n}return t.apply(l,e||arguments)}n(c,e);return c}module.exports=l},{"lodash._basecreate":377,"lodash._setbinddata":371,"lodash._slice":385,"lodash.isobject":398}],377:[function(e,module,t){(function(t){var r=e("lodash._isnative"),a=e("lodash.isobject"),n=e("lodash.noop");var i=r(i=Object.create)&&i;function s(e,t){return a(e)?i(e):{}}if(!i){s=function(){function e(){}return function(r){if(a(r)){e.prototype=r;var n=new e;e.prototype=null}return n||t.Object()}}()}module.exports=s}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"lodash._isnative":378,"lodash.isobject":398,"lodash.noop":379}],378:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],379:[function(e,module,t){module.exports=e(373)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/node_modules/lodash.noop/index.js":373}],380:[function(e,module,t){var r=e("lodash._basecreate"),a=e("lodash.isobject"),n=e("lodash._setbinddata"),i=e("lodash._slice");var s=[];var o=s.push;function l(e){var t=e[0],s=e[1],c=e[2],u=e[3],d=e[4],p=e[5];var h=s&1,v=s&2,f=s&4,g=s&8,m=t;function x(){var e=h?d:this;if(c){var n=i(c);o.apply(n,arguments)}if(u||f){n||(n=i(arguments));if(u){o.apply(n,u)}if(f&&n.length<p){s|=16&~32;return l([t,g?s:s&~3,n,null,d,p])}}n||(n=arguments);if(v){t=e[m]}if(this instanceof x){e=r(t.prototype);var _=t.apply(e,n);return a(_)?_:e}return t.apply(e,n)}n(x,e);return x}module.exports=l},{"lodash._basecreate":381,"lodash._setbinddata":371,"lodash._slice":385,"lodash.isobject":398}],381:[function(e,module,t){module.exports=e(377)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash._basebind/node_modules/lodash._basecreate/index.js":377,"lodash._isnative":382,"lodash.isobject":398,"lodash.noop":383}],382:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],383:[function(e,module,t){module.exports=e(373)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/node_modules/lodash.noop/index.js":373}],384:[function(e,module,t){function r(e){return typeof e=="function"}module.exports=r},{}],385:[function(e,module,t){function r(e,t,r){t||(t=0);if(typeof r=="undefined"){r=e?e.length:0}var a=-1,n=r-t||0,i=Array(n<0?0:n);while(++a<n){i[a]=e[t+a]}return i}module.exports=r},{}],386:[function(e,module,t){function r(e){return e}module.exports=r},{}],387:[function(e,module,t){(function(t){var r=e("lodash._isnative");var a=/\bthis\b/;var n={};n.funcDecomp=!r(t.WinRTError)&&a.test(function(){return this});n.funcNames=typeof Function.name=="string";module.exports=n}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"lodash._isnative":388}],388:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],389:[function(e,module,t){var r=e("lodash.forin"),a=e("lodash._getarray"),n=e("lodash.isfunction"),i=e("lodash._objecttypes"),s=e("lodash._releasearray");var o="[object Arguments]",l="[object Array]",c="[object Boolean]",u="[object Date]",d="[object Number]",p="[object Object]",h="[object RegExp]",v="[object String]";var f=Object.prototype;var g=f.toString;var m=f.hasOwnProperty;function x(e,t,f,_,b,y){if(f){var S=f(e,t);if(typeof S!="undefined"){return!!S}}if(e===t){return e!==0||1/e==1/t}var C=typeof e,E=typeof t;if(e===e&&!(e&&i[C])&&!(t&&i[E])){return false}if(e==null||t==null){return e===t}var w=g.call(e),k=g.call(t);if(w==o){w=p}if(k==o){k=p}if(w!=k){return false}switch(w){case c:case u:return+e==+t;case d:return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case h:case v:return e==String(t)}var L=w==l;if(!L){var q=m.call(e,"__wrapped__"),j=m.call(t,"__wrapped__");if(q||j){return x(q?e.__wrapped__:e,j?t.__wrapped__:t,f,_,b,y)}if(w!=p){return false}var A=e.constructor,F=t.constructor;if(A!=F&&!(n(A)&&A instanceof A&&n(F)&&F instanceof F)&&("constructor"in e&&"constructor"in t)){return false}}var T=!b;b||(b=a());y||(y=a());var U=b.length;while(U--){if(b[U]==e){return y[U]==t}}var V=0;S=true;b.push(e);y.push(t);if(L){U=e.length;V=t.length;S=V==U;if(S||_){while(V--){var N=U,M=t[V];if(_){while(N--){if(S=x(e[N],M,f,_,b,y)){break}}}else if(!(S=x(e[V],M,f,_,b,y))){break}}}}else{r(t,function(t,r,a){if(m.call(a,r)){V++;return S=m.call(e,r)&&x(e[r],t,f,_,b,y)}});if(S&&!_){r(e,function(e,t,r){if(m.call(r,t)){return S=--V>-1}})}}b.pop();y.pop();if(T){s(b);s(y)}return S}module.exports=x},{"lodash._getarray":390,"lodash._objecttypes":392,"lodash._releasearray":393,"lodash.forin":396,"lodash.isfunction":397}],390:[function(e,module,t){var r=e("lodash._arraypool");function a(){return r.pop()||[]}module.exports=a},{"lodash._arraypool":391}],391:[function(e,module,t){var r=[];module.exports=r},{}],392:[function(e,module,t){module.exports=e(358)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash._objecttypes/index.js":358}],393:[function(e,module,t){var r=e("lodash._arraypool"),a=e("lodash._maxpoolsize");function n(e){e.length=0;if(r.length<a){r.push(e)}}module.exports=n},{"lodash._arraypool":394,"lodash._maxpoolsize":395}],394:[function(e,module,t){module.exports=e(391)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/node_modules/lodash._getarray/node_modules/lodash._arraypool/index.js":391}],395:[function(e,module,t){var r=40;module.exports=r},{}],396:[function(e,module,t){var r=e("lodash._basecreatecallback"),a=e("lodash._objecttypes");var n=function(e,t,n){var i,s=e,o=s;if(!s)return o;if(!a[typeof s])return o;t=t&&typeof n=="undefined"?t:r(t,n,3);for(i in s){if(t(s[i],i,e)===false)return o}return o};module.exports=n},{"lodash._basecreatecallback":370,"lodash._objecttypes":392}],397:[function(e,module,t){module.exports=e(384)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash.isfunction/index.js":384}],398:[function(e,module,t){module.exports=e(362)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash.isobject/index.js":362,"lodash._objecttypes":399}],399:[function(e,module,t){module.exports=e(358)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash._objecttypes/index.js":358}],400:[function(e,module,t){module.exports=e(359)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/index.js":359,"lodash._isnative":401,"lodash._shimkeys":402,"lodash.isobject":398}],401:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],402:[function(e,module,t){module.exports=e(361)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._shimkeys/index.js":361,"lodash._objecttypes":403}],403:[function(e,module,t){module.exports=e(358)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash._objecttypes/index.js":358}],404:[function(e,module,t){function r(e){return function(t){return t[e]}}module.exports=r},{}],405:[function(e,module,t){var r=e("lodash._basecreatecallback"),a=e("lodash.keys"),n=e("lodash._objecttypes");var i=function(e,t,i){var s,o=e,l=o;if(!o)return l;if(!n[typeof o])return l;t=t&&typeof i=="undefined"?t:r(t,i,3);var c=-1,u=n[typeof o]&&a(o),d=u?u.length:0;while(++c<d){s=u[c];if(t(o[s],s,e)===false)return l}return l};module.exports=i},{"lodash._basecreatecallback":406,"lodash._objecttypes":427,"lodash.keys":428}],406:[function(e,module,t){module.exports=e(370)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/index.js":370,"lodash._setbinddata":407,"lodash.bind":410,"lodash.identity":424,"lodash.support":425}],407:[function(e,module,t){module.exports=e(371)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/index.js":371,"lodash._isnative":408,"lodash.noop":409}],408:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],409:[function(e,module,t){module.exports=e(373)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/node_modules/lodash.noop/index.js":373}],410:[function(e,module,t){module.exports=e(374)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/index.js":374,"lodash._createwrapper":411,"lodash._slice":423}],411:[function(e,module,t){module.exports=e(375)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/index.js":375,"lodash._basebind":412,"lodash._basecreatewrapper":417,"lodash._slice":423,"lodash.isfunction":422}],412:[function(e,module,t){module.exports=e(376)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash._basebind/index.js":376,"lodash._basecreate":413,"lodash._setbinddata":407,"lodash._slice":423,"lodash.isobject":416}],413:[function(e,module,t){module.exports=e(377)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash._basebind/node_modules/lodash._basecreate/index.js":377,"lodash._isnative":414,"lodash.isobject":416,"lodash.noop":415}],414:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],415:[function(e,module,t){module.exports=e(373)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/node_modules/lodash.noop/index.js":373}],416:[function(e,module,t){module.exports=e(362)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash.isobject/index.js":362,"lodash._objecttypes":427}],417:[function(e,module,t){module.exports=e(380)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash._basecreatewrapper/index.js":380,"lodash._basecreate":418,"lodash._setbinddata":407,"lodash._slice":423,"lodash.isobject":421}],418:[function(e,module,t){module.exports=e(377)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash._basebind/node_modules/lodash._basecreate/index.js":377,"lodash._isnative":419,"lodash.isobject":421,"lodash.noop":420}],419:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],420:[function(e,module,t){module.exports=e(373)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/node_modules/lodash.noop/index.js":373}],421:[function(e,module,t){module.exports=e(362)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash.isobject/index.js":362,"lodash._objecttypes":427}],422:[function(e,module,t){module.exports=e(384)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash.isfunction/index.js":384}],423:[function(e,module,t){module.exports=e(385)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._slice/index.js":385}],424:[function(e,module,t){module.exports=e(386)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.identity/index.js":386}],425:[function(e,module,t){module.exports=e(387)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.support/index.js":387,"lodash._isnative":426}],426:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],427:[function(e,module,t){module.exports=e(358)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash._objecttypes/index.js":358}],428:[function(e,module,t){module.exports=e(359)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/index.js":359,"lodash._isnative":429,"lodash._shimkeys":430,"lodash.isobject":431}],429:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],430:[function(e,module,t){module.exports=e(361)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._shimkeys/index.js":361,"lodash._objecttypes":427}],431:[function(e,module,t){module.exports=e(362)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash.isobject/index.js":362,"lodash._objecttypes":427}],432:[function(e,module,t){var r=e("lodash._basecreatecallback"),a=e("lodash.forown");function n(e,t,n){var i=-1,s=e?e.length:0;t=t&&typeof n=="undefined"?t:r(t,n,3);if(typeof s=="number"){while(++i<s){if(t(e[i],i,e)===false){break}}}else{a(e,t)}return e}module.exports=n},{"lodash._basecreatecallback":433,"lodash.forown":456}],433:[function(e,module,t){module.exports=e(370)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/index.js":370,"lodash._setbinddata":434,"lodash.bind":437,"lodash.identity":453,"lodash.support":454}],434:[function(e,module,t){module.exports=e(371)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/index.js":371,"lodash._isnative":435,"lodash.noop":436}],435:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],436:[function(e,module,t){module.exports=e(373)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/node_modules/lodash.noop/index.js":373}],437:[function(e,module,t){module.exports=e(374)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/index.js":374,"lodash._createwrapper":438,"lodash._slice":452}],438:[function(e,module,t){module.exports=e(375)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/index.js":375,"lodash._basebind":439,"lodash._basecreatewrapper":445,"lodash._slice":452,"lodash.isfunction":451}],439:[function(e,module,t){module.exports=e(376)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash._basebind/index.js":376,"lodash._basecreate":440,"lodash._setbinddata":434,"lodash._slice":452,"lodash.isobject":443}],440:[function(e,module,t){module.exports=e(377)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash._basebind/node_modules/lodash._basecreate/index.js":377,"lodash._isnative":441,"lodash.isobject":443,"lodash.noop":442}],441:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],442:[function(e,module,t){module.exports=e(373)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/node_modules/lodash.noop/index.js":373}],443:[function(e,module,t){module.exports=e(362)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash.isobject/index.js":362,"lodash._objecttypes":444}],444:[function(e,module,t){module.exports=e(358)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash._objecttypes/index.js":358}],445:[function(e,module,t){module.exports=e(380)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash._basecreatewrapper/index.js":380,"lodash._basecreate":446,"lodash._setbinddata":434,"lodash._slice":452,"lodash.isobject":449}],446:[function(e,module,t){module.exports=e(377)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash._basebind/node_modules/lodash._basecreate/index.js":377,"lodash._isnative":447,"lodash.isobject":449,"lodash.noop":448}],447:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],448:[function(e,module,t){module.exports=e(373)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/node_modules/lodash.noop/index.js":373}],449:[function(e,module,t){module.exports=e(362)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash.isobject/index.js":362,"lodash._objecttypes":450}],450:[function(e,module,t){module.exports=e(358)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash._objecttypes/index.js":358}],451:[function(e,module,t){module.exports=e(384)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash.isfunction/index.js":384}],452:[function(e,module,t){module.exports=e(385)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._slice/index.js":385}],453:[function(e,module,t){module.exports=e(386)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.identity/index.js":386}],454:[function(e,module,t){module.exports=e(387)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.support/index.js":387,"lodash._isnative":455}],455:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],456:[function(e,module,t){module.exports=e(405)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.forown/index.js":405,"lodash._basecreatecallback":433,"lodash._objecttypes":457,"lodash.keys":458}],457:[function(e,module,t){module.exports=e(358)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash._objecttypes/index.js":358}],458:[function(e,module,t){module.exports=e(359)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/index.js":359,"lodash._isnative":459,"lodash._shimkeys":460,"lodash.isobject":461}],459:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],460:[function(e,module,t){module.exports=e(361)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._shimkeys/index.js":361,"lodash._objecttypes":457}],461:[function(e,module,t){module.exports=e(362)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash.isobject/index.js":362,"lodash._objecttypes":457}],462:[function(e,module,t){var r=e("lodash._basecreatecallback"),a=e("lodash._baseisequal");function n(e,t,n,i){return a(e,t,typeof n=="function"&&r(n,i,2))}module.exports=n},{"lodash._basecreatecallback":463,"lodash._baseisequal":486}],463:[function(e,module,t){module.exports=e(370)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/index.js":370,"lodash._setbinddata":464,"lodash.bind":467,"lodash.identity":483,"lodash.support":484}],464:[function(e,module,t){module.exports=e(371)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/index.js":371,"lodash._isnative":465,"lodash.noop":466}],465:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],466:[function(e,module,t){module.exports=e(373)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/node_modules/lodash.noop/index.js":373}],467:[function(e,module,t){module.exports=e(374)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/index.js":374,"lodash._createwrapper":468,"lodash._slice":482}],468:[function(e,module,t){module.exports=e(375)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/index.js":375,"lodash._basebind":469,"lodash._basecreatewrapper":475,"lodash._slice":482,"lodash.isfunction":481}],469:[function(e,module,t){module.exports=e(376)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash._basebind/index.js":376,"lodash._basecreate":470,"lodash._setbinddata":464,"lodash._slice":482,"lodash.isobject":473}],470:[function(e,module,t){module.exports=e(377)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash._basebind/node_modules/lodash._basecreate/index.js":377,"lodash._isnative":471,"lodash.isobject":473,"lodash.noop":472}],471:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],472:[function(e,module,t){module.exports=e(373)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/node_modules/lodash.noop/index.js":373}],473:[function(e,module,t){module.exports=e(362)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash.isobject/index.js":362,"lodash._objecttypes":474}],474:[function(e,module,t){module.exports=e(358)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash._objecttypes/index.js":358}],475:[function(e,module,t){module.exports=e(380)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash._basecreatewrapper/index.js":380,"lodash._basecreate":476,"lodash._setbinddata":464,"lodash._slice":482,"lodash.isobject":479}],476:[function(e,module,t){module.exports=e(377)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash._basebind/node_modules/lodash._basecreate/index.js":377,"lodash._isnative":477,"lodash.isobject":479,"lodash.noop":478}],477:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],478:[function(e,module,t){module.exports=e(373)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/node_modules/lodash.noop/index.js":373}],479:[function(e,module,t){module.exports=e(362)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash.isobject/index.js":362,"lodash._objecttypes":480}],480:[function(e,module,t){module.exports=e(358)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash._objecttypes/index.js":358}],481:[function(e,module,t){module.exports=e(384)
},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash.isfunction/index.js":384}],482:[function(e,module,t){module.exports=e(385)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._slice/index.js":385}],483:[function(e,module,t){module.exports=e(386)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.identity/index.js":386}],484:[function(e,module,t){module.exports=e(387)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.support/index.js":387,"lodash._isnative":485}],485:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],486:[function(e,module,t){module.exports=e(389)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/index.js":389,"lodash._getarray":487,"lodash._objecttypes":489,"lodash._releasearray":490,"lodash.forin":493,"lodash.isfunction":494}],487:[function(e,module,t){module.exports=e(390)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/node_modules/lodash._getarray/index.js":390,"lodash._arraypool":488}],488:[function(e,module,t){module.exports=e(391)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/node_modules/lodash._getarray/node_modules/lodash._arraypool/index.js":391}],489:[function(e,module,t){module.exports=e(358)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash._objecttypes/index.js":358}],490:[function(e,module,t){module.exports=e(393)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/node_modules/lodash._releasearray/index.js":393,"lodash._arraypool":491,"lodash._maxpoolsize":492}],491:[function(e,module,t){module.exports=e(391)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/node_modules/lodash._getarray/node_modules/lodash._arraypool/index.js":391}],492:[function(e,module,t){module.exports=e(395)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/node_modules/lodash._releasearray/node_modules/lodash._maxpoolsize/index.js":395}],493:[function(e,module,t){module.exports=e(396)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/node_modules/lodash.forin/index.js":396,"lodash._basecreatecallback":463,"lodash._objecttypes":489}],494:[function(e,module,t){module.exports=e(384)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash.isfunction/index.js":384}],495:[function(e,module,t){var r=e("lodash.createcallback"),a=e("lodash.forown");function n(e,t,n,i){if(!e)return n;var s=arguments.length<3;t=r(t,i,4);var o=-1,l=e.length;if(typeof l=="number"){if(s){n=e[++o]}while(++o<l){n=t(n,e[o],o,e)}}else{a(e,function(e,r,a){n=s?(s=false,e):t(n,e,r,a)})}return n}module.exports=n},{"lodash.createcallback":496,"lodash.forown":532}],496:[function(e,module,t){module.exports=e(369)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/index.js":369,"lodash._basecreatecallback":497,"lodash._baseisequal":516,"lodash.isobject":525,"lodash.keys":527,"lodash.property":531}],497:[function(e,module,t){module.exports=e(370)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/index.js":370,"lodash._setbinddata":498,"lodash.bind":501,"lodash.identity":513,"lodash.support":514}],498:[function(e,module,t){module.exports=e(371)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/index.js":371,"lodash._isnative":499,"lodash.noop":500}],499:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],500:[function(e,module,t){module.exports=e(373)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/node_modules/lodash.noop/index.js":373}],501:[function(e,module,t){module.exports=e(374)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/index.js":374,"lodash._createwrapper":502,"lodash._slice":512}],502:[function(e,module,t){module.exports=e(375)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/index.js":375,"lodash._basebind":503,"lodash._basecreatewrapper":507,"lodash._slice":512,"lodash.isfunction":511}],503:[function(e,module,t){module.exports=e(376)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash._basebind/index.js":376,"lodash._basecreate":504,"lodash._setbinddata":498,"lodash._slice":512,"lodash.isobject":525}],504:[function(e,module,t){module.exports=e(377)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash._basebind/node_modules/lodash._basecreate/index.js":377,"lodash._isnative":505,"lodash.isobject":525,"lodash.noop":506}],505:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],506:[function(e,module,t){module.exports=e(373)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/node_modules/lodash.noop/index.js":373}],507:[function(e,module,t){module.exports=e(380)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash._basecreatewrapper/index.js":380,"lodash._basecreate":508,"lodash._setbinddata":498,"lodash._slice":512,"lodash.isobject":525}],508:[function(e,module,t){module.exports=e(377)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash._basebind/node_modules/lodash._basecreate/index.js":377,"lodash._isnative":509,"lodash.isobject":525,"lodash.noop":510}],509:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],510:[function(e,module,t){module.exports=e(373)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/node_modules/lodash.noop/index.js":373}],511:[function(e,module,t){module.exports=e(384)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash.isfunction/index.js":384}],512:[function(e,module,t){module.exports=e(385)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._slice/index.js":385}],513:[function(e,module,t){module.exports=e(386)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.identity/index.js":386}],514:[function(e,module,t){module.exports=e(387)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.support/index.js":387,"lodash._isnative":515}],515:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],516:[function(e,module,t){module.exports=e(389)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/index.js":389,"lodash._getarray":517,"lodash._objecttypes":519,"lodash._releasearray":520,"lodash.forin":523,"lodash.isfunction":524}],517:[function(e,module,t){module.exports=e(390)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/node_modules/lodash._getarray/index.js":390,"lodash._arraypool":518}],518:[function(e,module,t){module.exports=e(391)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/node_modules/lodash._getarray/node_modules/lodash._arraypool/index.js":391}],519:[function(e,module,t){module.exports=e(358)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash._objecttypes/index.js":358}],520:[function(e,module,t){module.exports=e(393)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/node_modules/lodash._releasearray/index.js":393,"lodash._arraypool":521,"lodash._maxpoolsize":522}],521:[function(e,module,t){module.exports=e(391)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/node_modules/lodash._getarray/node_modules/lodash._arraypool/index.js":391}],522:[function(e,module,t){module.exports=e(395)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/node_modules/lodash._releasearray/node_modules/lodash._maxpoolsize/index.js":395}],523:[function(e,module,t){module.exports=e(396)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/node_modules/lodash.forin/index.js":396,"lodash._basecreatecallback":497,"lodash._objecttypes":519}],524:[function(e,module,t){module.exports=e(384)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash.isfunction/index.js":384}],525:[function(e,module,t){module.exports=e(362)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash.isobject/index.js":362,"lodash._objecttypes":526}],526:[function(e,module,t){module.exports=e(358)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash._objecttypes/index.js":358}],527:[function(e,module,t){module.exports=e(359)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/index.js":359,"lodash._isnative":528,"lodash._shimkeys":529,"lodash.isobject":525}],528:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],529:[function(e,module,t){module.exports=e(361)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._shimkeys/index.js":361,"lodash._objecttypes":530}],530:[function(e,module,t){module.exports=e(358)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash._objecttypes/index.js":358}],531:[function(e,module,t){module.exports=e(404)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash.property/index.js":404}],532:[function(e,module,t){module.exports=e(405)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.forown/index.js":405,"lodash._basecreatecallback":533,"lodash._objecttypes":554,"lodash.keys":555}],533:[function(e,module,t){module.exports=e(370)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/index.js":370,"lodash._setbinddata":534,"lodash.bind":537,"lodash.identity":551,"lodash.support":552}],534:[function(e,module,t){module.exports=e(371)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/index.js":371,"lodash._isnative":535,"lodash.noop":536}],535:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],536:[function(e,module,t){module.exports=e(373)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/node_modules/lodash.noop/index.js":373}],537:[function(e,module,t){module.exports=e(374)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/index.js":374,"lodash._createwrapper":538,"lodash._slice":550}],538:[function(e,module,t){module.exports=e(375)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/index.js":375,"lodash._basebind":539,"lodash._basecreatewrapper":544,"lodash._slice":550,"lodash.isfunction":549}],539:[function(e,module,t){module.exports=e(376)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash._basebind/index.js":376,"lodash._basecreate":540,"lodash._setbinddata":534,"lodash._slice":550,"lodash.isobject":543}],540:[function(e,module,t){module.exports=e(377)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash._basebind/node_modules/lodash._basecreate/index.js":377,"lodash._isnative":541,"lodash.isobject":543,"lodash.noop":542}],541:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],542:[function(e,module,t){module.exports=e(373)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/node_modules/lodash.noop/index.js":373}],543:[function(e,module,t){module.exports=e(362)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash.isobject/index.js":362,"lodash._objecttypes":554}],544:[function(e,module,t){module.exports=e(380)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash._basecreatewrapper/index.js":380,"lodash._basecreate":545,"lodash._setbinddata":534,"lodash._slice":550,"lodash.isobject":548}],545:[function(e,module,t){module.exports=e(377)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash._basebind/node_modules/lodash._basecreate/index.js":377,"lodash._isnative":546,"lodash.isobject":548,"lodash.noop":547}],546:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],547:[function(e,module,t){module.exports=e(373)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/node_modules/lodash.noop/index.js":373}],548:[function(e,module,t){module.exports=e(362)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash.isobject/index.js":362,"lodash._objecttypes":554}],549:[function(e,module,t){module.exports=e(384)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash.isfunction/index.js":384}],550:[function(e,module,t){module.exports=e(385)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._slice/index.js":385}],551:[function(e,module,t){module.exports=e(386)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.identity/index.js":386}],552:[function(e,module,t){module.exports=e(387)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.support/index.js":387,"lodash._isnative":553}],553:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],554:[function(e,module,t){module.exports=e(358)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash._objecttypes/index.js":358}],555:[function(e,module,t){module.exports=e(359)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/index.js":359,"lodash._isnative":556,"lodash._shimkeys":557,"lodash.isobject":558}],556:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],557:[function(e,module,t){module.exports=e(361)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._shimkeys/index.js":361,"lodash._objecttypes":554}],558:[function(e,module,t){module.exports=e(362)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash.isobject/index.js":362,"lodash._objecttypes":554}],559:[function(e,module,t){var r=e("lodash._baseflatten"),a=e("lodash._baseuniq");function n(){return a(r(arguments,true,true))}module.exports=n},{"lodash._baseflatten":560,"lodash._baseuniq":564}],560:[function(e,module,t){module.exports=e(364)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash._baseflatten/index.js":364,"lodash.isarguments":561,"lodash.isarray":562}],561:[function(e,module,t){module.exports=e(365)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash._baseflatten/node_modules/lodash.isarguments/index.js":365}],562:[function(e,module,t){module.exports=e(366)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash._baseflatten/node_modules/lodash.isarray/index.js":366,"lodash._isnative":563}],563:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],564:[function(e,module,t){var r=e("lodash._baseindexof"),a=e("lodash._cacheindexof"),n=e("lodash._createcache"),i=e("lodash._getarray"),s=e("lodash._largearraysize"),o=e("lodash._releasearray"),l=e("lodash._releaseobject");function c(e,t,c){var u=-1,d=r,p=e?e.length:0,h=[];var v=!t&&p>=s,f=c||v?i():h;if(v){var g=n(f);d=a;f=g}while(++u<p){var m=e[u],x=c?c(m,u,e):m;if(t?!u||f[f.length-1]!==x:d(f,x)<0){if(c||v){f.push(x)}h.push(m)}}if(v){o(f.array);l(f)}else if(c){o(f)}return h}module.exports=c},{"lodash._baseindexof":565,"lodash._cacheindexof":566,"lodash._createcache":568,"lodash._getarray":573,"lodash._largearraysize":575,"lodash._releasearray":576,"lodash._releaseobject":579}],565:[function(e,module,t){function r(e,t,r){var a=(r||0)-1,n=e?e.length:0;while(++a<n){if(e[a]===t){return a}}return-1}module.exports=r},{}],566:[function(e,module,t){var r=e("lodash._baseindexof"),a=e("lodash._keyprefix");function n(e,t){var n=typeof t;e=e.cache;if(n=="boolean"||t==null){return e[t]?0:-1}if(n!="number"&&n!="string"){n="object"}var i=n=="number"?t:a+t;e=(e=e[n])&&e[i];return n=="object"?e&&r(e,t)>-1?0:-1:e?0:-1}module.exports=n},{"lodash._baseindexof":565,"lodash._keyprefix":567}],567:[function(e,module,t){var r="__1335248838000__";module.exports=r},{}],568:[function(e,module,t){var r=e("lodash._cachepush"),a=e("lodash._getobject"),n=e("lodash._releaseobject");function i(e){var t=-1,n=e.length,i=e[0],s=e[n/2|0],o=e[n-1];if(i&&typeof i=="object"&&s&&typeof s=="object"&&o&&typeof o=="object"){return false}var l=a();l["false"]=l["null"]=l["true"]=l["undefined"]=false;var c=a();c.array=e;c.cache=l;c.push=r;while(++t<n){c.push(e[t])}return c}module.exports=i},{"lodash._cachepush":569,"lodash._getobject":571,"lodash._releaseobject":579}],569:[function(e,module,t){var r=e("lodash._keyprefix");function a(e){var t=this.cache,a=typeof e;if(a=="boolean"||e==null){t[e]=true}else{if(a!="number"&&a!="string"){a="object"}var n=a=="number"?e:r+e,i=t[a]||(t[a]={});if(a=="object"){(i[n]||(i[n]=[])).push(e)}else{i[n]=true}}}module.exports=a},{"lodash._keyprefix":570}],570:[function(e,module,t){module.exports=e(567)},{"/pipeline/build/node_modules/lodash.union/node_modules/lodash._baseuniq/node_modules/lodash._cacheindexof/node_modules/lodash._keyprefix/index.js":567}],571:[function(e,module,t){var r=e("lodash._objectpool");function a(){return r.pop()||{array:null,cache:null,criteria:null,"false":false,index:0,"null":false,number:null,object:null,push:null,string:null,"true":false,undefined:false,value:null}}module.exports=a},{"lodash._objectpool":572}],572:[function(e,module,t){var r=[];module.exports=r},{}],573:[function(e,module,t){module.exports=e(390)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/node_modules/lodash._getarray/index.js":390,"lodash._arraypool":574}],574:[function(e,module,t){module.exports=e(391)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/node_modules/lodash._getarray/node_modules/lodash._arraypool/index.js":391}],575:[function(e,module,t){var r=75;module.exports=r},{}],576:[function(e,module,t){module.exports=e(393)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/node_modules/lodash._releasearray/index.js":393,"lodash._arraypool":577,"lodash._maxpoolsize":578}],577:[function(e,module,t){module.exports=e(391)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/node_modules/lodash._getarray/node_modules/lodash._arraypool/index.js":391}],578:[function(e,module,t){module.exports=e(395)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/node_modules/lodash._releasearray/node_modules/lodash._maxpoolsize/index.js":395}],579:[function(e,module,t){var r=e("lodash._maxpoolsize"),a=e("lodash._objectpool");function n(e){var t=e.cache;if(t){n(t)}e.array=e.cache=e.criteria=e.object=e.number=e.string=e.value=null;if(a.length<r){a.push(e)}}module.exports=n},{"lodash._maxpoolsize":580,"lodash._objectpool":581}],580:[function(e,module,t){module.exports=e(395)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/node_modules/lodash._releasearray/node_modules/lodash._maxpoolsize/index.js":395}],581:[function(e,module,t){module.exports=e(572)},{"/pipeline/build/node_modules/lodash.union/node_modules/lodash._baseuniq/node_modules/lodash._createcache/node_modules/lodash._getobject/node_modules/lodash._objectpool/index.js":572}],582:[function(e,module,t){var r=e("lodash._baseuniq"),a=e("lodash.createcallback");function n(e,t,n,i){if(typeof t!="boolean"&&t!=null){i=n;n=typeof t!="function"&&i&&i[t]===e?null:t;t=false}if(n!=null){n=a(n,i,3)}return r(e,t,n)}module.exports=n},{"lodash._baseuniq":583,"lodash.createcallback":601}],583:[function(e,module,t){module.exports=e(564)},{"/pipeline/build/node_modules/lodash.union/node_modules/lodash._baseuniq/index.js":564,"lodash._baseindexof":584,"lodash._cacheindexof":585,"lodash._createcache":587,"lodash._getarray":592,"lodash._largearraysize":594,"lodash._releasearray":595,"lodash._releaseobject":598}],584:[function(e,module,t){module.exports=e(565)},{"/pipeline/build/node_modules/lodash.union/node_modules/lodash._baseuniq/node_modules/lodash._baseindexof/index.js":565}],585:[function(e,module,t){module.exports=e(566)},{"/pipeline/build/node_modules/lodash.union/node_modules/lodash._baseuniq/node_modules/lodash._cacheindexof/index.js":566,"lodash._baseindexof":584,"lodash._keyprefix":586}],586:[function(e,module,t){module.exports=e(567)},{"/pipeline/build/node_modules/lodash.union/node_modules/lodash._baseuniq/node_modules/lodash._cacheindexof/node_modules/lodash._keyprefix/index.js":567}],587:[function(e,module,t){module.exports=e(568)},{"/pipeline/build/node_modules/lodash.union/node_modules/lodash._baseuniq/node_modules/lodash._createcache/index.js":568,"lodash._cachepush":588,"lodash._getobject":590,"lodash._releaseobject":598}],588:[function(e,module,t){module.exports=e(569)},{"/pipeline/build/node_modules/lodash.union/node_modules/lodash._baseuniq/node_modules/lodash._createcache/node_modules/lodash._cachepush/index.js":569,"lodash._keyprefix":589}],589:[function(e,module,t){module.exports=e(567)},{"/pipeline/build/node_modules/lodash.union/node_modules/lodash._baseuniq/node_modules/lodash._cacheindexof/node_modules/lodash._keyprefix/index.js":567}],590:[function(e,module,t){module.exports=e(571)},{"/pipeline/build/node_modules/lodash.union/node_modules/lodash._baseuniq/node_modules/lodash._createcache/node_modules/lodash._getobject/index.js":571,"lodash._objectpool":591}],591:[function(e,module,t){module.exports=e(572)},{"/pipeline/build/node_modules/lodash.union/node_modules/lodash._baseuniq/node_modules/lodash._createcache/node_modules/lodash._getobject/node_modules/lodash._objectpool/index.js":572}],592:[function(e,module,t){module.exports=e(390)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/node_modules/lodash._getarray/index.js":390,"lodash._arraypool":593}],593:[function(e,module,t){module.exports=e(391)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/node_modules/lodash._getarray/node_modules/lodash._arraypool/index.js":391}],594:[function(e,module,t){module.exports=e(575)},{"/pipeline/build/node_modules/lodash.union/node_modules/lodash._baseuniq/node_modules/lodash._largearraysize/index.js":575}],595:[function(e,module,t){module.exports=e(393)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/node_modules/lodash._releasearray/index.js":393,"lodash._arraypool":596,"lodash._maxpoolsize":597}],596:[function(e,module,t){module.exports=e(391)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/node_modules/lodash._getarray/node_modules/lodash._arraypool/index.js":391}],597:[function(e,module,t){module.exports=e(395)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/node_modules/lodash._releasearray/node_modules/lodash._maxpoolsize/index.js":395}],598:[function(e,module,t){module.exports=e(579)},{"/pipeline/build/node_modules/lodash.union/node_modules/lodash._baseuniq/node_modules/lodash._releaseobject/index.js":579,"lodash._maxpoolsize":599,"lodash._objectpool":600}],599:[function(e,module,t){module.exports=e(395)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/node_modules/lodash._releasearray/node_modules/lodash._maxpoolsize/index.js":395}],600:[function(e,module,t){module.exports=e(572)},{"/pipeline/build/node_modules/lodash.union/node_modules/lodash._baseuniq/node_modules/lodash._createcache/node_modules/lodash._getobject/node_modules/lodash._objectpool/index.js":572}],601:[function(e,module,t){module.exports=e(369)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/index.js":369,"lodash._basecreatecallback":602,"lodash._baseisequal":621,"lodash.isobject":630,"lodash.keys":632,"lodash.property":636}],602:[function(e,module,t){module.exports=e(370)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/index.js":370,"lodash._setbinddata":603,"lodash.bind":606,"lodash.identity":618,"lodash.support":619}],603:[function(e,module,t){module.exports=e(371)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/index.js":371,"lodash._isnative":604,"lodash.noop":605}],604:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],605:[function(e,module,t){module.exports=e(373)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/node_modules/lodash.noop/index.js":373}],606:[function(e,module,t){module.exports=e(374)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/index.js":374,"lodash._createwrapper":607,"lodash._slice":617}],607:[function(e,module,t){module.exports=e(375)
},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/index.js":375,"lodash._basebind":608,"lodash._basecreatewrapper":612,"lodash._slice":617,"lodash.isfunction":616}],608:[function(e,module,t){module.exports=e(376)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash._basebind/index.js":376,"lodash._basecreate":609,"lodash._setbinddata":603,"lodash._slice":617,"lodash.isobject":630}],609:[function(e,module,t){module.exports=e(377)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash._basebind/node_modules/lodash._basecreate/index.js":377,"lodash._isnative":610,"lodash.isobject":630,"lodash.noop":611}],610:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],611:[function(e,module,t){module.exports=e(373)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/node_modules/lodash.noop/index.js":373}],612:[function(e,module,t){module.exports=e(380)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash._basecreatewrapper/index.js":380,"lodash._basecreate":613,"lodash._setbinddata":603,"lodash._slice":617,"lodash.isobject":630}],613:[function(e,module,t){module.exports=e(377)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash._basebind/node_modules/lodash._basecreate/index.js":377,"lodash._isnative":614,"lodash.isobject":630,"lodash.noop":615}],614:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],615:[function(e,module,t){module.exports=e(373)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash._setbinddata/node_modules/lodash.noop/index.js":373}],616:[function(e,module,t){module.exports=e(384)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash.isfunction/index.js":384}],617:[function(e,module,t){module.exports=e(385)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._slice/index.js":385}],618:[function(e,module,t){module.exports=e(386)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.identity/index.js":386}],619:[function(e,module,t){module.exports=e(387)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.support/index.js":387,"lodash._isnative":620}],620:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],621:[function(e,module,t){module.exports=e(389)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/index.js":389,"lodash._getarray":622,"lodash._objecttypes":624,"lodash._releasearray":625,"lodash.forin":628,"lodash.isfunction":629}],622:[function(e,module,t){module.exports=e(390)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/node_modules/lodash._getarray/index.js":390,"lodash._arraypool":623}],623:[function(e,module,t){module.exports=e(391)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/node_modules/lodash._getarray/node_modules/lodash._arraypool/index.js":391}],624:[function(e,module,t){module.exports=e(358)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash._objecttypes/index.js":358}],625:[function(e,module,t){module.exports=e(393)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/node_modules/lodash._releasearray/index.js":393,"lodash._arraypool":626,"lodash._maxpoolsize":627}],626:[function(e,module,t){module.exports=e(391)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/node_modules/lodash._getarray/node_modules/lodash._arraypool/index.js":391}],627:[function(e,module,t){module.exports=e(395)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/node_modules/lodash._releasearray/node_modules/lodash._maxpoolsize/index.js":395}],628:[function(e,module,t){module.exports=e(396)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._baseisequal/node_modules/lodash.forin/index.js":396,"lodash._basecreatecallback":602,"lodash._objecttypes":624}],629:[function(e,module,t){module.exports=e(384)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash._basecreatecallback/node_modules/lodash.bind/node_modules/lodash._createwrapper/node_modules/lodash.isfunction/index.js":384}],630:[function(e,module,t){module.exports=e(362)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash.isobject/index.js":362,"lodash._objecttypes":631}],631:[function(e,module,t){module.exports=e(358)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash._objecttypes/index.js":358}],632:[function(e,module,t){module.exports=e(359)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/index.js":359,"lodash._isnative":633,"lodash._shimkeys":634,"lodash.isobject":630}],633:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],634:[function(e,module,t){module.exports=e(361)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._shimkeys/index.js":361,"lodash._objecttypes":635}],635:[function(e,module,t){module.exports=e(358)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash._objecttypes/index.js":358}],636:[function(e,module,t){module.exports=e(404)},{"/pipeline/build/node_modules/lodash.flatten/node_modules/lodash.map/node_modules/lodash.createcallback/node_modules/lodash.property/index.js":404}],637:[function(e,module,t){var r=e("lodash.keys");function a(e){var t=-1,a=r(e),n=a.length,i=Array(n);while(++t<n){i[t]=e[a[t]]}return i}module.exports=a},{"lodash.keys":638}],638:[function(e,module,t){module.exports=e(359)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/index.js":359,"lodash._isnative":639,"lodash._shimkeys":640,"lodash.isobject":642}],639:[function(e,module,t){module.exports=e(360)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._isnative/index.js":360}],640:[function(e,module,t){module.exports=e(361)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash._shimkeys/index.js":361,"lodash._objecttypes":641}],641:[function(e,module,t){module.exports=e(358)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash._objecttypes/index.js":358}],642:[function(e,module,t){module.exports=e(362)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash.keys/node_modules/lodash.isobject/index.js":362,"lodash._objecttypes":643}],643:[function(e,module,t){module.exports=e(358)},{"/pipeline/build/node_modules/lodash.defaults/node_modules/lodash._objecttypes/index.js":358}]},{},[1]);